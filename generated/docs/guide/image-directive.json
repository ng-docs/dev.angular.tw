{"id":"guide/image-directive","title":"NgOptimizedImage 入门","contents":"<div class=\"content\">\n  <h1 id=\"getting-started-with-ngoptimizedimage\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"eho1b3cawkvz0i6ih0w7adlpj\">NgOptimizedImage 入门<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#getting-started-with-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h1>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"az63iilcimn64snb9o73tazy2\"><code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 指令可以轻松采用关于性能的最佳实践来加载图片。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ahuchdt40g4fi594ifft1jb72\">该指令可确保<a href=\"http://web.dev/lcp\">最大内容绘制 （LCP）</a>图片的加载优先级为：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ek0wynwdt5yokey4bb0ylxsjo\">自动设置 <code>&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a>&gt;</code> 标签上的 <code>fetchpriority</code> 属性</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6hs9dtc6t6j82idbwj249gt70\">默认惰性加载其他图片</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"42falm2kdwxzjy6hegm1obr5h\">在文档头部自动生成一个预连接 link 标签</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"54kwo2ugxt39l119u2974x0ik\">自动生成 <code>srcset</code> 属性</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3b9otasm1mh8kd8kljpj2hg36\">如果应用程序使用 SSR，则生成<a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload\">预加载提示</a></li>\n</ul>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7p5crj6agknbd81ka0milu7yh\">除了优化 LCP 图片的加载之外，<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 还实施了许多图片最佳实践，例如：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8cxotwxxdo76q24grku64btzi\">使用<a href=\"https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options\">图片 CDN URL 应用图片优化</a></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9sxug4lwclbquq6q682s5yhl9\">通过要求 <code>width</code> 和 <code>height</code> 来防止布局偏移</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1te16wt32h53nbw7tg987bdee\">如果 <code>width</code> 或 <code>height</code> 设置不正确，则会发出警告</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2n9up45tjx4gg33523q927ppl\">给出渲染时图片是否会在视觉上失真的警告</li>\n</ul>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e3ckcn1uovxuo7dksncspkfly\"><strong>注意：尽管 <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 指令在 Angular 15 版本中成为稳定特性，但它已被回溯，并在版本 13.4.0 和 14.3.0 中作为稳定特性提供。</strong></p>\n<h2 id=\"getting-started\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bbwu5ocoy87h3ob0i4j82759h\">快速上手<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#getting-started\"><i class=\"material-icons\">link</i></a></h2>\n<h4 id=\"step-1-import-ngoptimizedimage\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"o8o33fsk2fqhzb0m14619jer\">步骤 1：导入 NgOptimizedImage<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-1-import-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h4>\n<code-example format=\"typescript\" language=\"typescript\">\n\nimport { <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a> } from '@angular/common'\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4snuw9h5wmkgehttbdsjskbfc\">该指令被定义为<a href=\"/guide/standalone-components\">独立指令</a>，因此组件应该直接导入它。</p>\n<h4 id=\"step-2-optional-set-up-a-loader\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7vv5d5ex54s0xiic1sy6zcg0u\">第 2 步：（可选）设置加载器<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-2-optional-set-up-a-loader\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"590n4wroso3x49p25lw8bj1bv\">使用 NgOptimizedImage <strong>不一定需要</strong>图片加载器，但使用带有图片 CDN 的加载器可以实现强大的性能特性，包括为图片自动设置 <code>srcset</code>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5b1hh7hx9ng7hull7s0lwy7w5\">有关设置加载器的简短指南，请参阅本页末尾的<a href=\"guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\">配置图片加载器</a>部分。</p>\n<h4 id=\"step-3-enable-the-directive\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"94mmpzavhe6ew2osqx3e9cg9c\">第 3 步：启用该指令<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-3-enable-the-directive\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5b4bd7hilrhlny5fedwxbbi7n\">要激活 <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 指令，请将图片的 <code>src</code> 属性替换为 <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code>。</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\"&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2xdfevgshg89fqqzgbyrgqis\">如果你使用的是<a href=\"guide/image-directive#built-in-loaders\">内置的第三方加载器</a>，请确保忽略了 <code>src</code> 中的基本 URL 路径，因为它会由此加载器自动附加。</p>\n<h4 id=\"step-4-mark-images-as-priority\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"91wexlvjdazxiur7jfg0tbe1c\">步骤 4：将图片标记为 <code>priority</code><a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-4-mark-images-as-priority\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2d7q6bpxabluo97qu1rnfwyn5\">始终将页面上的 <a href=\"https://web.dev/lcp/#what-elements-are-considered\">LCP 图片</a> 标记为 <code>priority</code> 的，以优先加载它。</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" priority&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ey72zfebcr1e5puqueq9ltsef\">将图片标记为 <code>priority</code> 会应用以下优化：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"f5bujzf9v8avi7fv0g2t5nswc\">设置 <code>fetchpriority=high</code> （在<a href=\"https://web.dev/priority-hints\">这里</a>阅读有关优先级提示的更多内容）</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c6iensn5iva04i739av4pq8jt\">设置 <code>loading=eager</code> （在<a href=\"https://web.dev/browser-level-image-lazy-loading\">这里</a>阅读有关原生惰性加载的更多信息）</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cjxhvy5n40bmwdwy24q9s7luw\">如果在服务器上渲染，则自动生成一个 \n<a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload\">preload 链接元素</a>。</li>\n</ul>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1s819jqw7mpzwzz72nx06bvj3\">在开发过程中，如果 LCP 元素是一个没有 \n<code>priority</code> 属性的图像，则 Angular 会记录一个错误，因为这可能会显著影响加载性能。页面的 LCP 元素可能会基于多种因素而变化 - 例如用户屏幕的尺寸，因此一个页面可能有多个应该标记为 \n<code>priority</code> 的图像。查看 \n<a href=\"https://web.dev/css-web-vitals/#images-and-largest-contentful-paint-lcp\">CSS for Web Vitals</a> 以获取更多详细信息。</p>\n<h4 id=\"step-5-include-height-and-width\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2f15edtwlx5dbpmov4842mvrp\">第 5 步：包括高度和宽度<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-5-include-height-and-width\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"426sdvwgraxiwvgj5q06c5lt2\">为了防止<a href=\"https://web.dev/css-web-vitals/#images-and-layout-shifts\">与图片相关的布局移位</a>，NgOptimizedImage 要求你为图片指定高度和宽度，如下所示：</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\"&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3c0hzvhrdgd5ftfl7oktt5tid\">对于\n<strong>响应式图片</strong>（你已经根据视口大小调整了大小的图片），\n<code>width</code> 和 \n<code>height</code> 属性应该是图片文件的固有大小。对于响应式图片，还重要的是要\n<a href=\"guide/image-directive#responsive-images\">为 <code>sizes</code> 设置一个值。</a></p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"39gro0lb0tkg4rves4had523v\">对于<strong>固定大小的图片</strong>，<code>width</code> 和 <code>height</code> 属性应该反映图片的所需渲染的大小。这些属性的纵横比应始终与图片的固有纵横比匹配。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c7kjczn8irmlqwmus1nkv44xl\">注意：如果你不知道图片的大小，请考虑使用“填充（<code>fill</code>）模式”来继承父容器的大小，如下所述：</p>\n<h3 id=\"using-fill-mode\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5qk4da0em6k0anicvqmsslngm\">使用 <code>fill</code> 模式<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#using-fill-mode\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"510jd2ls09thlqr1w8njq1w0d\">如果你希望让图片填充其容器元素，可以用 <code>fill</code> 属性。当你想实现“背景图片”行为时，这通常会很有用。当你不知道图片的确切宽度和高度时，它也会很有帮助，但如果你确实有一个具有已知大小的父容器，可能希望将图片适配进其中（请参阅下面的“object-fit”） .。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"77nxf4od7xh2cao6dks1wude2\">当你将 <code>fill</code> 属性添加到图片时，不需要也不应该包含 <code>width</code> 和 <code>height</code>，如下例所示：</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" fill&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5g8pqzinggkkipfc4l38kddcx\">你可以用 <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit\">object-fit</a> 这个 CSS 属性来更改图片填充其容器的方式。如果你使用 <code>object-fit: \"contain\"</code> 来设置图片的样式，则图片将保持其纵横比并被黑边化（译注：类似于电影在不同分辨率播放时加黑边）以适配此元素。如果你设置了 <code>object-fit: \"cover\"</code>，则元素将保留其长宽比，完全填充元素，并且某些内容可能会被“裁剪”。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8a0l3alroxb17tu67ezmp9pox\">请在 <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit\">MDN object-fit 文档</a>中查看上述内容的可视化示例。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"53c2d2gt7fl3ahj0riedjcb25\">你还可以用 <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/object-position\">object-location 属性来设置</a>图片的样式，以调整其在容器元素中的位置。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2p5oynl59akzygy8iym1iifch\"><strong>重要说明</strong>：为了正确渲染“fill”图片，其父元素<strong>必须</strong>使用 <code>position: \"relative\"</code>、<code>position: \"fixed\"</code> 或 <code>position: \"absolute\"</code> 来设置样式。</p>\n<h2 id=\"using-placeholders\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9pu3bc45xsyrx9hjk8m7iviig\">使用占位符<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#using-placeholders\"><i class=\"material-icons\">link</i></a></h2>\n<h3 id=\"automatic-placeholders\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9pocjhv4jzvsboixo2xlx3vwd\">自动占位符<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#automatic-placeholders\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ccrfuw414jjams934jzricfei\">NgOptimizedImage 可以为你的图像提供一个自动低分辨率占位符，只要你使用提供自动图像调整的 CDN 或图像主机。要利用这个功能，只需给你的图像添加 \n<code>placeholder</code> 属性，如下所示：</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" placeholder&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"974vx549slfnk4tuunxf44r0p\">添加此属性将自动请求图像的第二个、较小版本，使用你指定的图像加载器。这个小图像将以 CSS 模糊的 \n<code>background-image</code> 样式应用，而你的图像加载时。如果没有提供图像加载器，则无法生成占位符图像，并将抛出错误。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bhiwlda8gfyfg66rxt2ykiinj\">生成的占位符的默认大小为 30px 宽，但你可以通过在 \n<code><a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a></code> 提供者中指定一个值来使其更大或更小，如下所示：</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  {\n    provide: <a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a>,\n    useValue: {\n      placeholderResolution: 40\n    }\n  },\n],\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7hmscs36towsba0f3c9nhhn79\">如果你想要在模糊的占位符周围有锐利的边缘，你可以将你的图像包裹在一个带有 \n<code>overflow: hidden</code> 样式的容器中。只要 \n<code>&lt;div&gt;</code> 和图像是相同大小的（比如使用 \n<code>width: fit-content</code> 样式），占位符的「模糊边缘」将被隐藏。</p>\n<h3 id=\"data-url-placeholders\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"80lfd8z20i8g7lnqa90gyv8y2\">数据 URL 占位符<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#data-url-placeholders\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1twkmhln4h04dw8ep2oxd0h8t\">你也可以使用不带图像加载器的 base64 \n<a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs\">数据 URL</a> 指定一个占位符。数据 URL 格式为 \n<code>data:image/[imagetype];[data]</code>，其中 \n<code>[imagetype]</code> 是图像格式，比如 \n<code>png</code>，而 \n<code>[data]</code> 是图像的 base64 编码。该编码可以在命令行中或JavaScript中完成。有关具体命令，请参见 \n<a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs#encoding_data_into_base64_format\">MDN 文档</a>。以下是一个带有截断数据的数据 URL 占位符示例：</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" placeholder=\"data:image/png;base64,iVBORw0K...\"&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9h74la0aftkgleme9yb7gh5mz\">然而，大型数据 URL 会增加你的 Angular 捆绑包的大小，并减慢页面加载速度。如果你无法使用图像加载器，Angular 团队建议保持 base64 占位符图像小于 4KB，并且仅在关键图像上使用它们。除了减少占位符尺寸外，还要考虑更改保存图像时使用的图像格式或参数。在非常低的分辨率下，这些参数对文件大小有很大影响。</p>\n<h3 id=\"non-blurred-placeholders\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1qe8xoomgmm3j23m37jxm6bkh\">非模糊占位符<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#non-blurred-placeholders\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5za6cqrnulunqjdyntt4sbv9e\">默认情况下，NgOptimizedImage 对图像占位符应用 CSS 模糊效果。要呈现一个没有模糊效果的占位符，请提供一个包含 \n<code>blur</code> 属性设置为 false 的对象的 \n<code>placeholderConfig</code> 参数。例如：</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" placeholder [placeholderConfig]=\"{blur: false}\"&gt;\n\n</code-example>\n<h2 id=\"adjusting-image-styling\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"f2m5gyn4hwzmqneru932plral\">调整图片样式<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#adjusting-image-styling\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1nfzayji3yrpvj6a7vzl5jc0v\">根据图片的样式，添加 <code>width</code> 和 <code>height</code> 属性可能会导致图片的渲染方式不同。如果你的图片样式正在以扭曲的纵横比渲染图片，<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 会发出警告。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7ljesqhs2c8f5kvavean9dfmf\">你通常可以通过将 <code>height: auto</code> 或 <code>width: auto</code> 添加到图片的样式中来解决此问题。有关更多信息，请参阅<a href=\"https://web.dev/patterns/web-vitals-patterns/images/img-tag\">关于 <code>&lt;img&gt;</code> 标签的 web.dev 文章</a>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bwk7h6g3duyuzxozf607omq57\">如果图片上的 <code>height</code> 和 <code>width</code> 属性让你无法用 CSS 以你想要的方式调整图片大小，请考虑改用“填充”模式，并为图片的父元素设置样式。</p>\n<h2 id=\"performance-features\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8athrjnoftyka8sasn3xdjx4j\">性能优化特性<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#performance-features\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6yqqtp7yxwvdowtkwudh98c11\">NgOptimizedImage 包含许多旨在提高应用程序加载性能的特性。本节会介绍这些特性。</p>\n<h3 id=\"resource-hints\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"whahw29k4p8256setnzfnzxf\">资源提示<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#resource-hints\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3n9hv1sopuogllew1ykhh05ji\">为你的图片来源添加一个\n<a href=\"https://web.dev/preconnect-and-dns-prefetch\"><code>preconnect</code>资源提示</a>，确保 LCP 图片尽快加载。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"askvk3bob3kk13dhyp9lmvh3x\">为作为\n<a href=\"guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\">加载器</a>参数提供的域自动生成预连接链接。如果无法自动识别图片来源，并且 LCP 图片没有检测到预连接链接，\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>将在开发过程中发出警告。在这种情况下，你应该手动在\n<code>index.html</code>中添加一个资源提示。在文档的\n<code>&lt;head&gt;</code>中，添加一个\n<code>link</code>标签，属性为\n<code>rel=\"preload\"</code>，如下所示：</p>\n<code-example format=\"html\" language=\"html\">\n\n&lt;link rel=\"preconnect\" href=\"https://my.cdn.origin\" /&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3hdb0tzvvdi7462r6jktjessd\">要禁用预连接警告，请注入\n<code><a href=\"api/common/PRECONNECT_CHECK_BLOCKLIST\" class=\"code-anchor\">PRECONNECT_CHECK_BLOCKLIST</a></code>令牌：</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\nproviders: [\n  {provide: <a href=\"api/common/PRECONNECT_CHECK_BLOCKLIST\" class=\"code-anchor\">PRECONNECT_CHECK_BLOCKLIST</a>, useValue: 'https://your-domain.com'}\n],\n\nSee more information on automatic preconnect generation [here](#why-is-a-preconnect-element-not-being-generated-for-my-image-domain).\n\n</code-example>\n<h3 id=\"request-images-at-the-correct-size-with-automatic-srcset\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1xvafdfs3w69nvb8nij0ixq02\">使用自动 <code>srcset</code> 请求正确大小的图片<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#request-images-at-the-correct-size-with-automatic-srcset\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4c97cxpo768kmibrbghz5mszu\">定义 <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/srcset\"><code>srcset</code> 属性</a>可确保浏览器为用户的视口请求正确大小的图片，因此不会浪费时间下载太大的图片。<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 会根据 img 标签上 <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\"><code>sizes</code></a> 属性的存在与否和值来为图片生成适当的 <code>srcset</code>。</p>\n<h4 id=\"fixed-size-images\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"53avbugmhjt8uqnid0q3doqla\">固定大小的图片<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#fixed-size-images\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7vu968ly50uvvj7qcn57ln2a9\">如果你的图片的大小应该是“固定的”（即跨设备的大小相同，除了<a href=\"https://web.dev/codelab-density-descriptors/\">像素密度</a>不同），则无需设置 <code>sizes</code> 属性。可以从图片的 <code>width</code> 和 <code>height</code> 属性自动生成 <code>srcset</code>，无需更多的输入属性。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ekhrdrqfidj682mmrdya0ecgb\">生成的示例 srcset：<code>&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> ... srcset=\"image-400w.jpg 1x, image-800w.jpg 2x\"&gt;</code></p>\n<h4 id=\"responsive-images\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5vmpnuw339d1tvxd0sok6tadb\">响应式图片<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#responsive-images\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cikaa9zyxb3ncxpc6ej80lonf\">如果你的图片应该是响应式的（即会根据视口大小放大和缩小），那么你需要定义一个 <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\"><code>sizes</code></a> 属性来生成 <code>srcset</code>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"15t6q04e0ranx3jlcdzluqrd4\">如果你以前没有使用过 <code>sizes</code>，一个很好的起点是根据视口宽度来设置它。例如，如果你的 CSS 要让图片填充视口宽度的 100%，则将 <code>sizes</code> 设置为 <code>100vw</code>，浏览器将选择 <code>srcset</code> 中最接近视口宽度的图片（在考虑像素密度之后）。如果你的图片只可能占屏幕的一半（例如：在侧边栏中），请将 <code>sizes</code> 设置为 <code>50vw</code> 以确保浏览器选择较小的图片。以此类推。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cgfx2b78plu8j3dn9hxxq42v9\">如果你发现上述内容无法涵盖你所需的图片行为，请参阅有关<a href=\"guide/image-directive#advanced-sizes-values\">高级尺寸值</a>的文档。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"do7su406k8wjj5brf401qewhc\">默认情况下，响应式断点是：</p>\n<p><code>[16, 32, 48, 64, 96, 128, 256, 384, 640, 750, 828, 1080, 1200, 1920, 2048, 3840]</code></p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"13hsl7d7a6qci6rdo3p87i6m3\">如果你想自定义这些断点，可以用 <code><a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a></code> 提供者来实现：</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  {\n    provide: <a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a>,\n    useValue: {\n      breakpoints: [16, 48, 96, 128, 384, 640, 750, 828, 1080, 1200, 1920]\n    }\n  },\n],\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9gco7c4ujw33mabe854u3j561\">如果你想手动定义 <code>srcset</code> 属性，可以用 <code>ngSrcset</code> 属性提供自己的：</p>\n<code-example format=\"html\" language=\"html\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"hero.jpg\" ngSrcset=\"100w, 200w, 300w\"&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6x5rrmyjnsjh0d7h5yeqt11os\">如果存在 <code>ngSrcset</code> 属性，则 <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 会根据包含的大小生成并设置 <code>srcset</code>。不要在 <code>ngSrcset</code> 中包含图片文件名 - 该指令会从 <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code> 推断此信息。该指令支持宽度描述符（例如 <code>100w</code> ）和密度描述符（例如 <code>1x</code> ）。</p>\n<code-example format=\"html\" language=\"html\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"hero.jpg\" ngSrcset=\"100w, 200w, 300w\" sizes=\"50vw\"&gt;\n\n</code-example>\n<h3 id=\"disabling-automatic-srcset-generation\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"76rsd8s7f5h5msqht9c39ku61\">禁用自动 srcset 生成<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#disabling-automatic-srcset-generation\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7mfrd6pgpa830ktsjt7ea8b6y\">要禁用单个图片的 srcset 生成，你可以在图片上添加 <code>disableOptimizedSrcset</code> 属性：</p>\n<code-example format=\"html\" language=\"html\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"about.jpg\" disableOptimizedSrcset&gt;\n\n</code-example>\n<h3 id=\"disabling-image-lazy-loading\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"89y5c1vkpvhktfzhhuahozhll\">禁用图片惰性加载<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#disabling-image-lazy-loading\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8tmypk0wgqmm0i1stvqjrc3r6\">默认情况下，<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 为所有未标记 <code>priority</code> 的图片设置 <code>loading=lazy</code>。你可以通过设置 <code>loading</code> 属性来为非优先图片禁用此行为。此属性会接受值：<code>eager</code> 、 <code>auto</code> 和 <code>lazy</code>。<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/loading#value\">有关详细信息，请参阅标准图片 <code>loading</code> 属性的文档</a>。</p>\n<code-example format=\"html\" language=\"html\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" loading=\"eager\"&gt;\n\n</code-example>\n<h3 id=\"advanced-sizes-values\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"96a0ls5q07mmd0qsoej0563rn\">高级的 <code>sizes</code> 值<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#advanced-sizes-values\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ds71vtononwk860l7eux1w1z7\">你可能希望在不同大小的屏幕上以不同的宽度显示图片。这种模式的一个常见例子是基于网格或列的布局，它在移动设备上渲染为单列，在较大的设备上渲染为两列。你可以用“媒体查询”语法在 <code>sizes</code> 属性中捕获此行为，例如以下内容：</p>\n<code-example format=\"html\" language=\"html\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" sizes=\"(max-width: 768px) 100vw, 50vw\"&gt;\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"br044mqdg7rrsxp7ksf2xfv2v\">上面的示例中的 <code>sizes</code> 属性表示“我希望此图片在 768px 宽的设备上是屏幕宽度的 100%。否则，我希望它是屏幕宽度的 50%。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"37hrh9vqi85upt252hrg6ypuy\">有关\n<code>sizes</code>属性的更多信息，请查看\n<a href=\"https://web.dev/learn/design/responsive-images/#sizes\">web.dev</a>或\n<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\">MDN</a>。</p>\n<h2 id=\"configuring-an-image-loader-for-ngoptimizedimage\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2dt10k1saqfxjmnrgsx0zi75p\">为 <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 配置图片加载器<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dhad4cb5tvdoe01z6k8n3fe7e\">“加载器”是一个为给定图片文件生成<a href=\"https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options\">图片转换 URL</a>的函数。如果合适，<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 就会设置图片的大小、格式和图片质量转换。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2rgl6bmc5wchbc5obg0tufbgh\"><code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 提供了一个不应用转换的通用加载器和一个用于各种第三方图片服务的加载器。它还支持编写你自己的自定义加载器。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7cu5jn1hqlq1kcex7fhomynxu\">加载器类型</th>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ams69bxknsvkxy7e6gbayrjfr\">行为</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cktwx3v8n60zs92fz3utmkm06\">通用加载器</td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3ew3m6uy65qkefgyn1ucgdk2f\">通用加载器返回的 URL 将始终与\n<code>src</code>的值匹配。换句话说，此加载器不应用任何转换。使用 Angular 为图片提供服务的站点是此加载器的主要预期用例。</td>\n</tr>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c15hj8qtnkcnk5cegrqncn6it\">第三方图片服务的加载器</td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2syry6qogi0x6jx126ual9k9\">第三方图片服务的加载器返回的 URL 将遵循该特定图片服务使用的 API 约定。</td>\n</tr>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2nnwz4pz3mc2yjwdcf1mffvob\">自定义加载器</td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"41c2ul8y1y6pmo3wg9uti9wgv\">自定义加载器的行为由开发者定义。如果你的图片服务不受预配置的\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>加载器支持，请使用自定义加载器。</td>\n</tr>\n</tbody>\n</table>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"f3zga0uv1jp0y6p08tv2n90dm\">基于 Angular 应用程序常用的图片服务，<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 提供了预配置的加载器以使用以下图片服务：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1j1pxvet0tvr9ul037lmljggz\">图片服务</th>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5ztsszv4ap9frzpxtwhuiqlxz\">Angular API</th>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5eur89rbbrrg7fxsvemudi7u2\">文档</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"12oozlw8x7sikso0uwpt4nfy0\">Cloudflare 图像调整大小</td>\n<td align=\"left\"><code><a href=\"api/common/provideCloudflareLoader\" class=\"code-anchor\">provideCloudflareLoader</a></code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9z5grdktor4z9tiiwpe4biiiw\"><a href=\"https://developers.cloudflare.com/images/image-resizing/\">文档</a></td>\n</tr>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"24zzr7gbt72pvh0i03kaz0d4x\">Cloudinary</td>\n<td align=\"left\"><code><a href=\"api/common/provideCloudinaryLoader\" class=\"code-anchor\">provideCloudinaryLoader</a></code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ct3cjq1gqk7dr2hkgrbhrb4v2\"><a href=\"https://cloudinary.com/documentation/resizing_and_cropping\">文档</a></td>\n</tr>\n<tr>\n<td align=\"left\">ImageKit</td>\n<td align=\"left\"><code><a href=\"api/common/provideImageKitLoader\" class=\"code-anchor\">provideImageKitLoader</a></code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6tkpjwsbf2kntm51rlv2vpic0\"><a href=\"https://docs.imagekit.io/\">文档</a></td>\n</tr>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7vten968mvvi865x8ft1wbf6v\">Imgix</td>\n<td align=\"left\"><code><a href=\"api/common/provideImgixLoader\" class=\"code-anchor\">provideImgixLoader</a></code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4xsa7v5lzsx0i0uey94vnzply\"><a href=\"https://docs.imgix.com/\">文档</a></td>\n</tr>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4jttudolow46aiz15nsks7fks\">Netlify</td>\n<td align=\"left\"><code><a href=\"api/common/provideNetlifyLoader\" class=\"code-anchor\">provideNetlifyLoader</a></code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6nh75z1m4bjajnhd00rvb98m8\"><a href=\"https://docs.netlify.com/image-cdn/overview/\">文档</a></td>\n</tr>\n</tbody>\n</table>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"g14smsomu1lu5ajnzqqzjsmj\">要使用<strong>通用加载器</strong>，无需额外的代码更改。这是默认行为。</p>\n<h3 id=\"built-in-loaders\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"oigii9sun5bfiipr8kr5bv1k\">内置加载器<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#built-in-loaders\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6ny2uqn82hb3k0o5uob54xigu\">要将现有的加载器用于<strong>第三方图片服务</strong>，请将你选择的服务的提供者工厂添加到 <code>providers</code> 数组中。在下面的示例中，使用了 Imgix 加载器：</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  <a href=\"api/common/provideImgixLoader\" class=\"code-anchor\">provideImgixLoader</a>('https://my.base.url/'),\n],\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3jtnr8s503yscg0as4o7a48zt\">图片资产的基本 URL 应作为参数传递给提供者工厂。对于大多数网站，此基本 URL 应匹配以下模式之一：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"p732nq9rrjb7fmuowft10r3s\"><a href=\"https://yoursite.yourcdn.com\">https://yoursite.yourcdn.com</a></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ejr0wn6nxs7hlxuo9wkhlfwnz\"><a href=\"https://subdomain.yoursite.com\">https://subdomain.yoursite.com</a></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4v5urgstwz1qs6rqqmrhlybcg\"><a href=\"https://subdomain.yourcdn.com/yoursite\">https://subdomain.yourcdn.com/yoursite</a></li>\n</ul>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dfpi92mmb4efycsyxh7cdufam\">你可以在相应 CDN 提供者的文档中了解有关基本 URL 结构的更多信息。</p>\n<h3 id=\"custom-loaders\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1jpn1z8xktu8rlfraic7d4jdr\">自定义加载器<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#custom-loaders\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c5n5zykmv61xdsjyv0x3uy4as\">要使用<strong>自定义加载器</strong>，请提供你的加载器函数作为 <code><a href=\"api/common/IMAGE_LOADER\" class=\"code-anchor\">IMAGE_LOADER</a></code> DI 标记的值。在下面的示例中，自定义加载器函数会返回一个以 <code>https://example.com</code> 开头的 URL，其中包含 <code>src</code> 和 <code>width</code> 作为 URL 参数。</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  {\n    provide: <a href=\"api/common/IMAGE_LOADER\" class=\"code-anchor\">IMAGE_LOADER</a>,\n    useValue: (config: <a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a>) =&gt; {\n      return `https://example.com/images?src=${config.src}&amp;width=${config.width}`;\n    },\n  },\n],\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b74hflmy4crqntabuvfmqy6gm\"><code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> 指令的加载器函数将 <code><a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a></code> 类型的对象（来自 <code>@angular/common</code> ）作为其参数，并返回图像资产（assets）的绝对 URL。<code><a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a></code> 对象包含 <code>src</code> 属性，以及可选的 <code>width</code> 和 <code>loaderParams</code> 属性。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b3q7rfajdqe6zssnjb144w9c2\">注意：即使 <code>width</code> 属性可能并不总是存在，自定义加载器也必须使用它来支持请求各种宽度的图像，以便让 <code>ngSrcset</code> 正常工作。</p>\n<h3 id=\"the-loaderparams-property\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"915aqv1gdigmktr4atu2km4z1\"><code>loaderParams</code> 属性<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#the-loaderparams-property\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3v8j6wxgqa78giybdwj1gjvgv\">在\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>指令中支持的另一个属性是\n<code>loaderParams</code>，专门设计用于支持自定义加载器的使用。 \n<code>loaderParams</code>属性接受一个带有任意属性的对象作为值，本身不会执行任何操作。 \n<code>loaderParams</code>中的数据被添加到传递给自定义加载器的\n<code><a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a></code>对象中，可用于控制加载器的行为。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4gilijo8758ewahbfh3nmzg54\"><code>loaderParams</code> 的一个常见用途是控制高级图像 CDN 功能。</p>\n<h3 id=\"example-custom-loader\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2cx45n3ovvoj5qf8l0kmh32hz\">示例自定义加载器<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#example-custom-loader\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4lq3rcmiaadwxjv9jhheyfzd1\">下面显示了自定义加载器函数的示例。此示例函数连接 <code>src</code> 和 <code>width</code>，并使用 <code>loaderParams</code> 控制圆角的自定义 CDN 功能：</p>\n<code-example format=\"typescript\" language=\"typescript\">\nconst myCustomLoader = (config: <a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a>) =&gt; {\n  let url = `https://example.com/images/${config.src}?`;\n  let queryParams = [];\n  if (config.width) {\n    queryParams.push(`w=${config.width}`);\n  }\n  if (config.loaderParams?.roundedCorners) {\n    queryParams.push('mask=corners&amp;corner-radius=5');\n  }\n  return url + queryParams.join('&amp;');\n};\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8rmx27qyfrh4a84u8vvwbaxjl\">请注意，在上面的示例中，我们发明了“roundedCorners”属性名称来控制自定义加载器的特性。然后我们可以在创建图像时使用此特性，如下所示：</p>\n<code-example format=\"html\" language=\"html\">\n\n&lt;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"profile.jpg\" width=\"300\" height=\"300\" [loaderParams]=\"{roundedCorners: true}\"&gt;\n\n</code-example>\n<h2 id=\"frequently-asked-questions\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4z2ris4lq84izy0gkq4s2l2gu\">常见问题<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#frequently-asked-questions\"><i class=\"material-icons\">link</i></a></h2>\n<h3 id=\"does-ngoptimizedimage-support-the-background-image-css-property\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2qy2lf4vsutah9n033bhwesg3\">NgOptimizedImage是否支持\n<code>background-image</code> CSS属性？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#does-ngoptimizedimage-support-the-background-image-css-property\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2ahyaxa4sjzuycciqsv0y63o6\">NgOptimizedImage没有直接支持\n<code>background-image</code> CSS属性，但是它设计得很容易适应将图像作为另一个元素的背景的用例。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3ijx1mx0ohykknkfeebiei5k7\">以下是从\n<code>background-image</code>迁移到\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>的简单逐步过程。在这些步骤中，我们将把具有图像背景的元素称为“包含元素”：</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4zjbombcmjwv9yt8ovgy3832a\">1) 从包含元素中删除\n<code>background-image</code>样式。 2) 确保包含元素具有\n<code>position: \"relative\"</code>，\n<code>position: \"fixed\"</code>或\n<code>position: \"absolute\"</code>。 3) 创建一个新的图像元素作为包含元素的子元素，使用\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code>来启用\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>指令。 4) 给该元素添加\n<code>fill</code>属性。不包括\n<code>height</code>和\n<code>width</code>。 5) 如果您认为这个图像可能是您的\n<a href=\"https://web.dev/lcp/\">LCP元素</a>，请向图像元素添加\n<code>priority</code>属性。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5fnmzx0lgx75rotn1npptk4tp\">您可以根据“使用填充模式”部分中描述的方式调整背景图像如何填充容器。</p>\n<h3 id=\"why-cant-i-use-src-with-ngoptimizedimage\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dk1fnzlot0i7b8y7e3camxava\">为什么不能在\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>中使用\n<code>src</code>？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#why-cant-i-use-src-with-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"694p03zzrszboen1b1kicfppc\">由于围绕浏览器如何加载图像的技术考虑，选择了\n<code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code>属性作为NgOptimizedImage的触发器。 NgOptimizedImage对\n<code>loading</code>属性进行了编程更改--如果浏览器在进行这些更改之前看到\n<code>src</code>属性，它将开始急切地下载图像文件，并且加载更改将被忽略。</p>\n<h3 id=\"can-i-use-two-different-image-domains-in-the-same-page\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dkki7xx46w4n8llkfhbqxzt6g\">我可以在同一页中使用两个不同的图像域吗？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#can-i-use-two-different-image-domains-in-the-same-page\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9ks616olwglftw703nvvrew0\">图像加载器提供程序模式旨在尽可能简单地满足仅在组件中使用单个图像CDN的常见用例。 但是，仍然可以通过单个提供程序管理多个图像CDN。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cyhztm2yex7kxqrlkk801hkf9\">为此，我们建议编写一个使用\n<code>loaderParams</code>属性传递指定应使用哪个图像CDN的标志，并根据该标志调用适当加载器的\n<a href=\"guide/image-directive#custom-loaders\">自定义图像加载器</a>。</p>\n<h3 id=\"why-is-a-preconnect-element-not-being-generated-for-my-image-domain\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dsra7ju943iiwfoijlo70y0rz\">为什么不为我的图像域生成预连接元素？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#why-is-a-preconnect-element-not-being-generated-for-my-image-domain\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1t8vcabs3j1mhe9j7dkj0mx0w\">基于对应用程序的静态分析执行的预连接生成。这意味着图片域必须直接包含在加载器参数中，如以下示例：</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  <a href=\"api/common/provideImgixLoader\" class=\"code-anchor\">provideImgixLoader</a>('https://my.base.url/'),\n],\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dt4d9zgvf1q6j9ja06nq1izlt\">如果你使用变量将域字符串传递给加载器，或者你没有使用加载器，静态分析将无法识别域，并且不会生成预连接链接。在这种情况下，你应该手动向文档头部添加一个预连接链接，如上述描述。</p>\n<h3 id=\"can-you-add-a-new-built-in-loader-for-my-preferred-cdn\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9vrn6pedzta7flxvpak6t6ekj\">你能为我偏好的 CDN 添加一个新的内置加载器吗？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#can-you-add-a-new-built-in-loader-for-my-preferred-cdn\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4b08sjxwjwg71wgghvd8gj24f\">出于维护原因，我们目前不打算在 Angular 存储库中支持额外的内置加载器。相反，我们鼓励开发人员将任何额外的图片加载器发布为第三方包。</p>\n<!-- links -->\n<!-- external links -->\n<!--end links -->\n\n  <div class=\"reviewed\">最后复查时间：Tue Jul 18 2023</div>\n</div>\n\n\n<!-- links to this doc:\n - api/common\n - api/common/ImageConfig\n - guide/update-to-version-15\n-->\n<!-- links from this doc:\n - /guide/ssr\n - /guide/standalone-components\n - api/common/IMAGE_CONFIG\n - api/common/IMAGE_LOADER\n - api/common/ImageLoaderConfig\n - api/common/NgOptimizedImage\n - api/common/PRECONNECT_CHECK_BLOCKLIST\n - api/common/provideCloudflareLoader\n - api/common/provideCloudinaryLoader\n - api/common/provideImageKitLoader\n - api/common/provideImgixLoader\n - api/common/provideNetlifyLoader\n - guide/image-directive#adjusting-image-styling\n - guide/image-directive#advanced-sizes-values\n - guide/image-directive#automatic-placeholders\n - guide/image-directive#built-in-loaders\n - guide/image-directive#can-i-use-two-different-image-domains-in-the-same-page\n - guide/image-directive#can-you-add-a-new-built-in-loader-for-my-preferred-cdn\n - guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\n - guide/image-directive#custom-loaders\n - guide/image-directive#data-url-placeholders\n - guide/image-directive#disabling-automatic-srcset-generation\n - guide/image-directive#disabling-image-lazy-loading\n - guide/image-directive#does-ngoptimizedimage-support-the-background-image-css-property\n - guide/image-directive#example-custom-loader\n - guide/image-directive#fixed-size-images\n - guide/image-directive#frequently-asked-questions\n - guide/image-directive#getting-started\n - guide/image-directive#getting-started-with-ngoptimizedimage\n - guide/image-directive#non-blurred-placeholders\n - guide/image-directive#performance-features\n - guide/image-directive#request-images-at-the-correct-size-with-automatic-srcset\n - guide/image-directive#resource-hints\n - guide/image-directive#responsive-images\n - guide/image-directive#step-1-import-ngoptimizedimage\n - guide/image-directive#step-2-optional-set-up-a-loader\n - guide/image-directive#step-3-enable-the-directive\n - guide/image-directive#step-4-mark-images-as-priority\n - guide/image-directive#step-5-include-height-and-width\n - guide/image-directive#the-loaderparams-property\n - guide/image-directive#using-fill-mode\n - guide/image-directive#using-placeholders\n - guide/image-directive#why-cant-i-use-src-with-ngoptimizedimage\n - guide/image-directive#why-is-a-preconnect-element-not-being-generated-for-my-image-domain\n - http://web.dev/lcp\n - https://cloudinary.com/documentation/resizing_and_cropping\n - https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/loading#value\n - https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\n - https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/srcset\n - https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit\n - https://developer.mozilla.org/en-US/docs/Web/CSS/object-position\n - https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload\n - https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs\n - https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs#encoding_data_into_base64_format\n - https://developers.cloudflare.com/images/image-resizing/\n - https://docs.imagekit.io/\n - https://docs.imgix.com/\n - https://docs.netlify.com/image-cdn/overview/\n - https://subdomain.yourcdn.com/yoursite\n - https://subdomain.yoursite.com\n - https://web.dev/browser-level-image-lazy-loading\n - https://web.dev/codelab-density-descriptors/\n - https://web.dev/css-web-vitals/#images-and-largest-contentful-paint-lcp\n - https://web.dev/css-web-vitals/#images-and-layout-shifts\n - https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options\n - https://web.dev/lcp/\n - https://web.dev/lcp/#what-elements-are-considered\n - https://web.dev/learn/design/responsive-images/#sizes\n - https://web.dev/patterns/web-vitals-patterns/images/img-tag\n - https://web.dev/preconnect-and-dns-prefetch\n - https://web.dev/priority-hints\n - https://yoursite.yourcdn.com\n-->"}