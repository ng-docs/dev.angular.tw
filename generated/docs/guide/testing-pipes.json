{"id":"guide/testing-pipes","title":"測試通道","contents":"<div class=\"content\">\n  <h1 id=\"testing-pipes\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"d2ymw98ugrj0bw4ej7m4vgkf8\">測試通道<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing-pipes#testing-pipes\"><i class=\"material-icons\">link</i></a></h1>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6hsf2g6xw094a6lvfxhucsvo8\">你可以在不使用 Angular 測試工具的情況下測試\n<a href=\"guide/pipes-overview\">通道</a>。</p>\n<div class=\"alert is-helpful\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3jhe3g7pull8hzqtm08p46wf0\">如果你要試驗本指南中所講的應用，請<live-example name=\"testing\" nodownload=\"\">在瀏覽器中執行它</live-example>或<live-example name=\"testing\" downloadonly=\"\">下載並在本地執行它</live-example>。</p>\n</div>\n<h2 id=\"testing-the-titlecasepipe\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"d0cppl5o62v3aoiyhoptbwuno\">測試 <code><a href=\"api/common/TitleCasePipe\" class=\"code-anchor\">TitleCasePipe</a></code><a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing-pipes#testing-the-titlecasepipe\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cqo45x7kjw0cj03g3kb5xn633\">這個通道類有一個方法 <code>transform</code>，它把輸入值變成一個轉換後的輸出值。<code>transform</code> 的實現很少會與 DOM 互動。除了 <code>@<a href=\"api/core/Pipe\" class=\"code-anchor\">Pipe</a></code> 元資料和一個介面之外，大多數通道都不依賴於 Angular。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"duns4hg9dwvpntmgd3mgub3ui\">考慮一個 <code><a href=\"api/common/TitleCasePipe\" class=\"code-anchor\">TitleCasePipe</a></code>，它會把每個單詞的第一個字母大寫。這裡是透過正則表示式實現的。</p>\n<code-example header=\"app/shared/title-case.pipe.ts\" path=\"testing/src/app/shared/title-case.pipe.ts\">\nimport { <a href=\"api/core/Pipe\" class=\"code-anchor\">Pipe</a>, <a href=\"api/core/PipeTransform\" class=\"code-anchor\">PipeTransform</a> } from '@angular/core';\n\n@<a href=\"api/core/Pipe\" class=\"code-anchor\">Pipe</a>({ name: 'titlecase', standalone: true, pure: true })\n/** Transform to <a href=\"api/platform-browser/Title\" class=\"code-anchor\">Title</a> Case: uppercase the first letter of the words in a string. */\nexport class <a href=\"api/common/TitleCasePipe\" class=\"code-anchor\">TitleCasePipe</a> implements <a href=\"api/core/PipeTransform\" class=\"code-anchor\">PipeTransform</a> {\n  transform(input: string): string {\n    return input.length === 0\n      ? ''\n      : input.replace(/\\w\\S*/g, (txt) =&gt; txt[0].toUpperCase() + txt.slice(1).toLowerCase());\n  }\n}\n\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"64osqp3hrhq44i9c6fejc0d7x\">任何使用正則表示式的東西都值得徹底測試。使用簡單的 Jasmine 來探索預期的案例和邊緣情況。</p>\n<code-example header=\"app/shared/title-case.pipe.spec.ts\" path=\"testing/src/app/shared/title-case.pipe.spec.ts\" region=\"excerpt\">\ndescribe('<a href=\"api/common/TitleCasePipe\" class=\"code-anchor\">TitleCasePipe</a>', () =&gt; {\n  // This pipe is a pure, stateless function so no need for BeforeEach\n  const pipe = new <a href=\"api/common/TitleCasePipe\" class=\"code-anchor\">TitleCasePipe</a>();\n\n  it('transforms \"abc\" to \"Abc\"', () =&gt; {\n    expect(pipe.transform('abc')).toBe('Abc');\n  });\n\n  it('transforms \"abc def\" to \"Abc Def\"', () =&gt; {\n    expect(pipe.transform('abc def')).toBe('Abc Def');\n  });\n\n  // ... more tests ...\n});\n\n</code-example>\n<p><a id=\"write-tests\"></a></p>\n<h2 id=\"writing-dom-tests-to-support-a-pipe-test\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9sdo0o7rhjy78xut0teh3jw0l\">編寫 DOM 測試來支援通道測試<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing-pipes#writing-dom-tests-to-support-a-pipe-test\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dlpd91jl1yzwou7nf86134iqd\">這些都是對通道進行<em>隔離</em>測試的。他們無法判斷當 <code><a href=\"api/common/TitleCasePipe\" class=\"code-anchor\">TitleCasePipe</a></code> 應用於元件中時是否能正常執行。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1pqgnklmt2rjs9c0bvp3po8of\">考慮新增這樣的元件測試：</p>\n<code-example header=\"app/hero/hero-detail.component.spec.ts (pipe test)\" path=\"testing/src/app/hero/hero-detail.component.spec.ts\" region=\"title-case-pipe\">\nit('should convert hero name to <a href=\"api/platform-browser/Title\" class=\"code-anchor\">Title</a> Case', () =&gt; {\n  // get the name's input and display elements from the DOM\n  const hostElement: HTMLElement = harness.routeNativeElement!;\n  const nameInput: HTMLInputElement = hostElement.querySelector('input')!;\n  const nameDisplay: HTMLElement = hostElement.querySelector('span')!;\n\n  // simulate user entering a new name into the input box\n  nameInput.value = 'quick BROWN  fOx';\n\n  // Dispatch a DOM event so that Angular learns of input value change.\n  nameInput.dispatchEvent(new <a href=\"api/router/Event\" class=\"code-anchor\">Event</a>('input'));\n\n  // Tell Angular to update the display binding through the title pipe\n  harness.detectChanges();\n\n  expect(nameDisplay.textContent).toBe('Quick Brown  Fox');\n});\n\n\n</code-example>\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最後複查時間：Thu Sep 07 2023</div>\n</div>\n\n\n<!-- links to this doc:\n - guide/testing\n-->\n<!-- links from this doc:\n - api/common/TitleCasePipe\n - api/core/Pipe\n - api/core/PipeTransform\n - api/platform-browser/Title\n - api/router/Event\n - guide/pipes-overview\n - guide/testing-pipes#testing-pipes\n - guide/testing-pipes#testing-the-titlecasepipe\n - guide/testing-pipes#writing-dom-tests-to-support-a-pipe-test\n-->"}