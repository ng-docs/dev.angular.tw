{"id":"guide/update-to-version-16","title":"更新到 Angular v16","contents":"<div class=\"content\">\n  <h1 id=\"update-angular-to-v16\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8c96yd6c0gy47872t4wgc0y2a\">更新到 Angular v16<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#update-angular-to-v16\"><i class=\"material-icons\">link</i></a></h1>\n<!-- NOTE to writers: When creating the topic for the next version,                               -->\n<!--   remember to update the redirect link in angular/aio/firebase.json                          -->\n<!-- To update the redirect link in angular/aio/firebase.json:                                    -->\n<!--   1. Search for the entry in firebase.json with \"source\": \"guide/update-to-latest-version\"   -->\n<!--   2,  Update the destination value to refer to the new guide's URL                           -->\n<!--                                                                                              -->\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1w3w4gwufyfycg4qoof680rql\">本主题会提供如何将 Angular 应用程序更新到第 16 版的信息。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bmaqf8wxy3ubcvvqyqlfhfdxb\">有关此信息的摘要以及将 Angular 应用程序更新到 v16 的分步过程，请参阅<a href=\"https://update.angular.io\">Angular 更新指南</a>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4z60xxbu42n1m49629j8zfqij\"><a href=\"https://update.angular.io\">Angular 更新指南</a>和本主题中的信息是从这些更改日志中总结的：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8p1tcoqjybbamoiwriuz5dvk4\"><a href=\"https://github.com/angular/angular/blob/main/CHANGELOG.md\">angular/angular 库的变更日志</a></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4vjkm26a9sl0gyxbjwpa7l2ql\"><a href=\"https://github.com/angular/angular-cli/blob/main/CHANGELOG.md\">angular/angular-cli 库的变更日志</a></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6ywcwq8fnzlusplbto7k5i79f\"><a href=\"https://github.com/angular/components/blob/main/CHANGELOG.md\">angular/components 库的变更日志</a></li>\n</ul>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1ad861fn1x7sdy4b0sjc6fpio\">有关将 Angular 应用程序更新到 v15 的信息已归档在<a href=\"/guide/update-to-version-15\">更新到版本 15</a>中。</p>\n<p><a id=\"new-features\"></a></p>\n<h2 id=\"feature-highlights-in-angular-v16\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ag4tbzp1rr78mchxf7ytnjk33\">Angular v16 中的亮点特性<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#feature-highlights-in-angular-v16\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5ow70asr1peibwjqevzrahx8r\">如需更全面的新特性列表，请参阅<a href=\"https://blog.angular.io\">有关 v16 更新的 Angular 博客文章</a>。</p>\n<!-- markdownLint-disable MD001 -->\n<h4 id=\"angular-signals-developer-preview\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dkyh9h9otiwdpbcfio7cxsd4s\">Angular 信号（Signal）的开发者预览<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#angular-signals-developer-preview\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c9umbxger6szhfag6wvn2qlnb\">此版本包括 Angular 的新响应式基础的第一个开发者预览：<code><a href=\"api/core/signal\" class=\"code-anchor\">signal</a></code>、<code><a href=\"api/core/computed\" class=\"code-anchor\">computed</a></code> 和 <code><a href=\"api/core/effect\" class=\"code-anchor\">effect</a></code>。有关详细信息，请参阅<a href=\"/guide/signals\">信号指南</a>；有关更多背景信息，请参阅<a href=\"https://github.com/angular/angular/discussions/49685\">Angular Signals RFC</a>。</p>\n<h4 id=\"enhanced-hydration-developer-preview\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6tkxmlkmdtrdzhhsanakxgpp0\">增强水合功能的开发者预览版<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#enhanced-hydration-developer-preview\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5ipbee1pl6vdubz29dmgzoubq\">以前，当 Angular 在服务端渲染或编译时预渲染过的页面上启动时，框架会丢弃任何现有的 DOM 节点并从头开始重新渲染。借助 v16 增强的水合支持，你可以选择让 Angular 复用这些现有的 DOM 节点。此开发者预览功能可以在许多场景中提高页面加载性能。有关详细信息，请参阅完整的<a href=\"/guide/hydration\">水合指南</a>。</p>\n<h3 id=\"faster-builds-with-the-esbuild-developer-preview\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"d0xkdptxhcjrggfkeb1jod0x\">使用 esbuild 开发者预览版加快构建速度<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#faster-builds-with-the-esbuild-developer-preview\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"av61xzb5t7r1m6v52bfh58oa9\">v16 为你带来了 Angular CLI 基于 <a href=\"https://esbuild.github.io\">esbuild</a> 的新构建器的开发者预览版。这种新架构可以在许多场景中显著缩短构建时间。此预览版还包括与 <a href=\"https://vitejs.dev\">Vite</a> 的集成，以支持 CLI 开发服务器。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bs2vfw6pc3arwic0wxpd2fh8d\">你可以通过更新 <code>angular.json</code> 来尝试这种新的构建设置：</p>\n<code-example language=\"json\">\n\"architect\": {\n  \"build\": {\n    \"builder\": \"@angular-devkit/build-angular:browser-esbuild\",\n</code-example>\n<h3 id=\"standalone-component-migration-and-scaffolding\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3dyjvp7ew200pstbfj9fpc0oo\">独立组件迁移和脚手架<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#standalone-component-migration-and-scaffolding\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2ezmkuiuihhpwh6z5snjumbaw\">为了支持开发者将他们的应用程序转换为独立 API，Angular v16 包括了一些迁移原理图和独立迁移指南。这些工具大大减少了将代码迁移到独立组件、指令和管道时所需的工作量。有关详细信息，请访问 <a href=\"/guide/standalone-migration\">独立迁移指南</a>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"kfubhxu79i45n4co5e1j0le2\">你现在还可以通过运行以下命令来生成具有独立组件的新 Angular 应用程序：</p>\n<code-example language=\"sh\">\nng new --standalone\n</code-example>\n<h3 id=\"required-inputs\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"aboe7p0ln2s5rbsxbngmej61z\">必备的输入属性<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#required-inputs\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6akm3ga46b5jhgurlyp6o0lsi\">你现在可以把组件和指令的输入属性标记为<strong>必备的</strong>：</p>\n<code-example language=\"typescript\">\nexport class ColorPicker {\n  @<a href=\"api/core/Input\" class=\"code-anchor\">Input</a>({ required: true }) defaultColor!: string;\n}\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3xq2lvdqdvio7ba5jrfctmkfv\">如果模板包含一个组件，但没有指定其所有必备输入属性，Angular 就会在构建时报告错误。</p>\n<p><a id=\"breaking-changes\"></a></p>\n<h2 id=\"highlighted-breaking-changes-in-angular-v16\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9uk4ns0nuz2sfp65tgnsc7esq\">Angular v16 重大变更中的亮点<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#highlighted-breaking-changes-in-angular-v16\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6l2uq9q6l26zqu82bdg58420k\">有关重大更改的完整列表，请参阅 GitHub 上的完整变更日志。</p>\n<p><a id=\"v16-bc-01\"></a></p>\n<h3 id=\"angular-v16-requires-nodejs-version-v16-or-v18\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9l2exes9z6akilcfq5zyfzhno\">Angular v16 需要 node.js 版本 v16 或 v18<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#angular-v16-requires-nodejs-version-v16-or-v18\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"76sdk7n9tztk89qh6konhsixd\">Angular 需要 node.js v16 或 v18。<a href=\"https://github.com/angular/angular/pull/49255\">PR #47730</a></p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7h86l3ewnugvd90sdni731l62\">有关完整版本兼容性的详细信息，请参阅<a href=\"/guide/versions\">版本兼容性</a>。</p>\n<p><a id=\"v16-bc-02\"></a></p>\n<h3 id=\"angular-v16-requires-typescript-version-49-or-later\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3233gfaipgicii4lvxvh6ro8i\">Angular v16 需要 TypeScript 4.9 或更高版本<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#angular-v16-requires-typescript-version-49-or-later\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"f9var9yaixivmev0xq8b17tq\">在 Angular v16 中，支持 TypeScript 版本从 4.9.3 到 5.2.0（不包括），不支持早于 4.9.3 的版本。 \n<a href=\"https://github.com/angular/angular/pull/49155\">PR #49155</a></p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7h86l3ewnugvd90sdni731l62\">有关完整版本兼容性的详细信息，请参阅<a href=\"/guide/versions\">版本兼容性</a>。</p>\n<p><a id=\"v16-bc-03\"></a></p>\n<h3 id=\"angular-compatibility-compiler-ngcc-has-been-removed\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4m32wfnnskerbkrpn4r38r3zi\">Angular 兼容性编译器（ngcc）已被删除<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#angular-compatibility-compiler-ngcc-has-been-removed\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5ty2hpm3kjuo95vb8wke6y1kp\">Angular 兼容性编译器（ngcc）是一种构建工具，可促进 Angular 之前的编译器和渲染架构（View Engine）与其新架构（Ivy）之间的兼容性。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8m401hjoa1hg57otn4b083upm\">View Engine 已在 Angular v13 中移除了，到 v16 也最终移除了 ngcc。因此，使用 View Engine 构建的 Angular 库不能在 Angular v16+ 中使用。</p>\n<p><a id=\"v16-bc-04\"></a></p>\n<h4 id=\"angular-package-format-changes\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e5isfu74s9ph2pxwwy9i9se1r\">Angular 包格式更改<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#angular-package-format-changes\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6g5at0r3ru51oa8orytr8imol\">Angular 包格式（APF）已更新，包含以下更改：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"trmro67gmjawcpxo2844ix6m\">扁平化 ESM 2015（FESM2015）输出已被移除。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"f4coffp69gb103axzfqgalepe\">EcmaScript 2020 输出已更新为 EcmaScript 2022（包括扁平化输出）。</li>\n</ul>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"37ix7mofmrn03oq1liwktjkl1\">有关背景，请参阅 <a href=\"/guide/angular-package-format\">Angular 包格式</a>。</p>\n<p><a id=\"v16-bc-06\"></a></p>\n<h4 id=\"reflectiveinjector-has-been-removed\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5iu6tpyr48plygcetxql4yu12\"><code>ReflectiveInjector</code> 已移除<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#reflectiveinjector-has-been-removed\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9zwo0iq8udu3bpb2obmyhtxlh\"><code>ReflectiveInjector</code> 和相关符号已移除。请更新代码以避免引用 <code>ReflectiveInjector</code> 符号。请改用 <code>Injector.create</code> 来创建一个注入器。</p>\n<p><a id=\"v16-bc-07\"></a></p>\n<h4 id=\"updated-behavior-for-routercreateurltree\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b4brk1d72vws51m6x1cm253yw\">更新了 <code>Router.createUrlTree</code> 的行为<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#updated-behavior-for-routercreateurltree\"><i class=\"material-icons\">link</i></a></h4>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7otfskuvw63zoapm11o0vbov9\">可能需要调整对 <code><a href=\"api/router/ActivatedRoute\" class=\"code-anchor\">ActivatedRoute</a></code> 实例的测试进行模拟（Mock），因为 Router.createUrlTree 现在可以在更多场景中做正确的事情。这意味着使用无效/不完整的 ActivatedRoute 进行模拟时的测试行为可能与以前不同。此外，测试现在可以导航到真正的 URL 了，而之前它们会导航到根目录。请确保测试提供了匹配的预期路由。这很少会对生产代码产生影响，但已经发现，当使用未出现在当前路由器状态中的 <code><a href=\"api/router/ActivatedRoute\" class=\"code-anchor\">ActivatedRoute</a></code> 时的相对导航以前被忽略了（现在与期望的行为一致）。通过创建正确的 URL，这偶尔会导致应用程序中出现与以前不同的导航行为。大多数情况下，当尝试创建仅使用空命令数组更新查询参数的导航时就会发生这种情况，例如 <code>router.navigate([], {relativeTo: route, queryParams: newQueryParams})</code>。在这种情况下，应该删除 <code>relativeTo</code> 属性。</p>\n<p><a id=\"deprecations\"></a></p>\n<h2 id=\"deprecations-highlights-in-angular-v16\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"xzn8zz6uz5k4hztn007p6x74\">Angular v16 弃用中的亮点<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/update-to-version-16#deprecations-highlights-in-angular-v16\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"27gvnvjy1rmau3gj48o3ait70\">这些 API 在 v16 中仍然可用，但可能会在未来版本中被移除，如 Angular 的\n<a href=\"/guide/releases#deprecation-policy\">弃用策略</a>所述。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"o3n0wfbp4icz228hgohmdgh6\">为了保持 Angular 应用程序的可靠性，只要条件允许，就应该尽快更新应用程序。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8rauhn4qvl8aihjj83daq48w4\">已移除</th>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b60cmg37kstj9qup38pt8swfn\">替代品</th>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3prlgfrx5eo2xqncnnob4crxu\">详情</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1htfs9h06pgvxcxwf12so1cl9\"><a id=\"v16-dp-01\"></a>类和 \n<code><a href=\"api/core/InjectionToken\" class=\"code-anchor\">InjectionToken</a></code> 路由守卫和解析器</td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8f8epqehr13tvwx8znyu185rp\">查看详情</td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7n4pp45n4kzs4zosyj9ohuw5t\">类和 \n<code><a href=\"api/core/InjectionToken\" class=\"code-anchor\">InjectionToken</a></code> 守卫和解析器已被弃用。相反，将守卫编写为普通的 JavaScript 函数，并使用 \n<code>@angular/core</code> 中的 \n<code>inject</code> 注入依赖。 \n<a href=\"https://github.com/angular/angular/pull/47924\">PR #47924</a></td>\n</tr>\n<tr>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5aivs9bc2k0utjcdig4bn725g\"><a id=\"v16-dp-02\"></a>多个 Angular Material 组件的 \n<code>ripple</code> 属性</td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6bs071f5k1m1udzmhtyd822xg\">无</td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"lg4mm3wa0ua7a7o79ebzxdia\"><code>MatButton</code>、\n<code>MatCheckbox</code>、\n<code>MatChip</code> 的 \n<code>ripple</code> 属性已被弃用。此更改将涟漪效果转移到组件的私有实现细节中。</td>\n</tr>\n</tbody>\n</table>\n\n  <div class=\"reviewed\">最后复查时间：Wed May 03 2023</div>\n</div>\n\n\n<!-- links to this doc:\n-->\n<!-- links from this doc:\n - /guide/angular-package-format\n - /guide/hydration\n - /guide/releases#deprecation-policy\n - /guide/signals\n - /guide/standalone-migration\n - /guide/update-to-version-15\n - /guide/versions\n - api/core/InjectionToken\n - api/core/Input\n - api/core/computed\n - api/core/effect\n - api/core/signal\n - api/router/ActivatedRoute\n - guide/update-to-version-16#angular-compatibility-compiler-ngcc-has-been-removed\n - guide/update-to-version-16#angular-package-format-changes\n - guide/update-to-version-16#angular-signals-developer-preview\n - guide/update-to-version-16#angular-v16-requires-nodejs-version-v16-or-v18\n - guide/update-to-version-16#angular-v16-requires-typescript-version-49-or-later\n - guide/update-to-version-16#deprecations-highlights-in-angular-v16\n - guide/update-to-version-16#enhanced-hydration-developer-preview\n - guide/update-to-version-16#faster-builds-with-the-esbuild-developer-preview\n - guide/update-to-version-16#feature-highlights-in-angular-v16\n - guide/update-to-version-16#highlighted-breaking-changes-in-angular-v16\n - guide/update-to-version-16#reflectiveinjector-has-been-removed\n - guide/update-to-version-16#required-inputs\n - guide/update-to-version-16#standalone-component-migration-and-scaffolding\n - guide/update-to-version-16#update-angular-to-v16\n - guide/update-to-version-16#updated-behavior-for-routercreateurltree\n - https://blog.angular.io\n - https://esbuild.github.io\n - https://github.com/angular/angular-cli/blob/main/CHANGELOG.md\n - https://github.com/angular/angular/blob/main/CHANGELOG.md\n - https://github.com/angular/angular/discussions/49685\n - https://github.com/angular/angular/pull/47924\n - https://github.com/angular/angular/pull/49155\n - https://github.com/angular/angular/pull/49255\n - https://github.com/angular/components/blob/main/CHANGELOG.md\n - https://update.angular.io\n - https://vitejs.dev\n-->"}