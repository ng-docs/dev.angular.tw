{"id":"guide/language-service","title":"Angular 語言服務","contents":"<div class=\"content\">\n  <h1 id=\"angular-language-service\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2ha168k1thozk25n4q3jnrajw\">Angular 語言服務<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#angular-language-service\"><i class=\"material-icons\">link</i></a></h1>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dfsr1n1jxasz9jhcl6a0q6uh0\">Angular 語言服務為程式碼編輯器提供了一種在 Angular 範本中獲取自動補全、錯誤、提示和導向的方法。它支援位於獨立 HTML 檔案中的外部範本以及行內範本。</p>\n<h2 id=\"configuring-compiler-options-for-the-angular-language-service\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bttqlwqsgobew2o37aaxfu531\">設定 Angular 語言服務的編譯器選項<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#configuring-compiler-options-for-the-angular-language-service\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4k5hpigptvzo81pu1ia1rwg53\">要啟用最新的語言服務功能，請在 <code>tsconfig.json</code> 中將 <code>strictTemplates</code> 選項設定為 <code>true</code>，如以下範例所示：</p>\n<code-example language=\"json\">\n\n\"angularCompilerOptions\": {\n  \"strictTemplates\": true\n}\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8i6scvkcudkg5xgtrwiu74dao\">有關更多訊息，請參見 <a href=\"guide/angular-compiler-options\">Angular 編譯器選項</a>指南。</p>\n<h2 id=\"features\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"920kaz2p0y1fs418qurz1o45h\">屬性<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#features\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bcthhqwku53vcizzntgiaq6qh\">編輯器會自動檢測到你正在開啟 Angular 檔案。然後，它就會使用 Angular Language Service 讀取 <code>tsconfig.json</code> 檔案，查詢應用程式中具有的所有範本，然後為你開啟的任何範本提供語言服務。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b8c9o7g7wuf87k7iu202eijon\">語言服務包括：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"r00316x5cewu12v3ftrjp7t9\">自動補全清單</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3zmztekqkbyrjtkbfoe2i60n0\">AOT 診斷訊息</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"f1sa0wjcr81ixrpmk1h2b0fs\">快捷訊息</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4l4rqqo1d1pgyzcjpcmhj25it\">轉到定義</li>\n</ul>\n<h3 id=\"autocompletion\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4w9ffi3auytore9nkduori6b1\">自動補全<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#autocompletion\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1bajh55ze7ms6eu1nx1xtcwmo\">自動補全可以在輸入時為你提供當前情境下的候選內容和提示，從而提高開發速度。下面這個例子展示了內嵌中的自動補全功能。當你進行輸入的時候，就可以按 tab 鍵來自動補全。</p>\n<div class=\"lightbox\">\n<img alt=\"autocompletion\" src=\"generated/images/guide/language-service/language-completion.gif\" width=\"480\" height=\"72\">\n</div>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2gwzq5bnhaws9hwcexnzcvipn\">還有對元素的自動補全。你定義的任何元件的選擇器都會顯示在自動補全清單中。</p>\n<h3 id=\"error-checking\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"blguyj3yc9hlvge1yvc11dr16\">錯誤檢查<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#error-checking\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cqhstbdffn4cz57un7yvq8bf5\">Angular 語言服務能對程式碼中存在的錯誤進行預警。在這個例子中，Angular 不知道什麼是 <code>orders</code> 或者它來自哪裡。</p>\n<div class=\"lightbox\">\n<img alt=\"error checking\" src=\"generated/images/guide/language-service/language-error.gif\" width=\"480\" height=\"126\">\n</div>\n<h3 id=\"quick-info-and-navigation\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8hvxs76r3zyqizwcof6pbuc4j\">快捷訊息與導向<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#quick-info-and-navigation\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"48k3211uq8spapkggs8y4bn3t\">快捷訊息功能使你可以懸停以檢視元件、指令、模組等的來源。然後，你可以單擊『轉到定義』或按 F12 鍵直接轉到定義。</p>\n<div class=\"lightbox\">\n<img alt=\"navigation\" src=\"generated/images/guide/language-service/language-navigation.gif\" width=\"392\" height=\"186\">\n</div>\n<h2 id=\"angular-language-service-in-your-editor\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"97hsiplyxlq186tso3zl8bb4k\">編輯器中的 Angular 語言服務<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#angular-language-service-in-your-editor\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1wo1gg9tfnl8hjd8nrhaahvwm\">Angular 語言服務目前在<a href=\"https://code.visualstudio.com\">Visual Studio Code</a>和<a href=\"https://www.jetbrains.com/webstorm\">WebStorm</a>、<a href=\"https://www.sublimetext.com/\">Sublime Text</a> 和 <a href=\"https://www.eclipse.org/eclipseide/\">Eclipse IDE</a> 中都有可用的擴充套件。</p>\n<h3 id=\"visual-studio-code\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cm6n2qbzmvydr12efbe7np4bb\">Visual Studio Code<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#visual-studio-code\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5yzx3v5mxu18ee235vbx3jlkm\">在 <a href=\"https://code.visualstudio.com\">Visual Studio Code 中</a>，從 『<a href=\"https://marketplace.visualstudio.com/items?itemName=Angular.ng-template\">擴充套件程式：市場</a> 中安裝擴充套件程式。可以用左側選單窗格中的擴充套件程式圖示從編輯器中開啟市場，或使用 VS 快速開啟（在 Mac 上為 ⌘+ P，在 Windows 上為 CTRL + P）並輸入『? ext』。在市場中，搜尋 Angular Language Service 擴充套件，並點選 <strong>Install</strong> 按鈕。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e0ldi9hks54m02zlp0e93t4p7\">Visual Studio Code 與 Angular 語言服務的整合工作是由 Angular 團隊發布的。</p>\n<h3 id=\"visual-studio\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ep6dskylmuoww2m8zoo38arht\">Visual Studio<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#visual-studio\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8hc8uatxlpqtal0ccnpcvgm65\">在 <a href=\"https://visualstudio.microsoft.com\">Visual Studio 中</a>，從<a href=\"https://marketplace.visualstudio.com/items?itemName=TypeScriptTeam.AngularLanguageService\">『擴充套件程式：市場』</a>中安裝擴充套件程式。可以從編輯器中開啟市場，在頂部選單窗格中選擇『擴充套件』，然後選擇『管理擴充套件』。在市場上，搜尋 Angular Language Service extension，然後單擊<strong>『安裝』</strong>按鈕。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7qjmafc7x5exr6huxdhg50yiw\">Microsoft 在 Angular 團隊的幫助下維護和發布了 Visual Studio 與 Angular 語言服務的整合。<a href=\"https://github.com/microsoft/vs-ng-language-service\">在這裡</a>檢視專案。</p>\n<h3 id=\"webstorm\">WebStorm<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#webstorm\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3n5t9g6ruy3urawup2t3blhk8\">在 <a href=\"https://www.jetbrains.com/webstorm\">WebStorm</a> 中，啟用 <a href=\"https://plugins.jetbrains.com/plugin/6971-angular-and-angularjs\">Angular 與 AngularJS</a> 外掛。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4kmwrgl42lkbb0r4lwvg748k3\">從 WebStorm 2019.1 開始，<code>@angular/language-service</code> 已經不再需要了，應該從你的 <code>package.json</code> 中移除。</p>\n<h3 id=\"sublime-text\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3e2o1wsmuybxgc5urmh2zuq5q\">Sublime Text<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#sublime-text\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ee7jk29advl6jt0fcjs6gepzf\">在 <a href=\"https://www.sublimetext.com\">Sublime Text</a> 中，當安裝為外掛時，語言服務僅支援行內範本。你需要自定義 Sublime 外掛（或修改當前外掛），來實現 HTML 檔案中的自動補齊。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1t2kzz41zw0v1l8v21tqaqpnb\">要想在行內範本中使用語言服務，你必須首先新增一個擴充套件，以支援 TypeScript，然後安裝 Angular 語言服務外掛。從 TypeScript 2.3 開始，TypeScript 提供了一個外掛模型，供語言服務使用。</p>\n<ol>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cg7uupfbo76qv1s638mxyyobb\">把最新版本的 TypeScript 安裝到本地的 <code>node_modules</code> 目錄下：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nnpm install --save-dev typescript\n\n</code-example>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"qph8o4snyx1czw6jdcmjyah0\">把 Angular 語言服務的套件安裝到同一位置：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nnpm install --save-dev @angular/language-service\n\n</code-example>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"aq6ymh80hxl2eejiygrjj8858\">安裝好這個套件後，將以下內容新增到專案的 <code>tsconfig.json</code> 的 <code>\"compilerOptions\"</code> 部分。</p>\n<code-example header=\"tsconfig.json\" language=\"json\">\n\n\"plugins\": [\n    {\"name\": \"@angular/language-service\"}\n]\n\n</code-example>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bk630yukm7i0060w49p52090e\">在編輯器的使用者首選項（<code>Cmd+,</code> 或 <code>Ctrl+,</code>）中，新增以下內容：</p>\n<code-example header=\"Sublime Text user preferences\" language=\"json\">\n\n\"typescript-tsdk\": \"&lt;path to your folder&gt;/node_modules/typescript/lib\"\n\n</code-example>\n</li>\n</ol>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"31yt6oo7jin795v263388i0lr\">這樣就能讓 Angular 語言服務提供 <code>.ts</code> 檔案中的診斷與自動補全訊息。</p>\n<h3 id=\"eclipse-ide\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"diw85b1lkslv275rzf3qkmnyb\">Eclipse IDE<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#eclipse-ide\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"edpzxp72aiyci79d41cg578xa\">你或者直接安裝包含了 Angular Language Server 的 『Eclipse IDE for Web and JavaScript developers』 軟體套件，或者直接從其他 Eclipse IDE 軟體套件中安裝，使用『Help』 &gt; 『Eclipse Marketplace』 來查詢並安裝 <a href=\"https://marketplace.eclipse.org/content/wild-web-developer-html-css-javascript-typescript-nodejs-angular-json-yaml-kubernetes-xml\">Eclipse Wild Web Developer</a>。</p>\n<h3 id=\"neovim\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cjlldz5z4jvvr9b220k6hng6o\">Neovim<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#neovim\"><i class=\"material-icons\">link</i></a></h3>\n<ol>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2zpgwqocj6x7w65x4nn5dwm2b\"><a href=\"https://github.com/neoclide/coc.nvim\">設定 coc.nvim</a></p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"36yvebm0a90bexgagbjmtma36\"><a href=\"https://github.com/iamcco/coc-angular/issues/70#issuecomment-1616340751\">設定 Angular 語言服務</a></p>\n</li>\n</ol>\n<code-example>\n{\n  \"languageserver\": {\n    \"angular\": {\n      \"command\": \"ngserver\",\n      \"args\": [\n        \"--stdio\",\n        \"--tsProbeLocations\",\n        \"/usr/local/lib/node_modules/typescript/lib\",\n        \"--ngProbeLocations\",\n        \"/usr/local/lib/node_modules/@angular/language-server/bin\"\n      ],\n      \"filetypes\": [\"ts\", \"typescript\", \"html\"],\n      \"trace.server.verbosity\": \"verbose\"\n    }\n  }\n}\n</code-example>\n<h2 id=\"how-the-language-service-works\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dfr7wxgbd47jyqbbvcnayntf6\">語言服務的工作原理<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#how-the-language-service-works\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"42ce3c688z0zwmskrwnp614xp\">當你將編輯器與語言服務一起使用時，該編輯器將啟動一個單獨的語言服務程序，並使用<a href=\"https://microsoft.github.io/language-server-protocol\">語言服務協定</a>透過 <a href=\"https://en.wikipedia.org/wiki/Remote_procedure_call\">RPC</a> 與之通訊。當你輸入編輯器時，編輯器會將訊息傳送到語言服務流程，以跟蹤你的專案狀態。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"eggi44okc00vl1mleydgh8y95\">當你觸發範本中的完成清單時，編輯器首先將範本解析為 HTML <a href=\"https://en.wikipedia.org/wiki/Abstract_syntax_tree\">抽象語法樹（AST）</a>。Angular 編譯器解釋這棵樹以確定上下文：範本屬於哪個模組，當前作用域，元件選擇器以及游標在範本 AST 中的位置。然後，它就可以確定可能位於該位置的符號。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"evbk1rrj40m3v3h0iigbdzh98\">如果你要進行內嵌，則需要更多的精力。如果你在 <code>div</code> 有 <code>{{data.---}}</code> 的內嵌，並且在 <code>data.---</code> 之後需要自動補全清單，則編譯器無法使用 HTML AST 查詢答案。HTML AST 只能告訴編譯器某些文字帶有字元 『<code>{{data.---}}</code>』。那時範本解析器會生成一個表示式 AST，該表示式位於範本 AST 中。然後，Angular 語言服務會在其上下文中查詢 <code>data.---</code>，詢問 TypeScript 語言服務 <code>data</code> 的成員是什麼，並回傳可能性清單。</p>\n<h2 id=\"more-information\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"a4i4l0z1p0mxth3he9lk6m2op\">更多訊息<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/language-service#more-information\"><i class=\"material-icons\">link</i></a></h2>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9rvrneu0ht3y0f2cpsvo7rcin\">關於該實現的更多詳細訊息，請參閱 <a href=\"https://github.com/angular/angular/blob/main/packages/language-service/src/types.ts\">Angular 語言服務 API</a>。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4dq0m900dbtmohnbceurxqrwm\">關於此設計注意事項和意圖的更多訊息，請參閱<a href=\"https://github.com/angular/vscode-ng-language-service/wiki/Design\">此處的設計文件</a></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7jyya9dv0i2xus7ucw4ku6l65\">另請參閱 <a href=\"https://www.ng-conf.org\">ng-conf</a> 2017 上 Chuck Jazdzewski 關於 Angular 語言服務的 <a href=\"https://www.youtube.com/watch?v=ez3R0Gi4z5A&amp;t=368s\">演講</a></li>\n</ul>\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最後複查時間：Mon Feb 28 2022</div>\n</div>\n\n\n<!-- links to this doc:\n-->\n<!-- links from this doc:\n - guide/angular-compiler-options\n - guide/language-service#angular-language-service\n - guide/language-service#angular-language-service-in-your-editor\n - guide/language-service#autocompletion\n - guide/language-service#configuring-compiler-options-for-the-angular-language-service\n - guide/language-service#eclipse-ide\n - guide/language-service#error-checking\n - guide/language-service#features\n - guide/language-service#how-the-language-service-works\n - guide/language-service#more-information\n - guide/language-service#neovim\n - guide/language-service#quick-info-and-navigation\n - guide/language-service#sublime-text\n - guide/language-service#visual-studio\n - guide/language-service#visual-studio-code\n - guide/language-service#webstorm\n - https://code.visualstudio.com\n - https://en.wikipedia.org/wiki/Abstract_syntax_tree\n - https://en.wikipedia.org/wiki/Remote_procedure_call\n - https://github.com/angular/angular/blob/main/packages/language-service/src/types.ts\n - https://github.com/angular/vscode-ng-language-service/wiki/Design\n - https://github.com/iamcco/coc-angular/issues/70#issuecomment-1616340751\n - https://github.com/microsoft/vs-ng-language-service\n - https://github.com/neoclide/coc.nvim\n - https://marketplace.eclipse.org/content/wild-web-developer-html-css-javascript-typescript-nodejs-angular-json-yaml-kubernetes-xml\n - https://marketplace.visualstudio.com/items?itemName=Angular.ng-template\n - https://marketplace.visualstudio.com/items?itemName=TypeScriptTeam.AngularLanguageService\n - https://microsoft.github.io/language-server-protocol\n - https://plugins.jetbrains.com/plugin/6971-angular-and-angularjs\n - https://visualstudio.microsoft.com\n - https://www.eclipse.org/eclipseide\n - https://www.jetbrains.com/webstorm\n - https://www.ng-conf.org\n - https://www.sublimetext.com\n - https://www.youtube.com/watch?v=ez3R0Gi4z5A&t=368s\n-->"}