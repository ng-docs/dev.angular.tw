{"id":"guide/service-worker-getting-started","title":"Service Worker 快速上手","contents":"<div class=\"content\">\n  <h1 id=\"getting-started-with-service-workers\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4yha3afq07kgs584opdzpq1lo\">Service Worker 快速上手<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#getting-started-with-service-workers\"><i class=\"material-icons\">link</i></a></h1>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6a6adzx146man204bq4t0wu68\">本文件解釋瞭如何在 <a href=\"cli\">Angular CLI</a> 專案中啟用對 Angular Service Worker 的支援。稍後它會用一個簡單的範例來向你展示 Service Worker 實踐，包括載入和基礎的快取功能。</p>\n<h2 id=\"prerequisites\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e44b21uig1fakj5vcfuvz1bdu\">前提條件<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#prerequisites\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"egdp8o5zi4j5h8dj6e31uly5d\">對 <a href=\"guide/service-worker-intro\">Angular Service Worker 簡介</a>中的訊息有了基本的瞭解。</p>\n<p><a id=\"cli-command\"></a></p>\n<h2 id=\"adding-a-service-worker-to-your-project\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2xsgefbns41m019zxkmklyo1p\">為你的專案新增 Service Worker<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#adding-a-service-worker-to-your-project\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cni5ja2rybijmzrobb4v1xh4q\">要在你的專案中設定 Angular 服務工作執行緒，執行以下 CLI 指令。</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng add @angular/pwa\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7vob609vjawvhuoifc04hc6tn\">CLI 設定你的應用程式以使用以下操作的服務工作執行緒：</p>\n<ol>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c6oai5akhc95o4e3wm7e3qq1c\">把 <code>@angular/service-worker</code> 新增到你的專案中。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3enldwhkega3uk8li4ga7655t\">在 CLI 中啟用 Service Worker 的建立支援。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4w1yfasp4m7bi03lwfgajk0r4\">匯入並註冊服務工作執行緒到應用程式的根提供者。</li>\n<li>Updates the <code>index.html</code> file:\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e9qioqzejauu7lvofggx1keki\">包含要新增到 <code>manifest.webmanifest</code> 檔案中的連結。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5kdxiv79l61k75i0awcdke2kv\">為 <code>theme-color</code> 新增 meta 標籤。</li>\n</ul>\n</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9212p1ih3xblpr9sjzsd7ogz\">建立圖示檔案，以支援安裝漸進式應用（PWA）。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"417f6dzhh47wj80yelgn8lcci\">建立名為 \n<a href=\"guide/service-worker-config\"><code>ngsw-config.json</code></a> 的服務工作執行緒設定檔案，指定快取行為和其他設定。</li>\n</ol>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dqesf5rpl99huotcqg2fd4nw6\">現在，建立本專案：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng build\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"eakp2vhma7v9tao4aitfq5auj\">現在，這個 CLI 專案就可以使用 Angular Service Worker 了。</p>\n<h2 id=\"service-worker-in-action-a-tour\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"aapfkbx4b29k01a2h7xs8p41g\">Service Worker 實戰：嚮導<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#service-worker-in-action-a-tour\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2sbdfsejl8k2125iifqaxu6h8\">本節用一個範例應用來示範一下 Service Worker 實戰。</p>\n<div class=\"alert is-helpful\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8iavrb74znq8a23f3frbv0pty\">要參與其中， \n<live-example downloadonly=\"\">\n 下載範例程式碼\n</live-example>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7fdbeojqxksr7asat2ue424lr\">解壓下載檔案，切換到該目錄，並在終端視窗中輸入以下指令。</p>\n<code-example format=\"shell\" language=\"shell\">\n\nnpm install           # install node packages\nng add @angular/pwa   # setup to use service worker\nng build              # build the app for production; code is in the /dist folder\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"j5jyop0kxtmgh1pdzwz919vr\">在本地開發期間啟用服務工作執行緒支援，使用以下指令使用生產設定。</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng serve --prod\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1nssaperbdwj0udwpv4r0yqs0\">或者，你可以使用來自 \n<a href=\"https://www.npmjs.com/package/http-server\"><code>http-server package</code></a> 的 npm，支援服務工作執行緒應用程式。不安裝直接執行：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nnpx http-server -p 8080 -c-1 dist/&lt;project-name&gt;/browser\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b5s2wmev7tamso15mxqhn1r5\">這將以 http://localhost:8080 為地址為你的應用程式提供服務工作執行緒支援。</p>\n</div>\n<h3 id=\"initial-load\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9fe5bvw4ksvggq8yyjr9cemea\">最初的載入<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#initial-load\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c83imrpsdedq74sdl80cjn68l\">在連接埠 \n<code>8080</code> 上執行伺服器，將瀏覽器指向 \n<code>http://localhost:8080</code>。 你的應用程式應該正常載入。</p>\n<div class=\"alert is-helpful\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dkb9bum4050ljiu796b1y87ml\"><strong>提示</strong>：<br>\n當測試 Angular Service Worker 時，最好使用瀏覽器中的隱身或隱私視窗，以確保 Service Worker 不會從以前的殘留狀態中讀取資料，否則可能導致意外的行為。</p>\n</div>\n<div class=\"alert is-helpful\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"kvumc5v4tgbs928ssc708vu\"><strong>注意</strong>：<br>\n如果沒有使用 HTTPS，那麼 Service Worker 只會在 <code>localhost</code> 上的應用中進行註冊。</p>\n</div>\n<h3 id=\"simulating-a-network-issue\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dfbik6sxxjrssehkisgdje4b2\">模擬網路出問題<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#simulating-a-network-issue\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cas3n3t0qkdq9lo0t42ug091k\">如果想模擬網路問題，以便在你的應用中停用網路互動。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cfh0b9glok9z92qjdgybth2fo\">在 Chrome 中：</p>\n<ol>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e6cpmbxuznvbzvh4rmlz3lz18\">選擇 <strong>Tools</strong> &gt; <strong>Developer Tools</strong>（從右上角的 Chrome 選單）。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7egcsyqxgmk8ahjqbdt1ks9kz\">進入 <strong>Network 頁</strong>。</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5a9499yidv2ti3yiohleq20go\">在 <strong>Throttling</strong> 下拉選單中選擇 <strong>Offline</strong> 複選框。</li>\n</ol>\n<div class=\"lightbox\">\n<img alt=\"The offline option in the Network tab is selected\" src=\"generated/images/guide/service-worker/offline-option.png\" width=\"910\" height=\"261\">\n</div>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dmo4hyyzimw09cwo2rslm8pvy\">現在，本應用不能再和網路進行互動了。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3r6porlb9r7ocmc0xjjhqefye\">對於那些不使用 Angular Service Worker 的應用，現在重新整理將會顯示 Chrome 的『網路中斷』頁，提示『沒有可用的網路連線』。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bywpiyn6tkeu4ztuizjlft102\">有了 Angular Service Worker，本應用的行為就不一樣了。重新整理時，頁面會正常載入。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"64b5tdkg11lkaa4nyqwl4caeb\">看看 Network 頁，來驗證此 Service Worker 是啟用的。</p>\n<div class=\"lightbox\">\n<img alt=\"Requests are marked as from ServiceWorker\" src=\"generated/images/guide/service-worker/sw-active.png\" width=\"1576\" height=\"170\">\n</div>\n<div class=\"alert is-helpful\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5hdb3wbo3oey0hj3w2ni69cgu\"><strong>注意</strong>：<br>\n在 『Size』 列中，請求的狀態是 <code>(ServiceWorker)</code>。\n這表示該資源不是從網路上載入的，而是從 Service Worker 的快取中。</p>\n</div>\n<h3 id=\"whats-being-cached\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"cv1x6fcf23pfneu3unifia472\">什麼被快取了？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#whats-being-cached\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ev2cd4jpix2527gm1peze0e90\">注意，瀏覽器要渲染的所有這些檔案都被快取了。<code>ngsw-config.json</code> 範本檔案被設定成了要快取 CLI 用到的那些檔案：</p>\n<ul>\n<li><code>index.html</code></li>\n<li><code>favicon.ico</code></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7yakfueai4l668pdizgb0p7q1\">建立結果（JS 和 CSS 套件）</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"38gre1eia5fsj9dmgoqn81q9a\"><code>assets</code> 下的一切</li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7x0yt8ouv743bvfpmbt2bm4c3\">圖片和字型直接位於所設定的 <code>outputPath</code>(認為 <code>./dist/&lt;project-name&gt;/</code>）或 <code>resourcesOutputPath</code> 下。關於這些設定的更多訊息，請參閱 <a href=\"cli/build\"><code>ng build</code></a>。</li>\n</ul>\n<div class=\"alert is-important\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2jdpazrz9qqfk3jcv2la9ha1r\">注意如下兩個關鍵點：</p>\n<ol>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3huzgu6n9m19z1f5dkyqupf25\">所生成的 <code>ngsw-config.json</code> 包括一個可快取字型和影象的有限清單。在某些情況下，你可能要按需修改這些 glob 模式。</p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b5n00dr4htv9giolkcdzie2lo\">如果在生成了設定檔案之後修改了 <code>resourcesOutputPath</code> 或 <code>assets</code> 的路徑，那麼就要在 <code>ngsw-config.json</code> 中手動修改這些路徑。</p>\n</li>\n</ol>\n</div>\n<h3 id=\"making-changes-to-your-application\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"17kj9bztiae63lut6gogrp2bt\">修改你的應用<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#making-changes-to-your-application\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8dq8mlj78d0u7ta4ic14oqqry\">現在，你已經看到了 Service Worker 如何快取你的應用，接下來的步驟講它如何進行更新。</p>\n<ol>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"aodegeg08gdqy1osnwduco3zq\">如果你正在隱身視窗中測試，請開啟第二個空白頁。這會讓該隱身視窗和緩存的狀態在測試期間持續活著。</p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2ant1xud24wbru4b2w836mywn\">關閉該應用的頁面，而不是整個視窗。這也會同時關閉開發者工具。</p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1jlo12rr4opjk0oxr92etnkp\">關閉 \n<code>http-server</code>（Ctrl-c）。</p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7hr5lbwyrv9f8ov5d2i9yii6x\">開啟 <code>src/app/app.component.html</code> 以供編輯。</p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"jyvu169iq829jd2w3lh9k16d\">把文字 <code>Welcome to {{title}}!</code> 改為 <code>Bienvenue à {{title}}!</code>。</p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7qo6pjm5mg8j3aw0qd12dg37i\">再次建立並執行此伺服器：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng build\nnpx http-server -p 8080 -c-1 dist/&lt;project-name&gt;/browser\n\n</code-example>\n</li>\n</ol>\n<h3 id=\"updating-your-application-in-the-browser\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"d3qeh57xh83q2m0u5islqenpc\">在瀏覽器中更新你的應用<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#updating-your-application-in-the-browser\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"eigww7tkojjjaca1f7ivjixlp\">現在，看看瀏覽器和 Service Worker 如何處理這個更新後的應用。</p>\n<ol>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"eh71inqc5tma5zc4lhzeb5sbv\">在同一視窗中再次開啟 \n<a href=\"http://localhost:8080\">http://localhost:8080</a>。 會發生什麼？</p>\n<div class=\"lightbox\">\n<img alt=\"It still says Welcome to Service Workers!\" src=\"generated/images/guide/service-worker/welcome-msg-en.png\" width=\"411\" height=\"248\">\n</div>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4c9fj8deo67nyhc4d4cywqlp\">出了什麼問題？ \n<em>實際上，沒有！</em></p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"4lxr7w4h1n96ffeaaukwjhm2t\">Angular 服務工作執行緒正在執行其工作，並提供其已經 \n<strong>安裝</strong> 的應用程式版本，即使有更新可用。 為了速度起見，服務工作執行緒在提供其已快取的應用程式之前不會等待檢查更新。</p>\n<br>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"20yofaklk1gatvld77ypwtl1j\">檢視 \n<code>http-server</code> 日誌，看到服務工作執行緒請求 \n<code>/ngsw.json</code>。</p>\n<code-example format=\"shell\" language=\"shell\">\n\n[2023-09-07T00:37:24.372Z]  \"GET /ngsw.json?ngsw-cache-bust=0.9365263935102124\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36\"\n\n</code-example>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"i3tkpt9ep73nmoomaikrc0kf\">這是服務工作執行緒檢查更新的方式。</p>\n</li>\n<li>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9mmvm1labqvmf7epmverv6qt\">重新整理頁面。</p>\n<div class=\"lightbox\">\n<img alt=\"The text has changed to say Bienvenue à app!\" src=\"generated/images/guide/service-worker/welcome-msg-fr.png\" width=\"393\" height=\"240\">\n</div>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"72zdicn5iev2qfe50ga7megoo\">Service Worker <em>在後台</em>安裝好了這個更新後的版本，下次載入或重新整理頁面時，Service Worker 就切換到最新的版本了。</p>\n</li>\n</ol>\n<h2 id=\"more-on-angular-service-workers\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e9jl51v338pdg88lkv1cl8f1i\">關於 Angular Service Worker 的更多訊息<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#more-on-angular-service-workers\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1oolgylns9kaynftarwog49tq\">你可能還對下列內容感興趣：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9cfxkkw7yam6tkmu721tmsmxm\"><a href=\"guide/service-worker-communications\">與 Service Worker 通訊</a></li>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"euc8u4m04wpqm4u3h2eqnb0fp\"><a href=\"guide/app-shell\">應用外殼</a></li>\n</ul>\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最後複查時間：Wed Sep 06 2023</div>\n</div>\n\n\n<!-- links to this doc:\n - guide/service-worker-communications\n - guide/service-worker-intro\n - guide/service-worker-notifications\n-->\n<!-- links from this doc:\n - cli\n - cli/build\n - guide/app-shell\n - guide/service-worker-communications\n - guide/service-worker-config\n - guide/service-worker-getting-started#adding-a-service-worker-to-your-project\n - guide/service-worker-getting-started#getting-started-with-service-workers\n - guide/service-worker-getting-started#initial-load\n - guide/service-worker-getting-started#making-changes-to-your-application\n - guide/service-worker-getting-started#more-on-angular-service-workers\n - guide/service-worker-getting-started#prerequisites\n - guide/service-worker-getting-started#service-worker-in-action-a-tour\n - guide/service-worker-getting-started#simulating-a-network-issue\n - guide/service-worker-getting-started#updating-your-application-in-the-browser\n - guide/service-worker-getting-started#whats-being-cached\n - guide/service-worker-intro\n - http://localhost:8080\n - https://www.npmjs.com/package/http-server\n-->"}