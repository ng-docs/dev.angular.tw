{"id":"guide/service-worker-notifications","title":"Service Worker 通知","contents":"<div class=\"content\">\n  <h1 id=\"service-worker-notifications\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2u8ej2b5odfmacywnmaieurx\">Service Worker 通知<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-notifications#service-worker-notifications\"><i class=\"material-icons\">link</i></a></h1>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8n3fgpbcuttxdfewfe6hzext7\">推送通知是吸引用户的一种引人注目的方式。通过 Service Worker 的强大功能，即使你的应用程序不在焦点上，也可以将通知发送到设备。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1dgan5411psr5pmwmukuffg4y\">Angular Service Worker 支持显示推送通知和处理通知点击事件。</p>\n<div class=\"alert is-helpful\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c74werdf0qug6mieuezk1n5nn\">使用 Angular Service Worker 时，推送通知交互是使用 <code><a href=\"api/service-worker/SwPush\" class=\"code-anchor\">SwPush</a></code> 服务处理的。要了解有关所涉及的浏览器 API 的更多信息，请参阅<a href=\"https://developer.mozilla.org/docs/Web/API/Push_API\">推送 API</a>和<a href=\"https://developer.mozilla.org/docs/Web/API/Notifications_API/Using_the_Notifications_API\">使用通知 API</a>。</p>\n</div>\n<h2 id=\"prerequisites\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e44b21uig1fakj5vcfuvz1bdu\">前提条件<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-notifications#prerequisites\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"a28dtgqoqhydp7mi3pnogtmbh\">我们建议你对以下内容有基本的了解：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c2rijcglaqp3k5gzb2q1thcdr\"><a href=\"guide/service-worker-getting-started\">Service Worker 快速上手</a>。</li>\n</ul>\n<h2 id=\"notification-payload\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2ybf21q7lftkui34yvk01dvmd\">通知负载<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-notifications#notification-payload\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6lv67ggornxp7ehn6et9zuomw\">通过推送具有有效负载的消息来调用推送通知。请参阅 <code><a href=\"api/service-worker/SwPush\" class=\"code-anchor\">SwPush</a></code> 以获得指导。</p>\n<div class=\"alert is-helpful\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5pc5ipqpf4bi4dq6f7sv1tep7\">在 Chrome 中，你可以在没有后端的情况下测试推送通知。打开 Devtools -&gt; Application -&gt; Service Workers 并使用 <code>Push</code> 输入发送 JSON 通知负载。</p>\n</div>\n<h2 id=\"notification-click-handling\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ct5cw2oc54wz7da93hr8jbqq0\">通知点击处理<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-notifications#notification-click-handling\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7jf3g8nu70r2m6niec0l9p2mo\"><code>notificationclick</code> 点击事件的默认行为是关闭通知并通知 <code><a href=\"api/service-worker/SwPush#notificationClicks\" class=\"code-anchor\">SwPush.notificationClicks</a></code>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"9kqbmnkfdelq5cgmc8fwx2k2y\">你可以通过向 <code>data</code> 对象添加 <code>onActionClick</code> 属性并提供 <code>default</code> 条目来指定要在 <code>notificationclick</code> 上执行的附加操作。当单击通知时没有打开的客户端时，这尤其有用。</p>\n<code-example format=\"json\" language=\"json\">\n\n{\n  \"notification\": {\n    \"title\": \"New Notification!\",\n    \"data\": {\n      \"onActionClick\": {\n        \"default\": {\"operation\": \"openWindow\", \"url\": \"foo\"}\n      }\n    }\n  }\n}\n\n</code-example>\n<h3 id=\"operations\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"43ysvljbqsi9gnznk2qix8ai5\">操作<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-notifications#operations\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"62u3uylahxsgru8u22cbazp7c\">Angular Service Worker 支持以下操作：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"43ysvljbqsi9gnznk2qix8ai5\">操作</th>\n<th align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3prlgfrx5eo2xqncnnob4crxu\">详情</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\"><code>openWindow</code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"b78fdzbklfm5ferz4g7r6yzs2\">在指定的 URL 处打开一个新标签页。</td>\n</tr>\n<tr>\n<td align=\"left\"><code>focusLastFocusedOrOpen</code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2ghj48k4ycr4nifndk85wwk37\">将焦点放在最后一个已聚焦的客户端上。如果没有已打开的客户端，则在指定的 URL 处打开一个新标签页。</td>\n</tr>\n<tr>\n<td align=\"left\"><code>navigateLastFocusedOrOpen</code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8xf1ic7be4jf4yf75n2iwzcr2\">将焦点放在最后一个已聚焦的客户端上，并将其导航到指定的 URL。如果没有已打开的客户端，则在指定的 URL 处打开一个新标签页。</td>\n</tr>\n<tr>\n<td align=\"left\"><code>sendRequest</code></td>\n<td align=\"left\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"8boncr73a5g4zc4z0r96emd3p\">向指定的 URL 发送简单的 GET 请求。</td>\n</tr>\n</tbody>\n</table>\n<div class=\"alert is-important\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"ag4ix4ty84szogvj2pulgom5h\">这些 URL 会被解析为相对于此 Service Worker 的注册范围的。<br>\n如果 <code>onActionClick</code> 项未定义 <code>url</code>，则使用 Service Worker 的注册范围。</p>\n</div>\n<h3 id=\"actions\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"en94m4p3a09fuw01gjhg0giy\">行动<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-notifications#actions\"><i class=\"material-icons\">link</i></a></h3>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5qzssaubky5od20arsr6wofnq\">操作提供了一种自定义用户如何与通知交互的方法。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"6n1810kuarf3yqdta7ld6rtg2\">使用 <code>actions</code> 属性，你可以定义一组可用的操作。每个动作都表示为一个动作按钮，用户可以单击该按钮与通知进行交互。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"a2v87a61xvgmz3k4mglarg6az\">此外，使用 <code>data</code> 对象上的 <code>onActionClick</code> 属性，你可以将每个操作与单击相应操作按钮时要执行的操作联系起来：</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n{\n  \"notification\": {\n    \"title\": \"New Notification!\",\n    \"actions\": [\n      {\"action\": \"foo\", \"title\": \"Open new tab\"},\n      {\"action\": \"bar\", \"title\": \"Focus last\"},\n      {\"action\": \"baz\", \"title\": \"Navigate last\"},\n      {\"action\": \"qux\", \"title\": \"Send request in the background\"},\n      {\"action\": \"other\", \"title\": \"Just notify existing clients\"}\n    ],\n    \"data\": {\n      \"onActionClick\": {\n        \"default\": {\"operation\": \"openWindow\"},\n        \"foo\": {\"operation\": \"openWindow\", \"url\": \"/absolute/path\"},\n        \"bar\": {\"operation\": \"focusLastFocusedOrOpen\", \"url\": \"relative/path\"},\n        \"baz\": {\"operation\": \"navigateLastFocusedOrOpen\", \"url\": \"https://other.domain.com/\"},\n        \"qux\": {\"operation\": \"sendRequest\", \"url\": \"https://yet.another.domain.com/\"}\n      }\n    }\n  }\n}\n\n</code-example>\n<div class=\"alert is-important\">\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c5ebdnivg56va6jm59p3r4a19\">如果操作没有相应的 <code>onActionClick</code> 条目，则通知将关闭并在现有客户端上通知 <code><a href=\"api/service-worker/SwPush#notificationClicks\" class=\"code-anchor\">SwPush.notificationClicks</a></code>。</p>\n</div>\n<h2 id=\"more-on-angular-service-workers\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"e9jl51v338pdg88lkv1cl8f1i\">关于 Angular Service Worker 的更多信息<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-notifications#more-on-angular-service-workers\"><i class=\"material-icons\">link</i></a></h2>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"1oolgylns9kaynftarwog49tq\">你可能还对下列内容感兴趣：</p>\n<ul>\n<li data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"c8h34vd4o8r9mh6u20crmuohp\"><a href=\"guide/service-worker-devops\">生产环境下的 Service Worker</a>。</li>\n</ul>\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最后复查时间：Mon Feb 28 2022</div>\n</div>\n\n\n<!-- links to this doc:\n - api/service-worker/SwPush\n - guide/service-worker-communications\n - guide/service-worker-intro\n-->\n<!-- links from this doc:\n - api/service-worker/SwPush\n - api/service-worker/SwPush#notificationClicks\n - guide/service-worker-devops\n - guide/service-worker-getting-started\n - guide/service-worker-notifications#actions\n - guide/service-worker-notifications#more-on-angular-service-workers\n - guide/service-worker-notifications#notification-click-handling\n - guide/service-worker-notifications#notification-payload\n - guide/service-worker-notifications#operations\n - guide/service-worker-notifications#prerequisites\n - guide/service-worker-notifications#service-worker-notifications\n - https://developer.mozilla.org/docs/Web/API/Notifications_API/Using_the_Notifications_API\n - https://developer.mozilla.org/docs/Web/API/Push_API\n-->"}