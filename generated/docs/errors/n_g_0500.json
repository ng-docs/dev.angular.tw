{"id":"errors/NG0500","title":"NG0500: 在水合过程中，Angular 期望找到一个DOM节点，但实际DOM可能不同或未找到。","contents":"<div class=\"content\">\n\n  <h1 id=\"ng0500-during-hydration-angular-expected-a-dom-node-but-either-the-actual-dom-was-different-or-was-not-found\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dewsab8hhnaoqriphsotq2x7g\">NG0500: 在水合过程中，Angular 期望找到一个DOM节点，但实际DOM可能不同或未找到。<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"errors/NG0500#ng0500-during-hydration-angular-expected-a-dom-node-but-either-the-actual-dom-was-different-or-was-not-found\"><i class=\"material-icons\">link</i></a></h1>\n\n  \n  \n\n  <div class=\"error-description\">\n    <h2 id=\"description\">说明<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"errors/NG0500#description\"><i class=\"material-icons\">link</i></a></h2>\n    <p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2mkfdihxleb1i7awp51nksai3\">这个错误意味着在水合过程中，Angular 期望 DOM 结构在服务端渲染期间渲染并加上注释节点。但是，在客户端，DOM 树与服务端渲染出的 DOM 树不同。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7xrqsbmioooxlwyn6mubhf843\">此错误通常是由于直接使用原生浏览器API进行DOM操作，改变了Angular生成的DOM结构之外的内容而导致的。如果使用\n<code>innerHTML</code>或\n<code>outerHTML</code>来设置HTML内容，同样会改变Angular生成的DOM结构之外的内容而引发此错误。您可以通过重构组件来使用原生Angular API而不是原生API来解决这个问题。如果不可能，您可以向组件的宿主节点添加\n<code>ngSkipHydration</code>属性，这将禁用该组件及其子组件的水合功能。\n<code>ngSkipHydration</code>应仅作为最后的手段使用，并应被视为需要修复的错误。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7y3d3wqt0871xkjy4t3o0x73k\">有关水合的更多信息，请参阅<a href=\"guide/hydration\">本指南</a>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3zqf3rzh5w6q74ys4m5q7k0xd\">以下示例将触发错误。</p>\n<code-example language=\"typescript\">\n@<a href=\"api/core/Component\" class=\"code-anchor\">Component</a>({\n  standalone: true,\n  selector: 'example-cmp',\n  template: '&lt;div&gt;&lt;span&gt;world&lt;/span&gt;&lt;/div&gt;',\n})\nexport class ExampleCmp {\n  hostElement = inject(<a href=\"api/core/ElementRef\" class=\"code-anchor\">ElementRef</a>).nativeElement;\n\n  ngOnInit() {\n    // Create a new &lt;p&gt; element with the `Hello` text inside\n    const newNode = document.createElement('p');\n    newNode.innerHTML = 'Hello';\n\n    // Insert the &lt;p&gt; before the first element. Since Angular has no information\n\t  // about the &lt;p&gt; element, it will be looking for the &lt;div&gt; element at the first\n\t  // element position instead. As a result, a hydration mismatch error would be\n\t  // thrown. Instead, update component's template to create the &lt;p&gt; element.\n\t  this.hostElement.insertBefore(newNode, this.hostElement.firstChild);\n\t}\n}\n</code-example>\n\n  </div>\n\n\n  \n  <br>\n\n  <div class=\"debugging\">\n    <h2 id=\"debugging-the-error\">如何排除本错误<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"errors/NG0500#debugging-the-error\"><i class=\"material-icons\">link</i></a></h2>\n    <p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5w04axivaw5recxwq81g1ajti\">开发人员控制台中的错误消息应包含有关导致问题的应用程序 DOM 结构的特定部分的信息。检查应用程序的那部分是否存在与水合相关的错误，例如使用原生 API 的直接 DOM 操作。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"a1cpmb9n032ai67sg8s0seyi2\">检查您的模板是否具有有效的HTML结构。在\n<a href=\"guide/hydration#valid-html-structure\">水合指南</a>中查看更多信息。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bn26rlofxteuk19mikbmqofl9\">可能的解决方案之一是，你可以将 <code>ngSkipHydration</code> 属性添加到你的组件宿主节点。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"47kxe1x3c666ru0l5jtzsp821\">如果你的应用程序在开发环境中运行，但你在生产构建中看到水合错误，请确保所生成的发给浏览器的 HTML 包含 Angular 在服务端渲染期间生成的注释节点。Angular 运行时使用这些注释节点作为视图容器的锚点（无论是否水合），而水合过程会期望它们出现在原始位置。如果你有某种自定义逻辑会从服务端渲染生成的 HTML 中删除注释节点，或者你已将 CDN 配置为在提供内容之前删除它们 - 禁用删除注释节点的特性并检查水合错误是否消失了。</p>\n\n  </div>\n  \n</div>\n\n<!-- links to this doc:\n - errors\n - errors/NG0501\n - errors/NG0502\n-->\n<!-- links from this doc:\n - api/core/Component\n - api/core/ElementRef\n - errors/NG0500#debugging-the-error\n - errors/NG0500#description\n - errors/NG0500#ng0500-during-hydration-angular-expected-a-dom-node-but-either-the-actual-dom-was-different-or-was-not-found\n - guide/hydration\n - guide/hydration#valid-html-structure\n-->"}