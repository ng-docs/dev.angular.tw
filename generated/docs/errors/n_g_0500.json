{"id":"errors/NG0500","title":"NG0500: 在水合過程中，Angular 期望找到一個DOM節點，但實際DOM可能不同或未找到。","contents":"<div class=\"content\">\n\n  <h1 id=\"ng0500-during-hydration-angular-expected-a-dom-node-but-either-the-actual-dom-was-different-or-was-not-found\" data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"dewsab8hhnaoqriphsotq2x7g\">NG0500: 在水合過程中，Angular 期望找到一個DOM節點，但實際DOM可能不同或未找到。<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"errors/NG0500#ng0500-during-hydration-angular-expected-a-dom-node-but-either-the-actual-dom-was-different-or-was-not-found\"><i class=\"material-icons\">link</i></a></h1>\n\n  \n  \n\n  <div class=\"error-description\">\n    <h2 id=\"description\">說明<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"errors/NG0500#description\"><i class=\"material-icons\">link</i></a></h2>\n    <p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"2mkfdihxleb1i7awp51nksai3\">這個錯誤意味著在水合過程中，Angular 期望 DOM 結構在服務端渲染期間渲染並加上註解節點。但是，在用戶端，DOM 樹與伺服器端渲染出的 DOM 樹不同。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7xrqsbmioooxlwyn6mubhf843\">此錯誤通常是由於直接使用原生瀏覽器API進行DOM操作，改變了Angular生成的DOM結構之外的內容而導致的。如果使用\n<code>innerHTML</code>或\n<code>outerHTML</code>來設定HTML內容，同樣會改變Angular生成的DOM結構之外的內容而引發此錯誤。您可以透過重構元件來使用原生Angular API而不是原生API來解決這個問題。如果不可能，您可以向元件的宿主節點新增\n<code>ngSkipHydration</code>屬性，這將停用該組件及其子元件的水合功能。\n<code>ngSkipHydration</code>應僅作為最後的手段使用，並應被視為需要修復的錯誤。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"7y3d3wqt0871xkjy4t3o0x73k\">有關水合的更多訊息，請參閱<a href=\"guide/hydration\">本指南</a>。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"3zqf3rzh5w6q74ys4m5q7k0xd\">以下範例將觸發錯誤。</p>\n<code-example language=\"typescript\">\n@<a href=\"api/core/Component\" class=\"code-anchor\">Component</a>({\n  standalone: true,\n  selector: 'example-cmp',\n  template: '&lt;div&gt;&lt;span&gt;world&lt;/span&gt;&lt;/div&gt;',\n})\nexport class ExampleCmp {\n  hostElement = inject(<a href=\"api/core/ElementRef\" class=\"code-anchor\">ElementRef</a>).nativeElement;\n\n  ngOnInit() {\n    // Create a new &lt;p&gt; element with the `Hello` text inside\n    const newNode = document.createElement('p');\n    newNode.innerHTML = 'Hello';\n\n    // Insert the &lt;p&gt; before the first element. Since Angular has no information\n\t  // about the &lt;p&gt; element, it will be looking for the &lt;div&gt; element at the first\n\t  // element position instead. As a result, a hydration mismatch error would be\n\t  // thrown. Instead, update component's template to create the &lt;p&gt; element.\n\t  this.hostElement.insertBefore(newNode, this.hostElement.firstChild);\n\t}\n}\n</code-example>\n\n  </div>\n\n\n  \n  <br>\n\n  <div class=\"debugging\">\n    <h2 id=\"debugging-the-error\">如何排除本錯誤<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"errors/NG0500#debugging-the-error\"><i class=\"material-icons\">link</i></a></h2>\n    <p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"5w04axivaw5recxwq81g1ajti\">開發人員控制台中的錯誤訊息應包含有關導致問題的應用程式 DOM 結構的特定部分的訊息。檢查應用程式的那部分是否存在與水合相關的錯誤，例如使用原生 API 的直接 DOM 操作。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"a1cpmb9n032ai67sg8s0seyi2\">檢查您的範本是否具有有效的HTML結構。在\n<a href=\"guide/hydration#valid-html-structure\">水合指南</a>中檢視更多訊息。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"bn26rlofxteuk19mikbmqofl9\">可能的解決方案之一是，你可以將 <code>ngSkipHydration</code> 屬性新增到你的元件宿主節點。</p>\n<p data-ng_translator_product=\"100\" data-ng_translator_ref_id=\"47kxe1x3c666ru0l5jtzsp821\">如果你的應用程式在開發環境中執行，但你在生產建立中看到水合錯誤，請確保所生成的發給瀏覽器的 HTML 包含 Angular 在服務端渲染期間生成的註解節點。Angular 執行時使用這些註解節點作為檢視容器的錨點（無論是否水合），而水合過程會期望它們出現在原始位置。如果你有某種自定義邏輯會從伺服器端渲染生成的 HTML 中刪除註解節點，或者你已將 CDN 設定為在提供內容之前刪除它們 - 停用刪除註解節點的屬性並檢查水合錯誤是否消失了。</p>\n\n  </div>\n  \n</div>\n\n<!-- links to this doc:\n - errors\n - errors/NG0501\n - errors/NG0502\n-->\n<!-- links from this doc:\n - api/core/Component\n - api/core/ElementRef\n - errors/NG0500#debugging-the-error\n - errors/NG0500#description\n - errors/NG0500#ng0500-during-hydration-angular-expected-a-dom-node-but-either-the-actual-dom-was-different-or-was-not-found\n - guide/hydration\n - guide/hydration#valid-html-structure\n-->"}