<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="nkpqtogejc5zcsz627ntfkf6">使用已发布到 npm 的 Angular 库</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/tools/libraries/using-libraries.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p data-ng_translator_product="100" data-ng_translator_ref_id="1laah1ozftdfmt9lc6dnl875h">当你构建 Angular 应用时，利用复杂的一方库以及丰富的第三方库生态系统。 
<a href="https://material.angular.io" title="Angular" material | angular target="_blank">Angular Material</a> 是一个复杂的一方库的示例。</p>

  <h2 id="install-libraries">
    <a href="#install-libraries" class="docs-anchor" tabindex="-1" aria-label="Link to Install libraries" data-ng_translator_product="100" data-ng_translator_ref_id="a2y7y1ekombc1odkb5mjsoa69">安装库</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="vif2jo3vzne31fge2pzhr5x9">库作为 
<a href="reference/configs/npm-packages" title="Workspace" npm dependencies | angular>npm 包</a> 发布，通常与将它们与 Angular CLI 集成的原理图一起发布。 要将可复用库代码集成到应用中，你需要安装包并在使用该功能的位置导入提供的功能。 对于大多数已发布的 Angular 库，使用 
<code>ng add &lt;lib_name&gt;</code> Angular CLI 命令。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="4c4gf90ndj52ntsydd6sgrrwm"><code>ng add</code> Angular CLI 命令使用包管理器安装库包，并调用包中包含的原理图以在项目代码中进行其他脚手架搭建。 包管理器的示例包括 
<a href="https://www.npmjs.com" title="npm" target="_blank">npm</a> 或 
<a href="https://yarnpkg.com" title="Yarn" target="_blank">yarn</a>。 项目代码中的额外脚手架搭建包括导入语句、字体和主题。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="answ9m4vpg1439oqh61lw0mt7">已发布的库通常提供一个 
<code>README</code> 文件或其他文档，说明如何将该库添加到你的应用中。 例如，参见 
<a href="https://material.angular.io" title="Angular" material | angular target="_blank">Angular Material</a> 文档。</p>

  <h3 id="library-typings">
    <a href="#library-typings" class="docs-anchor" tabindex="-1" aria-label="Link to Library typings" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="hc5cxjek45eoeh3j41s9elzi">库类型声明</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="5tjtrqxh6vz0tegv546aykygi">通常，库包中会在 <code>.d.ts</code> 文件中包含类型信息。参阅 <code>node_modules/@angular/material</code> 中的例子。如果库包中没有包含类型信息并且你的 IDE 报错，你可能需要安装与该库关联的 <code>@types/&lt;lib_name&gt;</code> 包。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="av871qe4ocsz1lxjdz096crpn">比如，假设你有一个名为 <code>d3</code> 的库：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">npm install d3 --save</div><div class="hljs-ln-line">npm install @types/d3 --save-dev</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="d81vqht1p0nf5uwsvsq383a2t">已安装到工作区中的 <code>@types/</code> 包中所定义的类型，会自动添加到使用该库的项目的 TypeScript 配置文件中。TypeScript 默认就会在 <code>node_modules/@types</code> 文件夹中查找类型，所以你不必单独添加每一个类型包。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="2igzrb3e96bzk1zbk6alb5kx4">如果某个库没有 <code>@types/</code> 类型信息，你仍然可以手动为它添加一些类型信息。为此你要：</p>

    <ol class="docs-ordered-list">
      <li><p data-ng_translator_product="100" data-ng_translator_ref_id="ea8dwi8b2sj8kr0vrq18jjuqp">在你的 
<code>src/</code> 目录中创建一个 
<code>typings.d.ts</code> 文件。此文件会自动作为全局类型定义包含进来。</p>
</li>
<li><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1j4dyobcoe8w2zljw5olf0lt">在 <code>src/typings.d.ts</code> 中添加如下代码。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">'host'</span> {</div><div class="hljs-ln-line">   <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Host</span> {</div><div class="hljs-ln-line">     protocol?: <span class="hljs-built_in">string</span>;</div><div class="hljs-ln-line">     hostname?: <span class="hljs-built_in">string</span>;</div><div class="hljs-ln-line">     pathname?: <span class="hljs-built_in">string</span>;</div><div class="hljs-ln-line">   }</div><div class="hljs-ln-line">   <span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">url: <span class="hljs-built_in">string</span>, queryString?: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Host</span>;</div><div class="hljs-ln-line"> }</div></code>
    </pre>
  </div></li>
<li><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="eryyt4q902nv2hhq7c1qsrido">在使用该库的组件或文件中，添加如下代码。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> host <span class="hljs-keyword">from</span> <span class="hljs-string">'host'</span>;</div><div class="hljs-ln-line"> <span class="hljs-keyword">const</span> parsedUrl = host.<span class="hljs-title function_">parse</span>(<span class="hljs-string">'https://angular.io'</span>);</div><div class="hljs-ln-line"> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(parsedUrl.<span class="hljs-property">hostname</span>);</div></code>
    </pre>
  </div></li>

    </ol>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ddavx43u240zpa83fvqeopys4">按需定义更多类型。</p>

  <h2 id="updating-libraries">
    <a href="#updating-libraries" class="docs-anchor" tabindex="-1" aria-label="Link to Updating libraries" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4gvts5g9cd8u0pa8ikqpwup3h">更新这些库</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="9h26vkxd4jetp5ngksx7bsov2">库可以由发布者更新，同时也有一些需要保持最新的独立依赖项。要检查已安装库的更新，请使用 
<a href="cli/update" title="ng" update | cli |angular><code>ng update</code></a> Angular CLI 命令。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ab43ccbznw5ja4bw3c0vxce2s">使用 <code>ng update &lt;lib_name&gt;</code> 命令来单独更新某个库的版本。Angular CLI 会检查库中最新发布的版本，如果最新版本比你已安装的版本新，就会下载它并更新你的 <code>package.json</code> 以匹配最新版本。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="88ontj6lp1fk78vexofyucnim">当你将 Angular 更新到新版本时，需要确保你使用的任何库都是最新的。如果库之间有相互依赖关系，可能需要按特定顺序更新它们。参见 
<a href="https://angular.dev/update-guide" title="Angular" update guide | angular target="_blank">Angular 更新指南</a> 以获取帮助。</p>

  <h2 id="adding-a-library-to-the-runtime-global-scope">
    <a href="#adding-a-library-to-the-runtime-global-scope" class="docs-anchor" tabindex="-1" aria-label="Link to Adding a library to the runtime global scope" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1vhy9xgeyzkf41zm8pskgo8f5">把某个库添加到运行时的全局范围中</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="bqt38cylyz3ohosbr7uhvtaz8">如果未将某个遗留 JavaScript 库导入应用，可以将其添加到运行时全局范围，并像在 script 标签中添加它一样加载。使用 
<a href="reference/configs/workspace-config" title="Angular" workspace configuration | angular><code>angular.json</code></a> 工作区构建配置文件中构建目标的 
<code>scripts</code> 和 
<code>styles</code> 选项来配置 Angular CLI 以在构建时执行此操作。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="2d24c5mourjq3hfnyo33hyoat">例如，要使用 
<a href="https://getbootstrap.com/docs/4.0/getting-started/introduction" title="Introduction" | bootstrap target="_blank">Bootstrap 4</a> 库</p>

    <ol class="docs-ordered-list">
      <li><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ma8518f6335pexa7w7fpy02t">使用 npm 包管理器安装库和相关的依赖项：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">npm install jquery --save</div><div class="hljs-ln-line"> npm install popper.js --save</div><div class="hljs-ln-line"> npm install bootstrap --save</div></code>
    </pre>
  </div></li>
<li><p data-ng_translator_product="100" data-ng_translator_ref_id="4wpkyk6zerwlrvr5m3obhn64d">在 
<code>angular.json</code> 配置文件中，将相关的脚本文件添加到 
<code>scripts</code> 数组中：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></div><div class="hljs-ln-line">   <span class="hljs-string">"node_modules/jquery/dist/jquery.slim.js"</span><span class="hljs-punctuation">,</span></div><div class="hljs-ln-line">   <span class="hljs-string">"node_modules/popper.js/dist/umd/popper.js"</span><span class="hljs-punctuation">,</span></div><div class="hljs-ln-line">   <span class="hljs-string">"node_modules/bootstrap/dist/js/bootstrap.js"</span></div><div class="hljs-ln-line"> <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></div></code>
    </pre>
  </div></li>
<li><p data-ng_translator_product="100" data-ng_translator_ref_id="9ncsvfahnp2esr7df4i97w5bd">将 
<code>bootstrap.css</code> CSS 文件添加到 
<code>styles</code> 数组中：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">"styles": [</div><div class="hljs-ln-line">   <span class="hljs-string">"node_modules/bootstrap/dist/css/bootstrap.css"</span>,</div><div class="hljs-ln-line">   <span class="hljs-string">"src/styles.css"</span></div><div class="hljs-ln-line"> ],</div></code>
    </pre>
  </div></li>
<li><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="c1nz6kabng0sy0gbtg2ak460c">运行或重启 <code>ng serve</code>，看看你的应用是否正在使用 Bootstrap 4。</p>
</li>

    </ol>
    
  <h3 id="using-runtime-global-libraries-inside-your-app">
    <a href="#using-runtime-global-libraries-inside-your-app" class="docs-anchor" tabindex="-1" aria-label="Link to Using runtime-global libraries inside your app" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4u9s1hhn6xrg24jzdv5ph0tlq">在你的应用中使用运行时全局库</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7uya8xo1ztfg7h0q5tbaylk07">通过 “scripts” 数组导入某个库之后，<strong>不要</strong>在 TypeScript 代码中再次使用 import 语句导入它。以下代码片段是一个示例导入语句。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> $ <span class="hljs-keyword">from</span> <span class="hljs-string">'jquery'</span>;</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7sf5dt2oe05rgtkssro09yw76">如果你使用 import 语句导入它，你将拥有该库的两个不同副本：一个作为全局库导入，另一个作为模块导入。这对于带有插件的库来说尤其糟糕，比如 JQuery，因为每个副本都包含不同的插件。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="58iazk23dm666237h0kif7d8s">相反，运行 <code>npm install @types/jquery</code> Angular CLI 命令为你的库下载类型信息，然后按照库的安装步骤进行操作。这样你就可以访问该库公开的全局变量了。</p>

  <h3 id="defining-typings-for-runtime-global-libraries">
    <a href="#defining-typings-for-runtime-global-libraries" class="docs-anchor" tabindex="-1" aria-label="Link to Defining typings for runtime-global libraries" data-ng_translator_product="100" data-ng_translator_ref_id="brxa0bsz2fzwich4sbh15v9k4">为运行时全局库定义类型信息</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="4jqnp212y7h924fslhxmoxcu2">如果你需要使用的全局库没有全局类型定义，可以在 
<code>src/typings.d.ts</code> 中手动将它们声明为 
<code>any</code>。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4reizjf10jcs1ftw359bt1ndz">比如：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">var</span> <span class="hljs-attr">libraryName</span>: <span class="hljs-built_in">any</span>;</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="91z3k5s315t6gh2ao2dxy8woc">有些脚本扩展了其它库，比如 JQuery 插件：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">$(<span class="hljs-string">'.test'</span>).<span class="hljs-title function_">myPlugin</span>();</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bv8shxw39zov5wvl13j92jvc">在这种情况下，所安装的 <code>@types/jquery</code> 就不包含 <code>myPlugin</code>，所以你需要在 <code>src/typings.d.ts</code> 中添加一个接口。比如：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">JQuery</span> {</div><div class="hljs-ln-line">  <span class="hljs-title function_">myPlugin</span>(options?: <span class="hljs-built_in">any</span>): <span class="hljs-built_in">any</span>;</div><div class="hljs-ln-line">}</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8men9jepmfk0cyyq41p0032nj">如果不为这个由脚本定义的扩展添加接口，IDE 就会显示错误：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">[TS][Error] Property 'myPlugin' does not exist on type 'JQuery'</div></code>
    </pre>
  </div>