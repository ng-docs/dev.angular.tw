<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1" data-ng_translator_product="100" data-ng_translator_ref_id="3btkttbvwr2a8ls0scu3tums3">使用原理图生成代码</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/tools/cli/schematics.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p data-ng_translator_product="100" data-ng_translator_ref_id="afnfb96o46u0uwmurbxctkln7">原理图是支持复杂逻辑的基于模板的代码生成器。它是一组用于通过生成或修改代码来转换软件项目的指令。原理图被打包到集合中，并通过 npm 安装。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7d4meubxk8be69hazn13d6ktl">原理图的集合可以作为一个强大的工具，以创建、修改和维护任何软件项目，特别是当要自定义 Angular 项目以满足你自己组织的特定需求时。比如，你可以借助原理图来用预定义的模板或布局生成常用的 UI 模式或特定的组件。也可以用原理图来强制执行架构规则和约定，让你的项目保持一致性和互操作性。</p>

  <h2 id="schematics-for-the-angular-cli">
    <a href="#schematics-for-the-angular-cli" class="docs-anchor" tabindex="-1" aria-label="Link to Schematics for the Angular CLI" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="zcrhn07afazk2x36uxusbbki">Angular CLI 中的原理图</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="arudltzmp06ct3sdt48djwhl2">原理图是 Angular 生态系统的一部分。Angular CLI 使用原理图将变换应用于 Web 应用项目。你可以修改这些原理图，并定义新的原理图，以执行诸如更新代码以修复依赖项中的破坏性更改，或向现有项目添加新的配置选项或框架等任务。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6mc7vc6b6mohghgcejob946gp"><code>@schematics/angular</code> 集合中的原理图是 <code>ng generate</code> 和 <code>ng add</code> 命令的默认原理图。此包里包含一些有名字的原理图，可用于配置 <code>ng generate</code> 子命令的选项，比如 <code>ng generate component</code> 和 <code>ng generate service</code>。<code>ng generate</code> 的子命令是相应原理图的简写。可以用长格式来指定并生成特定的原理图或原理图集合：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">ng generate my-schematic-collection:my-schematic-name</div></code>
    </pre>
  </div><p>or</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">ng generate my-schematic-name --collection collection-name</div></code>
    </pre>
  </div>
  <h3 id="configuring-cli-schematics">
    <a href="#configuring-cli-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Configuring CLI schematics" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="cr90wct719wr55gx7papbkan6">配置 CLI 的原理图</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="5m78275dt3ezco8e6b8p7w8ip">与原理图关联的 JSON 模式告诉 Angular CLI哪些选项可用于命令和子命令，并确定默认值。可以通过在命令行上提供不同的选项值来覆盖这些默认值。有关如何更改工作区的生成选项默认值的信息，请参见
<a href="reference/configs/workspace-config">工作区配置</a>。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="edavxdhe9vpnolqysd1go39cp">CLI 用于生成项目和项目部分的默认原理图的 JSON 模式收集在包 
<a href="https://github.com/angular/angular-cli/tree/main/packages/schematics/angular" target="_blank"><code>@schematics/angular</code></a> 中。 该模式描述了 CLI 对于每个 
<code>ng generate</code> 子命令的可用选项，如 
<code>--help</code> 输出所示。</p>

  <h2 id="developing-schematics-for-libraries">
    <a href="#developing-schematics-for-libraries" class="docs-anchor" tabindex="-1" aria-label="Link to Developing schematics for libraries" data-ng_translator_product="100" data-ng_translator_ref_id="23ra3v25urenaxo0uzflioaqs">为库开发原理图</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="287bu4ahbrolhqsla9jvukilf">作为一名库开发人员，你可以创建自己的自定义原理图集合，以便把你的库与 Angular CLI 集成在一起。</p>

  <ul class="docs-list">
    <li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3jpcpfafanoi2t7fuv2le0s9r"><em>添加（Add）原理图</em>允许开发人员使用 <code>ng add</code> 在 Angular 工作区中安装你的库</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8ugrqq3d0chql9j6gxbzu7jce"><em>生成（Generation）原理图</em>可以告诉 <code>ng generate</code> 子命令如何修改项目、添加配置和脚本，以及为库中定义的工件提供脚手架</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8sxgdepymoiiwds2o0hn4g90o"><em>更新（Update）原理图</em>可以告诉 <code>ng update</code> 命令，如何更新库的依赖，并在发布新版本时调整其中的重大变更</li>

  </ul>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="9heoq0m2ys41owkurg88ymcqm">要了解它们的更多细节以及如何创建它们，请参阅：</p>

    <nav class="docs-pill-row">
      
    <a class="docs-pill" href="tools/cli/schematics-authoring" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bw9g27lsip5c4pum2ioiigrqf">创作原理图</a>
    
    <a class="docs-pill" href="tools/cli/schematics-for-libraries" data-ng_translator_product="100" data-ng_translator_ref_id="8618wj3phhjus606ji0k4migh">库的原理图</a>
    

    </nav>
    
  <h3 id="add-schematics">
    <a href="#add-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Add schematics" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1uliry5rqpukkxboad4h56lcs">添加原理图</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="8oc1ol1nmy3up80chur6ny1bv"><em>添加原理图</em>通常随库一起提供，这样可以使用 
<code>ng add</code> 将该库添加到现有项目中。
<code>add</code> 命令使用你的包管理器下载新的依赖，并调用一个实现为原理图的安装脚本。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="avxp2g0d7x47gfi2gvx1m7l2l">例如，
<a href="https://material.angular.io/guide/schematics" target="_blank"><code>@angular/material</code></a> 原理图告诉 
<code>add</code> 命令安装和设置 Angular Material 和主题，并注册可以使用 
<code>ng generate</code> 创建的新入门组件。 将其视为你自己添加原理图的示例和模型。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="2ezvdlullmj8874zhhnmdeesi">合作伙伴和第三方库还支持 Angular CLI 的添加原理图。 例如，
<code>@ng-bootstrap/schematics</code> 添加 
<a href="https://ng-bootstrap.github.io" target="_blank">ng-bootstrap</a> 到应用中，
<code>@clr/angular</code> 安装和设置 
<a href="https://clarity.design/documentation/get-started" target="_blank">来自 VMWare 的 Clarity</a>。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="564sl7l3duwirfq7qmwyduk8i"><em>添加原理图</em>还可以通过配置更改更新项目，添加其他依赖（如腻子脚本），或生成包特定的初始化代码。例如，
<code>@angular/pwa</code> 原理图通过添加应用清单和 Service Worker 将你的应用转换为 PWA。</p>

  <h3 id="generation-schematics">
    <a href="#generation-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Generation schematics" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4f73cdsbwzai2nhyuoo5yooyj">生成（Generation）原理图</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="dc5hq5gz5t46hlhdohpbfiq5m">生成器原理图是 <code>ng generate</code> 的操作指令。那些已经有文档的子命令会使用默认的 Angular 生成器原理图，但你可以在子命令中指定另一个原理图来生成你的库中定义的那些工件。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8e6ycx51ektrtyce9l5jd1nu4">比如，Angular Material 为它定义的一些 UI 组件提供了生成器原理图。下面的命令会使用其中一个原理图来渲染一个 Angular Material 的 <code>&lt;mat-table&gt;</code> 组件，它预先配置了一个用于排序和分页的数据源。</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">ng generate @angular/material:table &lt;component-name&gt;</div></code>
    </pre>
  </div>
  <h3 id="update-schematics">
    <a href="#update-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Update schematics" data-ng_translator_product="100" data-ng_translator_ref_id="83cvt6l7rgrrsy0y3iaklz729">更新原理图</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="2cwl01y5nwh6xmsng99h2j7j7"><code>ng update</code> 命令可用于更新工作区的库依赖项。 如果不提供选项或使用帮助选项，则该命令会检查工作区并建议要更新的库。</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">ng update</div><div class="hljs-ln-line">We analyzed your package.json, there are some packages to update:</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    Name                                      Version                     Command to update</div><div class="hljs-ln-line">    ‐-------------------------------------------------------------------------------</div><div class="hljs-ln-line">    @angular/cdk                       7.2.2 -&gt; 7.3.1           ng update @angular/cdk</div><div class="hljs-ln-line">    @angular/cli                       7.2.3 -&gt; 7.3.0           ng update @angular/cli</div><div class="hljs-ln-line">    @angular/core                      7.2.2 -&gt; 7.2.3           ng update @angular/core</div><div class="hljs-ln-line">    @angular/material                  7.2.2 -&gt; 7.3.1           ng update @angular/material</div><div class="hljs-ln-line">    rxjs                                      6.3.3 -&gt; 6.4.0           ng update rxjs</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    There might be additional packages that are outdated.</div><div class="hljs-ln-line">    Run "ng update --all" to try to update all at the same time.</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="22y5e73fmaqr4kz5wubqs5avv">如果你给这个命令指定一组要更新的库（或 <code>--all</code> 标志），它就会更新这些库、这些库的对等依赖，以及对等依赖的对等依赖。</p>

    <div class="docs-alert docs-alert-helpful">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="c6o2uzt2wybp2fqsmw6gr2nje"><strong>提示:</strong> 如果存在不一致性（例如，对等依赖项无法匹配简单的 
<a href="https://semver.io" target="_blank">semver</a> 范围），命令会生成错误并不会改变工作区中的任何内容。</p>

    </div>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3mai0s2p1lhlzwqzqi0s8ppdw">我们建议你不要强制更新所有的依赖项，而应该首先尝试更新特定的依赖项。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="3fwcdz6shl5yus4zzeorjzy0u">有关 
<code>ng update</code> 命令工作原理的更多信息，请参阅 
<a href="https://github.com/angular/angular-cli/blob/main/docs/specifications/update.md" target="_blank">更新命令</a>。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="aaspnnrl34g0xdfvvp13r72hj">如果你创建的新版本的库引入了潜在的重大更改，你可以提供一个<em>更新原理图</em>，让 <code>ng update</code> 命令能够自动解决所更新项目中的任何重大修改。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="buam1s1yof7toxwjc6mb60ovp">比如，假设你要更新 Angular Material 库。</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">ng update @angular/material</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="accossa2dmza8l29ksw4dp8ox">该命令会在你的工作区的 <code>package.json</code> 中更新 <code>@angular/material</code> 及其依赖项 <code>@angular/cdk</code>。如果任何一个包中包含了涵盖从现有版本到新版本的迁移规则的更新原理图，那么该命令就会在你的工作区中运行这个原理图。</p>
