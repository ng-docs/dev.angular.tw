<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1">使用原理圖生成程式碼</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/tools/cli/schematics.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p>原理圖是一個基於範本的程式碼產生器，支援複雜的邏輯。
它是一組用於透過生成或修改程式碼來轉換軟體專案的指令集。
原理圖被打包到集合中，並使用 npm 安裝。</p>
<p>原理圖集合可以成為建立、修改和維護任何軟體專案的強大工具，但對於自定義 Angular 專案以滿足你所在組織的特定需求尤其有用。
例如，你可以使用原理圖，使用預定義的範本或佈局來生成常用 UI 模式或特定元件。
使用原理圖來強化架構規則和約定，使你的專案保持一致性和互操作性。</p>

  <h2 id="schematics-for-the-angular-cli">
    <a href="#schematics-for-the-angular-cli" class="docs-anchor" tabindex="-1" aria-label="Link to Schematics for the Angular CLI">Angular CLI 的原理圖</a>
  </h2>
  <p>原理圖是 Angular 生態系統的一部分。
Angular CLI 使用原理圖將轉換應用於 Web 應用專案。
你可以修改這些原理圖，並定義新的原理圖來執行諸如更新程式碼以修復依賴項中的重大更改，或者向現有專案新增新的設定選項或框架等操作。</p>
<p>包含在 <code>@schematics/angular</code> 集合中的原理圖預設由指令 <code>ng generate</code> 和 <code>ng add</code> 執行。
該軟體套件包含命名的原理圖，這些原理圖設定了可用於 CLI 的 <code>ng generate</code> 子指令的選項，例如 <code>ng generate component</code> 和 <code>ng generate service</code>。<code>ng generate</code> 的子指令是相應原理圖的簡寫形式。
要使用長格式指定和生成特定的原理圖或原理圖集合，請使用：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> my-schematic-collection:my-schematic-name</span></span></code></pre>
    </pre>
  </div><p>or</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> my-schematic-name</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> --collection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> collection-name</span></span></code></pre>
    </pre>
  </div>
  <h3 id="configuring-cli-schematics">
    <a href="#configuring-cli-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Configuring CLI schematics">設定 CLI 原理圖</a>
  </h3>
  <p>與原理圖關聯的 JSON 模式會告知 Angular CLI 指令和子指令有哪些可用選項，並確定預設值。
可以透過在指令行上為選項提供不同的值來覆蓋這些預設值。
有關如何更改工作區的生成選項預設值的訊息，請參閱<a href="reference/configs/workspace-config">工作區設定</a>。</p>
<p>CLI 用於生成專案和專案部件的預設原理圖的 JSON 模式收集在 <a href="https://github.com/angular/angular-cli/tree/main/packages/schematics/angular" target="_blank"><code>@schematics/angular</code></a> 套件中。
該模式描述了 CLI 可用於每個 <code>ng generate</code> 子指令的選項，如 <code>--help</code> 輸出中所示。</p>

  <h2 id="developing-schematics-for-libraries">
    <a href="#developing-schematics-for-libraries" class="docs-anchor" tabindex="-1" aria-label="Link to Developing schematics for libraries">為函式庫開發原理圖</a>
  </h2>
  <p>作為函式庫開發人員，你可以建立自己的自定義原理圖集合，以將你的函式庫與 Angular CLI 整合。</p>

  <ul class="docs-list">
    <li><em>新增原理圖</em> 讓開發人員可以使用 <code>ng add</code> 在 Angular 工作區中安裝你的函式庫</li>
<li><em>Generation 原理圖</em> 可以告知 <code>ng generate</code> 子指令如何修改專案、新增設定和指令碼，以及搭建在你的函式庫中定義的工件</li>
<li><em>update 原理圖</em> 可以告知 <code>ng update</code> 指令如何在發布新版本時更新函式庫的依賴項並針對重大更改進行調整</li>

  </ul>
  <p>有關這些原理圖的外觀以及如何建立它們的更多詳細訊息，請參閱：</p>

    <nav class="docs-pill-row">
      
    <a class="docs-pill" href="tools/cli/schematics-authoring">
      編寫原理圖
    </a>
    
    <a class="docs-pill" href="tools/cli/schematics-for-libraries">
      函式庫的原理圖
    </a>
    

    </nav>
    
  <h3 id="add-schematics">
    <a href="#add-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Add schematics">Add 原理圖</a>
  </h3>
  <p><em>add 原理圖</em> 通常與函式庫一起提供，以便可以使用 <code>ng add</code> 將函式庫新增到現有專案中。
<code>add</code> 指令使用你的套件管理器下載新的依賴項，並呼叫作為原理圖實現的安裝指令碼。</p>
<p>例如，<a href="https://material.angular.io/guide/schematics" target="_blank"><code>@angular/material</code></a> 原理圖告知 <code>add</code> 指令安裝和建立 Angular Material 和主題，並註冊可以使用 <code>ng generate</code> 建立的新 starter 元件。
將此原理圖作為你自己的 add 原理圖的範例和模型。</p>
<p>合作伙伴和第三方函式庫也透過 add 原理圖支援 Angular CLI。
例如，<code>@ng-bootstrap/schematics</code> 將 <a href="https://ng-bootstrap.github.io" target="_blank">ng-bootstrap</a> 新增到應用，而 <code>@clr/angular</code> 安裝並建立 <a href="https://clarity.design/documentation/get-started" target="_blank">VMWare 的 Clarity</a>。</p>
<p><em>add 原理圖</em> 還可以使用設定更改來更新專案，新增額外的依賴項（例如膩子指令碼），或搭建特定於套件的初始化程式碼。
例如，<code>@angular/pwa</code> 原理圖透過新增應用清單和 Service Worker 將你的應用變成 PWA。</p>

  <h3 id="generation-schematics">
    <a href="#generation-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Generation schematics">Generation 原理圖</a>
  </h3>
  <p>Generation 原理圖是 <code>ng generate</code> 指令的指令。
已記錄的子指令使用預設的 Angular generation 原理圖，但你可以指定不同的原理圖（代替子指令）來生成在你的函式庫中定義的工件。</p>
<p>例如，Angular Material 為其定義的 UI 元件提供 generation 原理圖。
以下指令使用這些原理圖之一來渲染一個 Angular Material <code>&lt;mat-table&gt;</code>，該表已預先設定了用於排序和分頁的資料來源。</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> @angular/material:table</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">component-nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span></span></code></pre>
    </pre>
  </div>
  <h3 id="update-schematics">
    <a href="#update-schematics" class="docs-anchor" tabindex="-1" aria-label="Link to Update schematics">Update 原理圖</a>
  </h3>
  <p><code>ng update</code> 指令可用於更新工作區的函式庫依賴項。
 如果你不提供任何選項或使用 help 選項，該指令將檢查你的工作區並建議要更新的函式庫。</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">We</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> analyzed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> package.json,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> there</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> some</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> packages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update:</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    Name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                                      Version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">                     Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    ‐-------------------------------------------------------------------------------</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    @angular/cdk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                       7.2.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 7.3.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> @angular/cdk</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    @angular/cli</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                       7.2.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 7.3.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> @angular/cli</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    @angular/core</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                      7.2.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 7.2.3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> @angular/core</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    @angular/material</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                  7.2.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 7.3.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> @angular/material</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    rxjs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">                                      6.3.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 6.4.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">           ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> rxjs</span></span></code></pre>
    </pre>
  </div><p>如果將一組要更新的函式庫傳遞給指令，它將更新這些函式庫、它們的對等依賴項以及依賴於它們的對等依賴項。</p>

    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 如果存在不一致（例如，如果對等依賴項無法透過簡單的 <a href="https://semver.io" target="_blank">semver</a> 範圍對應），則該指令會生成錯誤，並且不會更改工作區中的任何內容。</p>

    </div>
    <p>我們建議你不要預設強制更新所有依賴項。
請先嚐試更新特定的依賴項。</p>
<p>有關 <code>ng update</code> 指令如何工作的更多訊息，請參閱<a href="https://github.com/angular/angular-cli/blob/main/docs/specifications/update.md" target="_blank">Update Command</a>。</p>
<p>如果你建立了函式庫的新版本，其中引入了潛在的重大更改，則可以提供 <em>update 原理圖</em>，以使 <code>ng update</code> 指令能夠自動求解正在更新的專案中的任何此類別更改。</p>
<p>例如，假設你要更新 Angular Material 函式庫。</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">ng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> @angular/material</span></span></code></pre>
    </pre>
  </div><p>此指令更新工作區的 <code>package.json</code> 中的 <code>@angular/material</code> 及其依賴項 <code>@angular/cdk</code>。
如果任一軟體套件包含涵蓋從現有版本遷移到新版本的 update 原理圖，則該指令會在你的工作區上執行該原理圖。</p>
