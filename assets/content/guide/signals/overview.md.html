<div class="docs-decorative-header-container">
      <div class="docs-decorative-header">
        <div class="docs-header-content">
          <docs-breadcrumb></docs-breadcrumb>

          
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1">Angular Signal</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/signals/overview.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>

          <p><!-- markdownlint-disable-line -->Angular Signal 是一種體系，它可以精細地跟蹤你的狀態在整個應用中的使用方式和位置，從而允許框架最佳化渲染更新。</p>
        </div>

        <!-- illustration -->
        <svg width="216" height="259" viewBox="0 0 216 259" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M145.45 156.483C152.516 149.306 156.413 139.81 156.413 129.711C156.413 119.611 152.528 110.128 145.45 102.939L158.571 89.8181C180.385 111.879 180.385 147.53 158.571 169.579L145.45 156.458V156.483Z" fill="#F11653" />
  <path d="M158.558 90.2744C168.941 100.88 174.639 114.864 174.639 129.723C174.639 144.583 168.929 158.567 158.558 169.172L145.881 156.495C152.873 149.281 156.721 139.798 156.721 129.735C156.721 119.673 152.873 110.19 145.881 102.976L158.558 90.2991M158.558 89.4236L145.006 102.976C159.791 117.762 159.791 141.722 145.006 156.507L158.558 170.06C180.829 147.789 180.829 111.694 158.558 89.4236Z" fill="black" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M71.7685 156.483C56.9829 141.697 56.9829 117.737 71.7685 102.951L58.2161 89.3989C35.9452 111.67 35.9452 147.764 58.2161 170.035L71.7685 156.483Z" fill="#8514F5" stroke="black" stroke-width="0.93421" stroke-miterlimit="10" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M174.195 185.228C204.629 154.547 204.629 104.875 174.195 74.2064L187.303 61.0856C205.554 79.4473 215.604 103.815 215.604 129.711C215.604 155.607 205.554 179.974 187.303 198.336L174.195 185.215V185.228Z" fill="#F11653" />
  <path d="M187.303 61.5295C224.569 99.2641 224.569 160.182 187.303 197.917L174.626 185.24C189.301 170.343 197.366 150.662 197.366 129.723C197.366 108.784 189.301 89.1029 174.626 74.2063L187.303 61.5295ZM187.303 60.6539L173.751 74.2063C204.407 104.863 204.407 154.571 173.751 185.228L187.303 198.78C225.445 160.638 225.445 98.7955 187.303 60.6539Z" fill="black" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M43.0236 185.24C12.3673 154.584 12.3673 104.875 43.0236 74.2188L29.4712 60.6664C-8.6704 98.808 -8.6704 160.651 29.4712 198.792L43.0236 185.24Z" fill="#8514F5" stroke="black" stroke-width="0.93421" stroke-miterlimit="10" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M135.227 155.434C150.012 140.649 150.012 116.689 135.227 101.903L148.779 88.3507C171.05 110.622 171.05 146.716 148.779 168.987L135.227 155.434Z" fill="white" stroke="black" stroke-width="0.93421" stroke-miterlimit="10" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M81.7077 155.434C66.9221 140.649 66.9221 116.689 81.7077 101.903L68.1553 88.3507C45.8844 110.622 45.8844 146.716 68.1553 168.987L81.7077 155.434Z" fill="white" stroke="black" stroke-width="0.93421" stroke-miterlimit="10" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M163.972 184.179C194.628 153.523 194.628 103.815 163.972 73.1582L177.524 59.6058C215.666 97.7474 215.666 159.59 177.524 197.732L163.972 184.179Z" fill="white" stroke="black" stroke-width="0.93421" stroke-miterlimit="10" />
  <path fill-rule="evenodd" clip-rule="evenodd" d="M52.9628 184.179C22.3065 153.523 22.3065 103.815 52.9628 73.1582L39.4104 59.6058C1.2688 97.7474 1.2688 159.59 39.4104 197.732L52.9628 184.179Z" fill="white" stroke="black" stroke-width="0.93421" stroke-miterlimit="10" />
  <path d="M127.754 128.527C127.754 139.107 119.085 147.69 108.393 147.69C97.7018 147.69 89.0327 139.107 89.0327 128.527C89.0327 117.946 97.7018 109.364 108.393 109.364C119.085 109.364 127.754 117.946 127.754 128.527Z" fill="white" stroke="var(--primary-contrast)" stroke-width="0.93421" stroke-miterlimit="10" />
  <path d="M111.698 81.593V5.18655" stroke="var(--primary-contrast)" stroke-width="0.93421" stroke-miterlimit="10" />
  <path d="M114.769 6.08679L111.698 0.759552L108.628 6.08679H114.769Z" fill="var(--primary-contrast)" />
  <path d="M94.2489 82.2466L59.1779 47.188" stroke="var(--primary-contrast)" stroke-width="0.766053" stroke-miterlimit="10" />
  <path d="M61.4592 45.9424L56.6376 44.6476L57.9324 49.4693L61.4592 45.9424Z" fill="var(--primary-contrast)" />
  <path d="M129.147 82.2466L164.218 47.188" stroke="var(--primary-contrast)" stroke-width="0.766053" stroke-miterlimit="10" />
  <path d="M165.464 49.4693L166.759 44.6476L161.937 45.9424L165.464 49.4693Z" fill="var(--primary-contrast)" />
  <path d="M111.698 177.853V254.26" stroke="var(--primary-contrast)" stroke-width="0.93421" stroke-miterlimit="10" />
  <path d="M108.628 253.36L111.698 258.687L114.769 253.36H108.628Z" fill="var(--primary-contrast)" />
  <path d="M129.147 177.187L164.218 212.258" stroke="var(--primary-contrast)" stroke-width="0.766053" stroke-miterlimit="10" />
  <path d="M161.937 213.504L166.759 214.799L165.464 209.977L161.937 213.504Z" fill="var(--primary-contrast)" />
  <path d="M94.2489 177.187L59.1779 212.258" stroke="var(--primary-contrast)" stroke-width="0.766053" stroke-miterlimit="10" />
  <path d="M57.9324 209.977L56.6376 214.799L61.4592 213.504L57.9324 209.977Z" fill="var(--primary-contrast)" />
</svg>

      </div>
    </div>
    
    <div class="docs-alert docs-alert-tip">
    <p><strong>提示：</strong> 在深入學習本綜合指南之前，請先檢視 Angular 的 <a href="essentials/signals">要點</a>。</p>

    </div>
    
  <h2 id="what-are-signals">
    <a href="#what-are-signals" class="docs-anchor" tabindex="-1" aria-label="Link to What are signals?">什麼是 Signal？</a>
  </h2>
  <p><strong>Signal</strong> 是對值的套件裝器，當該值發生變化時，它會通知感興趣的使用者。Signal 可以包含任何值，從原始型別到複雜的資料結構。</p>
<p>你可以透過呼叫 signal 的 getter 函式來讀取其值，這允許 Angular 跟蹤 signal 的使用位置。</p>
<p>Signal 可以是<em>可寫</em>的，也可以是<em>只讀</em>的。</p>

  <h3 id="writable-signals">
    <a href="#writable-signals" class="docs-anchor" tabindex="-1" aria-label="Link to Writable signals">可寫 Signal</a>
  </h3>
  <p>可寫 Signal 提供了一個 API，用於直接更新它們的值。你可以透過使用 signal 的初始值呼叫 <code>signal</code> 函式來建立可寫 signal：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Signals are getter functions - calling them reads their value.</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'The count is: '</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> +</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">());</span></span></code></pre>
    </pre>
  </div><p>要更改可寫 signal 的值，可以直接 <code>.set()</code> 它：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">count.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
    </pre>
  </div><p>或者使用 <code>.update()</code> 操作從先前的值計算出一個新值：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Increment the count by 1.</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">count.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
    </pre>
  </div><p>可寫 Signal 的型別為 <code>WritableSignal</code>。</p>

  <h3 id="computed-signals">
    <a href="#computed-signals" class="docs-anchor" tabindex="-1" aria-label="Link to Computed signals">計算 Signal</a>
  </h3>
  <p><strong>計算 Signal</strong> 是隻讀 signal，它們的值從其他 signal 派生而來。你可以使用 <code>computed</code> 函式並指定派生方式來定義計算 Signal：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> WritableSignal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> doubleCount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
    </pre>
  </div><p><code>doubleCount</code> signal 依賴於 <code>count</code> signal。每當 <code>count</code> 更新時，Angular 都會知道 <code>doubleCount</code> 也需要更新。</p>

  <h4 id="computed-signals-are-both-lazily-evaluated-and-memoized">
    <a href="#computed-signals-are-both-lazily-evaluated-and-memoized" class="docs-anchor" tabindex="-1" aria-label="Link to Computed signals are both lazily evaluated and memoized">計算 Signal 既是惰性求值的，又是經過 memoized 的</a>
  </h4>
  <p>在首次讀取 <code>doubleCount</code> 之前，<code>doubleCount</code> 的派生函式不會執行以計算其值。然後，計算出的值會被快取，如果再次讀取 <code>doubleCount</code>，它將回傳快取的值，而無需重新計算。</p>
<p>如果你隨後更改 <code>count</code>，Angular 就會知道 <code>doubleCount</code> 的快取值不再有效，並且下次你讀取 <code>doubleCount</code> 時，將計算其新值。</p>
<p>因此，你可以在計算 Signal 中安全地執行計算量大的派生，例如過濾陣列。</p>

  <h4 id="computed-signals-are-not-writable-signals">
    <a href="#computed-signals-are-not-writable-signals" class="docs-anchor" tabindex="-1" aria-label="Link to Computed signals are not writable signals">計算 Signal 不是可寫 Signal</a>
  </h4>
  <p>你不能直接為計算 Signal 賦值。也就是說，</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">doubleCount.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span></code></pre>
    </pre>
  </div><p>會產生編譯錯誤，因為 <code>doubleCount</code> 不是 <code>WritableSignal</code>。</p>

  <h4 id="computed-signal-dependencies-are-dynamic">
    <a href="#computed-signal-dependencies-are-dynamic" class="docs-anchor" tabindex="-1" aria-label="Link to Computed signal dependencies are dynamic">計算 Signal 的依賴是動態的</a>
  </h4>
  <p>只有在派生期間實際讀取的 signal 才會被跟蹤。例如，在此 <code>computed</code> 中，僅當 <code>showCount</code> signal 為 true 時，才會讀取 <code>count</code> signal：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> showCount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> conditionalCount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">showCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()) {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> `The count is ${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}.`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'Nothing to see here!'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span></code></pre>
    </pre>
  </div><p>當你讀取 <code>conditionalCount</code> 時，如果 <code>showCount</code> 為 <code>false</code>，則會回傳『Nothing to see here!』訊息，<em>而無需</em>讀取 <code>count</code> signal。這意味著，如果你稍後更新 <code>count</code>，它<em>不會</em>導致 <code>conditionalCount</code> 的重新計算。</p>
<p>如果你將 <code>showCount</code> 設定為 <code>true</code>，然後再次讀取 <code>conditionalCount</code>，則派生將重新執行並採用 <code>showCount</code> 為 <code>true</code> 的分支，回傳顯示 <code>count</code> 值的訊息。然後，更改 <code>count</code> 將使 <code>conditionalCount</code> 的快取值無效。</p>
<p>請注意，依賴項可以在派生期間被刪除以及新增。如果你稍後將 <code>showCount</code> 設定回 <code>false</code>，則 <code>count</code> 將不再被視為 <code>conditionalCount</code> 的依賴項。</p>

  <h2 id="reading-signals-in-onpush-components">
    <a href="#reading-signals-in-onpush-components" class="docs-anchor" tabindex="-1" aria-label="Link to Reading signals in <code>OnPush</code> components">在 <code>OnPush</code> 元件中讀取 signal</a>
  </h2>
  <p>當你在 <code>OnPush</code> 元件的範本中讀取 signal 時，Angular 會將該 signal 跟蹤為該組件的依賴項。當該 signal 的值發生更改時，Angular 會自動<a href="api/core/ChangeDetectorRef#markforcheck">標記</a>該組件，以確保在下次變更檢測執行時對其進行更新。有關 <code>OnPush</code> 元件的更多訊息，請參閱<a href="best-practices/skipping-subtrees">跳過元件子樹</a>指南。</p>

  <h2 id="effects">
    <a href="#effects" class="docs-anchor" tabindex="-1" aria-label="Link to Effects">副作用</a>
  </h2>
  <p>Signal 非常有用，因為它們會在值更改時通知感興趣的使用者。<strong>副作用</strong>是一種操作，當一個或多個 signal 值發生更改時，它會執行。你可以使用 <code>effect</code> 函式建立一個副作用：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`The current count is: ${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span></code></pre>
    </pre>
  </div><p>副作用總是<strong>至少執行一次。</strong> 當副作用執行時，它會跟蹤任何 signal 值的讀取。每當這些 signal 值中的任何一個發生更改時，副作用都會再次執行。與計算 Signal 類似，副作用會動態跟蹤其依賴項，並且僅跟蹤在最近一次執行中讀取的 signal。</p>
<p>副作用總是在變更檢測過程中<strong>非同步</strong>執行。</p>

  <h3 id="use-cases-for-effects">
    <a href="#use-cases-for-effects" class="docs-anchor" tabindex="-1" aria-label="Link to Use cases for effects">副作用的用例</a>
  </h3>
  <p>在大多數應用程式碼中，副作用很少是必要的，但在特定情況下可能很有用。以下是一些 <code>effect</code> 可能是良好解決方案的情況範例：</p>

  <ul class="docs-list">
    <li>記錄正在顯示的資料及其更改時間，用於分析或作為除錯工具。</li>
<li>使資料與 <code>window.localStorage</code> 保持同步。</li>
<li>新增無法用範本語法表達的自定義 DOM 行為。</li>
<li>對 <code>&lt;canvas&gt;</code>、圖表函式庫或其他第三方 UI 函式庫執行自定義渲染。</li>

  </ul>
  
    <div class="docs-callout docs-callout-critical">
      <h3>何時不使用副作用</h3>
      <p>避免使用副作用來傳播狀態更改。這可能會導致 <code>ExpressionChangedAfterItHasBeenChecked</code> 錯誤、無限迴圈更新或不必要的變更檢測週期。</p>
<p>相反，使用 <code>computed</code> signal 對依賴於其他狀態的狀態進行建模。</p>

    </div>
    
  <h3 id="injection-context">
    <a href="#injection-context" class="docs-anchor" tabindex="-1" aria-label="Link to Injection context">注入上下文</a>
  </h3>
  <p>預設情況下，你只能在<a href="guide/di/dependency-injection-context">注入上下文</a>（你可以訪問 <code>inject</code> 函式的地方）中建立 <code>effect()</code>。滿足此要求的最簡單方法是在元件、指令或服務的 <code>constructor</code> 中呼叫 <code>effect</code>：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> EffectiveCounterComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // Register a new effect.</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`The count is: ${</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    });</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>或者，你可以將副作用賦值給一個欄位（這也為其提供了一個描述性名稱）。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> EffectiveCounterComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> loggingEffect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`The count is: ${</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  });</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>要在建構式函式外部建立副作用，你可以透過其選項將 <code>Injector</code> 傳遞給 <code>effect</code>：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> EffectiveCounterComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> injector</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Injector);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  initializeLogging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`The count is: ${</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }, {injector: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.injector});</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div>
  <h3 id="destroying-effects">
    <a href="#destroying-effects" class="docs-anchor" tabindex="-1" aria-label="Link to Destroying effects">銷燬副作用</a>
  </h3>
  <p>當你建立一個副作用時，它會在其封閉上下文被銷燬時自動銷燬。這意味著在元件內建立的副作用會在元件被銷燬時銷燬。指令、服務等中的副作用也是如此。</p>
<p>副作用回傳一個 <code>EffectRef</code>，你可以透過呼叫 <code>.destroy()</code> 方法手動銷燬它們。你可以將此與 <code>manualCleanup</code> 選項結合使用，以建立一個持續到手動銷燬為止的副作用。請注意在不再需要此類別副作用時實際清理它們。</p>

  <h2 id="advanced-topics">
    <a href="#advanced-topics" class="docs-anchor" tabindex="-1" aria-label="Link to Advanced topics">高階主題</a>
  </h2>
  
  <h3 id="signal-equality-functions">
    <a href="#signal-equality-functions" class="docs-anchor" tabindex="-1" aria-label="Link to Signal equality functions">Signal 相等性函式</a>
  </h3>
  <p>在建立 signal 時，你可以選擇性地提供一個相等性函式，它將用於檢查新值是否與之前的值真正不同。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'lodash'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> signal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'test'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">], {equal: _.isEqual});</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// Even though this is a different array instance, the deep equality</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// function will consider the values to be equal, and the signal won't</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// trigger any updates.</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">data.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'test'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]);</span></span></code></pre>
    </pre>
  </div><p>可以為可寫和計算型 signal 提供相等性函式。</p>

    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 預設情況下，signal 使用引用相等性（<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank"><code>Object.is()</code></a> 比較）。</p>

    </div>
    
  <h3 id="reading-without-tracking-dependencies">
    <a href="#reading-without-tracking-dependencies" class="docs-anchor" tabindex="-1" aria-label="Link to Reading without tracking dependencies">讀取時不跟蹤依賴</a>
  </h3>
  <p>極少數情況下，你可能希望執行某些程式碼，這些程式碼可能會在諸如 <code>computed</code> 或 <code>effect</code> 之類別的回應式函式中讀取 signal，<em>而無需</em>建立依賴。</p>
<p>例如，假設當 <code>currentUser</code> 更改時，應該記錄 <code>counter</code> 的值。你可以建立一個 <code>effect</code> 來讀取這兩個 signal：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`User set to ${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">currentUser</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">} and the counter is ${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">counter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span></code></pre>
    </pre>
  </div><p>此範例將在 <code>currentUser</code> 或 <code>counter</code> <em>任一</em>更改時記錄一條訊息。但是，如果 effect 應該僅在 <code>currentUser</code> 更改時運行，則對 <code>counter</code> 的讀取只是附帶的，並且對 <code>counter</code> 的更改不應記錄新訊息。</p>
<p>你可以透過使用 <code>untracked</code> 呼叫 signal 的 getter 來阻止跟蹤 signal 讀取：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`User set to ${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">currentUser</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">} and the counter is ${</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">untracked</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">counter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span></code></pre>
    </pre>
  </div><p>當副作用需要呼叫一些不應被視為依賴項的外部程式碼時，<code>untracked</code> 也很有用：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> currentUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  untracked</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // If the `loggingService` reads signals, they won't be counted as</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    // dependencies of this effect.</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.loggingService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`User set to ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  });</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span></code></pre>
    </pre>
  </div>
  <h3 id="effect-cleanup-functions">
    <a href="#effect-cleanup-functions" class="docs-anchor" tabindex="-1" aria-label="Link to Effect cleanup functions">Effect 清理函式</a>
  </h3>
  <p>Effect 可能會啟動長時間執行的操作，如果 effect 在第一個操作完成之前被銷燬或再次執行，則應取消這些操作。建立 effect 時，你的函式可以選擇接受一個 <code>onCleanup</code> 函式作為其第一個引數。此 <code>onCleanup</code> 函式允許你註冊一個回呼，該回調在 effect 的下一次執行開始之前或在 effect 被銷燬時調用。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">effect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">onCleanup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> currentUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> timer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">`1 second ago, the user became ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  onCleanup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    clearTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(timer);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  });</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span></code></pre>
    </pre>
  </div>
  <h2 id="using-signals-with-rxjs">
    <a href="#using-signals-with-rxjs" class="docs-anchor" tabindex="-1" aria-label="Link to Using signals with RxJS">將 signal 與 RxJS 結合使用</a>
  </h2>
  <p>有關 signal 和 RxJS 之間互操作性的詳細訊息，請參閱 <a href="ecosystem/rxjs-interop">RxJS 與 Angular signal 的互操作性</a>。</p>
