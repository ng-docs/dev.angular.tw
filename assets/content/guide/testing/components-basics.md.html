<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1s9f16r2wc6phj8bf3kodn08h">测试组件的基础知识</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/testing/components-basics.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="9hsxp9iw95bs3scy4ntqpbtwg">组件与 Angular 应用的所有其它部分不同，它结合了 HTML 模板和 TypeScript 类。事实上，组件就是由模板和类<em>一起工作的</em>。要想对组件进行充分的测试，你应该测试它们是否如预期般协同工作。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7mo0jqnepj8lt72yab1qipi64">这些测试需要在浏览器 DOM 中创建该组件的宿主元素，就像 Angular 所做的那样，然后检查组件类与 DOM 的交互是否如模板中描述的那样工作。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="2n95hdt79tz0h80sguq5ljxma">Angular 的 
<code>TestBed</code> 促进了这种测试，正如你将在以下部分中看到的。 但在许多情况下，
<em>仅测试组件类</em>，不涉及 DOM，可以以更直接、更明显的方式验证组件的大部分行为。</p>

  <h2 id="component-class-testing">
    <a href="#component-class-testing" class="docs-anchor" tabindex="-1" aria-label="Link to Component class testing" data-ng_translator_product="100" data-ng_translator_ref_id="26mhq7x1mb19fody4898e6z4t">组件类测试</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6y61bnbx1ffej8bg7z1ejaikf">你可以像测试服务类那样来测试一个组件类本身。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4j9wry43qb3nab9ae1lftlw5">组件类的测试应该保持非常干净和简单。它应该只测试一个单元。一眼看上去，你就应该能够理解正在测试的对象。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="47ms0mimli30s4p3wzodkop6d">考虑这个 <code>LightswitchComponent</code>，当用户单击该按钮时，它会打开和关闭一个指示灯（用屏幕上的一条消息表示）。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/demo/demo.ts" visiblelines="117,118,119,120,121,122,123,124,125,126,127,128,129,130,131" header="app/demo/demo.ts (LightswitchComp)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="p42czbus7x3esgcc166wdtx9">app/demo/demo.ts（LightswitchComp）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {</div><div class="hljs-ln-line">  Component,</div><div class="hljs-ln-line">  ContentChildren,</div><div class="hljs-ln-line">  Directive,</div><div class="hljs-ln-line">  EventEmitter,</div><div class="hljs-ln-line">  HostBinding,</div><div class="hljs-ln-line">  HostListener,</div><div class="hljs-ln-line">  Injectable,</div><div class="hljs-ln-line">  Input,</div><div class="hljs-ln-line">  OnChanges,</div><div class="hljs-ln-line">  OnDestroy,</div><div class="hljs-ln-line">  OnInit,</div><div class="hljs-ln-line">  Optional,</div><div class="hljs-ln-line">  Output,</div><div class="hljs-ln-line">  Pipe,</div><div class="hljs-ln-line">  PipeTransform,</div><div class="hljs-ln-line">  SimpleChanges,</div><div class="hljs-ln-line">} from <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {FormsModule} from <span class="hljs-string">'@angular/forms'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {of} from <span class="hljs-string">'rxjs'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {delay} from <span class="hljs-string">'rxjs/operators'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {sharedImports} from <span class="hljs-string">'../shared/shared'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">////////// The App: Services and Components for the tests. //////////////</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">export <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Hero</span> {</div><div class="hljs-ln-line">  name: string;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">////////// Services ///////////////</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Injectable()</span></div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">ValueService</span> {</div><div class="hljs-ln-line">  value = <span class="hljs-string">'real value'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  getValue() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">  setValue(value: string) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.value = value;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  getObservableValue() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> of(<span class="hljs-string">'observable value'</span>);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  getPromiseValue() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> Promise.resolve(<span class="hljs-string">'promise value'</span>);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  getObservableDelayValue() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> of(<span class="hljs-string">'observable delay value'</span>).pipe(delay(<span class="hljs-number">10</span>));</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Injectable()</span></div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">MasterService</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">private</span> valueService: ValueService) {}</div><div class="hljs-ln-line">  getValue() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.valueService.getValue();</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/////////// Pipe ////////////////</span></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line"> * Reverse the input string.</div><div class="hljs-ln-line"> */</div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe({name: <span class="hljs-string">'reverse'</span>, standalone: true})</span></div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReversePipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> {</div><div class="hljs-ln-line">  transform(s: string) {</div><div class="hljs-ln-line">    let r = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line">    <span class="hljs-keyword">for</span> (let i = s.length; i; ) {</div><div class="hljs-ln-line">      r += s[--i];</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> r;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">//////////// Components /////////////</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'bank-account'</span>,</div><div class="hljs-ln-line">  template: ` Bank Name: {{ bank }} Account Id: {{ id }} `,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccountComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input()</span> bank = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input(<span class="hljs-string">'account'</span>)</span> id = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-comment">// Removed on 12/02/2016 when ceased public discussion of the `Renderer`. Revive in future?</span></div><div class="hljs-ln-line">  <span class="hljs-comment">// constructor(private renderer: Renderer, private el: ElementRef ) {</span></div><div class="hljs-ln-line">  <span class="hljs-comment">//   renderer.setElementProperty(el.nativeElement, 'customProperty', true);</span></div><div class="hljs-ln-line">  <span class="hljs-comment">// }</span></div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/** A component with attributes, styles, classes, and property setting */</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'bank-account-parent'</span>,</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    &lt;bank-account</div><div class="hljs-ln-line">      bank=<span class="hljs-string">"RBC"</span></div><div class="hljs-ln-line">      account=<span class="hljs-string">"4747"</span></div><div class="hljs-ln-line">      [style.width.px]=<span class="hljs-string">"width"</span></div><div class="hljs-ln-line">      [style.color]=<span class="hljs-string">"color"</span></div><div class="hljs-ln-line">      [class.closed]=<span class="hljs-string">"isClosed"</span></div><div class="hljs-ln-line">      [class.open]=<span class="hljs-string">"!isClosed"</span></div><div class="hljs-ln-line">    &gt;</div><div class="hljs-ln-line">    &lt;/bank-account&gt;</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  imports: [BankAccountComponent],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccountParentComponent</span> {</div><div class="hljs-ln-line">  width = <span class="hljs-number">200</span>;</div><div class="hljs-ln-line">  color = <span class="hljs-string">'red'</span>;</div><div class="hljs-ln-line">  isClosed = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'lightswitch-comp'</span>,</div><div class="hljs-ln-line">  template: ` &lt;button type=<span class="hljs-string">"button"</span> (click)=<span class="hljs-string">"clicked()"</span>&gt;Click me!&lt;/button&gt;</div><div class="hljs-ln-line">    &lt;span&gt;{{ message }}&lt;/span&gt;`,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">LightswitchComponent</span> {</div><div class="hljs-ln-line">  isOn = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">  clicked() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.isOn = !<span class="hljs-keyword">this</span>.isOn;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">  <span class="hljs-keyword">get</span> message() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> `The light <span class="hljs-keyword">is</span> ${<span class="hljs-keyword">this</span>.isOn ? <span class="hljs-string">'On'</span> : <span class="hljs-string">'Off'</span>}`;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'child-1'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'&lt;span&gt;Child-1({{text}})&lt;/span&gt;'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">Child1Component</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input()</span> text = <span class="hljs-string">'Original'</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'child-2'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'&lt;div&gt;Child-2({{text}})&lt;/div&gt;'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">Child2Component</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input()</span> text = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'child-3'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'&lt;div&gt;Child-3({{text}})&lt;/div&gt;'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">Child3Component</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input()</span> text = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'input-comp'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'&lt;input [(ngModel)]="name"&gt;'</span>,</div><div class="hljs-ln-line">  imports: [FormsModule],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">InputComponent</span> {</div><div class="hljs-ln-line">  name = <span class="hljs-string">'John'</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/* Prefer this metadata syntax */</span></div><div class="hljs-ln-line"><span class="hljs-comment">// @Directive({</span></div><div class="hljs-ln-line"><span class="hljs-comment">//   selector: 'input[value]',</span></div><div class="hljs-ln-line"><span class="hljs-comment">//   host: {</span></div><div class="hljs-ln-line"><span class="hljs-comment">//     '[value]': 'value',</span></div><div class="hljs-ln-line"><span class="hljs-comment">//     '(input)': 'valueChange.emit($event.target.value)'</span></div><div class="hljs-ln-line"><span class="hljs-comment">//   },</span></div><div class="hljs-ln-line"><span class="hljs-comment">//   inputs:  ['value'],</span></div><div class="hljs-ln-line"><span class="hljs-comment">//   outputs: ['valueChange']</span></div><div class="hljs-ln-line"><span class="hljs-comment">// })</span></div><div class="hljs-ln-line"><span class="hljs-comment">// export class InputValueBinderDirective {</span></div><div class="hljs-ln-line"><span class="hljs-comment">//   value: any;</span></div><div class="hljs-ln-line"><span class="hljs-comment">//   valueChange: EventEmitter&lt;any&gt; = new EventEmitter();</span></div><div class="hljs-ln-line"><span class="hljs-comment">// }</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">// As the styleguide recommends</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Directive({standalone: true, selector: <span class="hljs-string">'input[value]'</span>})</span></div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">InputValueBinderDirective</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@HostBinding()</span> <span class="hljs-meta">@Input()</span> value: any;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-meta">@Output()</span> valueChange: EventEmitter&lt;any&gt; = new EventEmitter();</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-meta">@HostListener(<span class="hljs-string">'input'</span>, [<span class="hljs-string">'$event.target.value'</span>])</span></div><div class="hljs-ln-line">  onInput(value: any) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.valueChange.emit(value);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'input-value-comp'</span>,</div><div class="hljs-ln-line">  template: ` Name: &lt;input [value]=<span class="hljs-string">"name"</span> /&gt; {{ name }} `,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">InputValueBinderComponent</span> {</div><div class="hljs-ln-line">  name = <span class="hljs-string">'Sally'</span>; <span class="hljs-comment">// initial value</span></div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'parent-comp'</span>,</div><div class="hljs-ln-line">  imports: [Child1Component],</div><div class="hljs-ln-line">  template: <span class="hljs-string">'Parent(&lt;child-1&gt;&lt;/child-1&gt;)'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParentComponent</span> {}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'io-comp'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'&lt;button type="button" class="hero" (click)="click()"&gt;Original {{hero.name}}&lt;/button&gt;'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">IoComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input()</span> hero!: Hero;</div><div class="hljs-ln-line">  <span class="hljs-meta">@Output()</span> selected = new EventEmitter&lt;Hero&gt;();</div><div class="hljs-ln-line">  click() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.selected.emit(<span class="hljs-keyword">this</span>.hero);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'io-parent-comp'</span>,</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    @if (!selectedHero) {</div><div class="hljs-ln-line">      &lt;p&gt;&lt;i&gt;Click to select a hero&lt;/i&gt;&lt;/p&gt;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    @if (selectedHero) {</div><div class="hljs-ln-line">      &lt;p&gt;The selected hero is {{ selectedHero.name }}&lt;/p&gt;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    @for (hero of heroes; track hero) {</div><div class="hljs-ln-line">      &lt;io-comp [hero]=<span class="hljs-string">"hero"</span> (selected)=<span class="hljs-string">"onSelect(<span class="hljs-variable">$event</span>)"</span>&gt; &lt;/io-comp&gt;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  imports: [IoComponent, sharedImports],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">IoParentComponent</span> {</div><div class="hljs-ln-line">  heroes: Hero[] = [{name: <span class="hljs-string">'Bob'</span>}, {name: <span class="hljs-string">'Carol'</span>}, {name: <span class="hljs-string">'Ted'</span>}, {name: <span class="hljs-string">'Alice'</span>}];</div><div class="hljs-ln-line">  selectedHero!: Hero;</div><div class="hljs-ln-line">  onSelect(hero: Hero) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.selectedHero = hero;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'my-if-comp'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'MyIf(@if (showMore) {&lt;span&gt;More&lt;/span&gt;})'</span>,</div><div class="hljs-ln-line">  imports: [sharedImports],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyIfComponent</span> {</div><div class="hljs-ln-line">  showMore = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'my-service-comp'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'injected value: {{valueService.value}}'</span>,</div><div class="hljs-ln-line">  providers: [ValueService],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestProvidersComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">public</span> valueService: ValueService) {}</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'my-service-comp'</span>,</div><div class="hljs-ln-line">  template: <span class="hljs-string">'injected value: {{valueService.value}}'</span>,</div><div class="hljs-ln-line">  viewProviders: [ValueService],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestViewProvidersComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">public</span> valueService: ValueService) {}</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'external-template-comp'</span>,</div><div class="hljs-ln-line">  templateUrl: <span class="hljs-string">'./demo-external-template.html'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExternalTemplateComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span> {</div><div class="hljs-ln-line">  serviceValue = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-keyword">constructor</span>(<span class="hljs-meta">@Optional()</span> <span class="hljs-keyword">private</span> service?: ValueService) {}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnInit() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.service) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">this</span>.serviceValue = <span class="hljs-keyword">this</span>.service.getValue();</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'comp-w-ext-comp'</span>,</div><div class="hljs-ln-line">  imports: [ExternalTemplateComponent],</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    &lt;h3&gt;comp-w-ext-comp&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;external-template-comp&gt;&lt;/external-template-comp&gt;</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">InnerCompWithExternalTemplateComponent</span> {}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({standalone: true, selector: <span class="hljs-string">'needs-content'</span>, template: <span class="hljs-string">'&lt;ng-content&gt;&lt;/ng-content&gt;'</span>})</span></div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">NeedsContentComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-comment">// children with #content local variable</span></div><div class="hljs-ln-line">  <span class="hljs-meta">@ContentChildren(<span class="hljs-string">'content'</span>)</span> children: any;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">///////// MyIfChildComp ////////</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'my-if-child-1'</span>,</div><div class="hljs-ln-line">  template: ` &lt;h4&gt;MyIfChildComp&lt;/h4&gt;</div><div class="hljs-ln-line">    &lt;div&gt;</div><div class="hljs-ln-line">      &lt;label for=<span class="hljs-string">"child-value"</span></div><div class="hljs-ln-line">        &gt;Child value: &lt;input id=<span class="hljs-string">"child-value"</span> [(ngModel)]=<span class="hljs-string">"childValue"</span> /&gt;</div><div class="hljs-ln-line">      &lt;/label&gt;</div><div class="hljs-ln-line">    &lt;/div&gt;</div><div class="hljs-ln-line">    &lt;p&gt;&lt;i&gt;Change log:&lt;/i&gt;&lt;/p&gt;</div><div class="hljs-ln-line">    @for (log of changeLog; track log; let i = $index) {</div><div class="hljs-ln-line">      &lt;div&gt;{{ i + 1 }} - {{ log }}&lt;/div&gt;</div><div class="hljs-ln-line">    }`,</div><div class="hljs-ln-line">  imports: [FormsModule, sharedImports],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyIfChildComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span>, <span class="hljs-type">OnChanges</span>, <span class="hljs-type">OnDestroy</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input()</span> value = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line">  <span class="hljs-meta">@Output()</span> valueChange = new EventEmitter&lt;string&gt;();</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-keyword">get</span> childValue() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">  <span class="hljs-keyword">set</span> childValue(v: string) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.value === v) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">return</span>;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.value = v;</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.valueChange.emit(v);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  changeLog: string[] = [];</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnInitCalled = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">  ngOnChangesCounter = <span class="hljs-number">0</span>;</div><div class="hljs-ln-line">  ngOnDestroyCalled = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnInit() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.ngOnInitCalled = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.changeLog.push(<span class="hljs-string">'ngOnInit called'</span>);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnDestroy() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.ngOnDestroyCalled = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.changeLog.push(<span class="hljs-string">'ngOnDestroy called'</span>);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnChanges(changes: SimpleChanges) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> propName <span class="hljs-keyword">in</span> changes) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">this</span>.ngOnChangesCounter += <span class="hljs-number">1</span>;</div><div class="hljs-ln-line">      <span class="hljs-keyword">const</span> prop = changes[propName];</div><div class="hljs-ln-line">      <span class="hljs-keyword">const</span> cur = JSON.stringify(prop.currentValue);</div><div class="hljs-ln-line">      <span class="hljs-keyword">const</span> prev = JSON.stringify(prop.previousValue);</div><div class="hljs-ln-line">      <span class="hljs-keyword">this</span>.changeLog.push(`${propName}: currentValue = ${cur}, previousValue = ${prev}`);</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">///////// MyIfParentComp ////////</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'my-if-parent-comp'</span>,</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    &lt;h3&gt;MyIfParentComp&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;label for=<span class="hljs-string">"parent"</span></div><div class="hljs-ln-line">      &gt;Parent value:</div><div class="hljs-ln-line">      &lt;input id=<span class="hljs-string">"parent"</span> [(ngModel)]=<span class="hljs-string">"parentValue"</span> /&gt;</div><div class="hljs-ln-line">    &lt;/label&gt;</div><div class="hljs-ln-line">    &lt;button type=<span class="hljs-string">"button"</span> (click)=<span class="hljs-string">"clicked()"</span>&gt;{{ toggleLabel }} Child&lt;/button&gt;&lt;br /&gt;</div><div class="hljs-ln-line">    @if (showChild) {</div><div class="hljs-ln-line">      &lt;div style=<span class="hljs-string">"margin: 4px; padding: 4px; background-color: aliceblue;"</span>&gt;</div><div class="hljs-ln-line">        &lt;my-if-child-1 [(value)]=<span class="hljs-string">"parentValue"</span>&gt;&lt;/my-if-child-1&gt;</div><div class="hljs-ln-line">      &lt;/div&gt;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  imports: [FormsModule, MyIfChildComponent, sharedImports],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyIfParentComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span> {</div><div class="hljs-ln-line">  ngOnInitCalled = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">  parentValue = <span class="hljs-string">'Hello, World'</span>;</div><div class="hljs-ln-line">  showChild = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">  toggleLabel = <span class="hljs-string">'Unknown'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnInit() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.ngOnInitCalled = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.clicked();</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  clicked() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.showChild = !<span class="hljs-keyword">this</span>.showChild;</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.toggleLabel = <span class="hljs-keyword">this</span>.showChild ? <span class="hljs-string">'Close'</span> : <span class="hljs-string">'Show'</span>;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'reverse-pipe-comp'</span>,</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    &lt;input [(ngModel)]=<span class="hljs-string">"text"</span> /&gt;</div><div class="hljs-ln-line">    &lt;span&gt;{{ text | reverse }}&lt;/span&gt;</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  imports: [ReversePipe, FormsModule],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReversePipeComponent</span> {</div><div class="hljs-ln-line">  text = <span class="hljs-string">'my dog has fleas.'</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  imports: [NeedsContentComponent],</div><div class="hljs-ln-line">  template: <span class="hljs-string">'&lt;div&gt;Replace Me&lt;/div&gt;'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShellComponent</span> {}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'demo-comp'</span>,</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    &lt;h1&gt;Specs Demo&lt;/h1&gt;</div><div class="hljs-ln-line">    &lt;my-if-parent-comp&gt;&lt;/my-if-parent-comp&gt;</div><div class="hljs-ln-line">    &lt;hr /&gt;</div><div class="hljs-ln-line">    &lt;h3&gt;Input/Output Component&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;io-parent-comp&gt;&lt;/io-parent-comp&gt;</div><div class="hljs-ln-line">    &lt;hr /&gt;</div><div class="hljs-ln-line">    &lt;h3&gt;External Template Component&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;external-template-comp&gt;&lt;/external-template-comp&gt;</div><div class="hljs-ln-line">    &lt;hr /&gt;</div><div class="hljs-ln-line">    &lt;h3&gt;Component With External Template Component&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;comp-w-ext-comp&gt;&lt;/comp-w-ext-comp&gt;</div><div class="hljs-ln-line">    &lt;hr /&gt;</div><div class="hljs-ln-line">    &lt;h3&gt;Reverse Pipe&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;reverse-pipe-comp&gt;&lt;/reverse-pipe-comp&gt;</div><div class="hljs-ln-line">    &lt;hr /&gt;</div><div class="hljs-ln-line">    &lt;h3&gt;InputValueBinder Directive&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;input-value-comp&gt;&lt;/input-value-comp&gt;</div><div class="hljs-ln-line">    &lt;hr /&gt;</div><div class="hljs-ln-line">    &lt;h3&gt;Button Component&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;lightswitch-comp&gt;&lt;/lightswitch-comp&gt;</div><div class="hljs-ln-line">    &lt;hr /&gt;</div><div class="hljs-ln-line">    &lt;h3&gt;Needs Content&lt;/h3&gt;</div><div class="hljs-ln-line">    &lt;needs-content #nc&gt;</div><div class="hljs-ln-line">      &lt;child-1 #content text=<span class="hljs-string">"My"</span>&gt;&lt;/child-1&gt;</div><div class="hljs-ln-line">      &lt;child-2 #content text=<span class="hljs-string">"dog"</span>&gt;&lt;/child-2&gt;</div><div class="hljs-ln-line">      &lt;child-2 text=<span class="hljs-string">"has"</span>&gt;&lt;/child-2&gt;</div><div class="hljs-ln-line">      &lt;child-3 #content text=<span class="hljs-string">"fleas"</span>&gt;&lt;/child-3&gt;</div><div class="hljs-ln-line">      &lt;div #content&gt;!&lt;/div&gt;</div><div class="hljs-ln-line">    &lt;/needs-content&gt;</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  imports: [</div><div class="hljs-ln-line">    Child1Component,</div><div class="hljs-ln-line">    Child2Component,</div><div class="hljs-ln-line">    Child3Component,</div><div class="hljs-ln-line">    ExternalTemplateComponent,</div><div class="hljs-ln-line">    InnerCompWithExternalTemplateComponent,</div><div class="hljs-ln-line">    InputValueBinderComponent,</div><div class="hljs-ln-line">    IoParentComponent,</div><div class="hljs-ln-line">    LightswitchComponent,</div><div class="hljs-ln-line">    NeedsContentComponent,</div><div class="hljs-ln-line">    ReversePipeComponent,</div><div class="hljs-ln-line">    MyIfParentComponent,</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoComponent</span> {}</div><div class="hljs-ln-line"><span class="hljs-comment">//////// Aggregations ////////////</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">export <span class="hljs-keyword">const</span> demoProviders = [MasterService, ValueService];</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="d51mwvoinu32eq94rrxfe2ocu">你可能要测试 <code>clicked()</code> 方法是否切换了灯的<em>开/关</em>状态并正确设置了这个消息。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="dj1a7vjfgpeh27vbeg9b2jukn">这个组件类没有依赖。要测试这种类型的组件类，请遵循与没有依赖的服务相同的步骤：</p>

    <ol class="docs-ordered-list">
      <li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1n5rdwlykyse6153qmc14keu1">使用 new 关键字创建一个组件。</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="40ccrfc8yqxuk9ujhpw6hr5ob">调用它的 API。</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="43e8jq71ja306uj154qrpz9ya">对其公开状态的期望值进行断言。</li>

    </ol>
    <div class="docs-code" path="adev/src/content/examples/testing/src/app/demo/demo.spec.ts" visiblelines="109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127" header="app/demo/demo.spec.ts (Lightswitch tests)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="ufomenwfimbl84amdjkbdv53">app/demo/demo.spec.ts（Lightswitch 测试）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {LightswitchComponent, MasterService, ValueService, ReversePipe} <span class="hljs-keyword">from</span> <span class="hljs-string">'./demo'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">///////// Fakes /////////</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> FakeValueService extends ValueService {</div><div class="hljs-ln-line">  override <span class="hljs-keyword">value</span> = <span class="hljs-string">'faked service value'</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line">////////////////////////</div><div class="hljs-ln-line">describe(<span class="hljs-string">'demo (no TestBed):'</span>, () =&gt; {</div><div class="hljs-ln-line">  // Straight Jasmine testing <span class="hljs-keyword">without</span> Angular<span class="hljs-string">'s testing support</span></div><div class="hljs-ln-line">  describe('ValueServic<span class="hljs-string">e', () =&gt; {</span></div><div class="hljs-ln-line">    let service: ValueService;</div><div class="hljs-ln-line">    beforeEach(() =&gt; {</div><div class="hljs-ln-line">      service = new ValueService();</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#getValue should <span class="hljs-keyword">return</span> <span class="hljs-type">real</span> valu<span class="hljs-string">e', () =&gt; {</span></div><div class="hljs-ln-line">      expect(service.getValue()).toBe('<span class="hljs-type">real</span> valu<span class="hljs-string">e');</span></div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#getObservableValue should <span class="hljs-keyword">return</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">from</span> observabl<span class="hljs-string">e', (done: DoneFn) =&gt; {</span></div><div class="hljs-ln-line">      service.getObservableValue().subscribe((value) =&gt; {</div><div class="hljs-ln-line">        expect(value).toBe('observable valu<span class="hljs-string">e');</span></div><div class="hljs-ln-line">        done();</div><div class="hljs-ln-line">      });</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#getPromiseValue should <span class="hljs-keyword">return</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">from</span> a promis<span class="hljs-string">e', (done: DoneFn) =&gt; {</span></div><div class="hljs-ln-line">      service.getPromiseValue().then((value) =&gt; {</div><div class="hljs-ln-line">        expect(value).toBe('promise valu<span class="hljs-string">e');</span></div><div class="hljs-ln-line">        done();</div><div class="hljs-ln-line">      });</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  // MasterService requires injection of a ValueService</div><div class="hljs-ln-line">  describe('MasterService <span class="hljs-keyword">without</span> Angular testing support<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">    let masterService: MasterService;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#getValue should <span class="hljs-keyword">return</span> <span class="hljs-type">real</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">from</span> the <span class="hljs-type">real</span> servic<span class="hljs-string">e', () =&gt; {</span></div><div class="hljs-ln-line">      masterService = new MasterService(new ValueService());</div><div class="hljs-ln-line">      expect(masterService.getValue()).toBe('<span class="hljs-type">real</span> valu<span class="hljs-string">e');</span></div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#getValue should <span class="hljs-keyword">return</span> faked <span class="hljs-keyword">value</span> <span class="hljs-keyword">from</span> a fakeServic<span class="hljs-string">e', () =&gt; {</span></div><div class="hljs-ln-line">      masterService = new MasterService(new FakeValueService());</div><div class="hljs-ln-line">      expect(masterService.getValue()).toBe('faked service valu<span class="hljs-string">e');</span></div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#getValue should <span class="hljs-keyword">return</span> faked <span class="hljs-keyword">value</span> <span class="hljs-keyword">from</span> a fake <span class="hljs-keyword">object</span><span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">      const fake = {getValue: () =&gt; 'fake valu<span class="hljs-string">e'};</span></div><div class="hljs-ln-line">      masterService = new MasterService(fake as ValueService);</div><div class="hljs-ln-line">      expect(masterService.getValue()).toBe('fake valu<span class="hljs-string">e');</span></div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#getValue should <span class="hljs-keyword">return</span> stubbed <span class="hljs-keyword">value</span> <span class="hljs-keyword">from</span> a spy<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">      // create `getValue` spy on an object representing the ValueService</div><div class="hljs-ln-line">      const valueServiceSpy = jasmine.createSpyObj('ValueServic<span class="hljs-string">e', ['</span>getValu<span class="hljs-string">e']);</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">      // set the value to return when the `getValue` spy is called.</div><div class="hljs-ln-line">      const stubValue = 'stub valu<span class="hljs-string">e';</span></div><div class="hljs-ln-line">      valueServiceSpy.getValue.and.returnValue(stubValue);</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">      masterService = new MasterService(valueServiceSpy);</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">      expect(masterService.getValue()).withContext('service returned stub valu<span class="hljs-string">e').toBe(stubValue);</span></div><div class="hljs-ln-line">      expect(valueServiceSpy.getValue.calls.count())</div><div class="hljs-ln-line">        .withContext('spy <span class="hljs-keyword">method</span> was <span class="hljs-keyword">called</span> onc<span class="hljs-string">e')</span></div><div class="hljs-ln-line">        .toBe(1);</div><div class="hljs-ln-line">      expect(valueServiceSpy.getValue.calls.mostRecent().returnValue).toBe(stubValue);</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  describe('MasterService (<span class="hljs-keyword">no</span> beforeEach)<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">    it('#getValue should <span class="hljs-keyword">return</span> stubbed <span class="hljs-keyword">value</span> <span class="hljs-keyword">from</span> a spy<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">      const {masterService, stubValue, valueServiceSpy} = setup();</div><div class="hljs-ln-line">      expect(masterService.getValue()).withContext('service returned stub valu<span class="hljs-string">e').toBe(stubValue);</span></div><div class="hljs-ln-line">      expect(valueServiceSpy.getValue.calls.count())</div><div class="hljs-ln-line">        .withContext('spy <span class="hljs-keyword">method</span> was <span class="hljs-keyword">called</span> onc<span class="hljs-string">e')</span></div><div class="hljs-ln-line">        .toBe(1);</div><div class="hljs-ln-line">      expect(valueServiceSpy.getValue.calls.mostRecent().returnValue).toBe(stubValue);</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    function setup() {</div><div class="hljs-ln-line">      const valueServiceSpy = jasmine.createSpyObj('ValueServic<span class="hljs-string">e', ['</span>getValu<span class="hljs-string">e']);</span></div><div class="hljs-ln-line">      const stubValue = 'stub valu<span class="hljs-string">e';</span></div><div class="hljs-ln-line">      const masterService = new MasterService(valueServiceSpy);</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">      valueServiceSpy.getValue.and.returnValue(stubValue);</div><div class="hljs-ln-line">      return {masterService, stubValue, valueServiceSpy};</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  describe('ReversePip<span class="hljs-string">e', () =&gt; {</span></div><div class="hljs-ln-line">    let pipe: ReversePipe;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    beforeEach(() =&gt; {</div><div class="hljs-ln-line">      pipe = new ReversePipe();</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('transforms "abc" <span class="hljs-keyword">to</span> "cba"<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">      expect(pipe.transform('abc<span class="hljs-string">')).toBe('</span>cba<span class="hljs-string">');</span></div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('<span class="hljs-keyword">no</span> change <span class="hljs-keyword">to</span> palindrome: "able was I ere I saw elba"<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">      const palindrome = 'able was I ere I saw elba<span class="hljs-string">';</span></div><div class="hljs-ln-line">      expect(pipe.transform(palindrome)).toBe(palindrome);</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  describe('LightswitchComp<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">    it('#clicked() should toggle #isOn<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">      const comp = new LightswitchComponent();</div><div class="hljs-ln-line">      expect(comp.isOn).withContext('<span class="hljs-keyword">off</span> at first<span class="hljs-string">').toBe(false);</span></div><div class="hljs-ln-line">      comp.clicked();</div><div class="hljs-ln-line">      expect(comp.isOn).withContext('<span class="hljs-keyword">on</span> <span class="hljs-keyword">after</span> click<span class="hljs-string">').toBe(true);</span></div><div class="hljs-ln-line">      comp.clicked();</div><div class="hljs-ln-line">      expect(comp.isOn).withContext('<span class="hljs-keyword">off</span> <span class="hljs-keyword">after</span> second click<span class="hljs-string">').toBe(false);</span></div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    it('#clicked() should <span class="hljs-keyword">set</span> #message <span class="hljs-keyword">to</span> "is on"<span class="hljs-string">', () =&gt; {</span></div><div class="hljs-ln-line">      const comp = new LightswitchComponent();</div><div class="hljs-ln-line">      expect(comp.message)</div><div class="hljs-ln-line">        .withContext('<span class="hljs-keyword">off</span> at first<span class="hljs-string">')</span></div><div class="hljs-ln-line">        .toMatch(/is off/i);</div><div class="hljs-ln-line">      comp.clicked();</div><div class="hljs-ln-line">      expect(comp.message).withContext('<span class="hljs-keyword">on</span> <span class="hljs-keyword">after</span> clicked<span class="hljs-string">').toMatch(/is on/i);</span></div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="b2a873c4i3s2xdl91x59rymqt">下面是“<em>英雄之旅</em>”教程中的 <code>DashboardHeroComponent</code>。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/dashboard/dashboard-hero.component.ts" visiblelines="16,17,18,19,20,21,22" header="app/dashboard/dashboard-hero.component.ts (component)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="3f878b5k4b2d0hv8erf3gy6rm">app/dashboard/dashboard-hero.component.ts（组件）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Component, EventEmitter, Input, Output} from <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {UpperCasePipe} from <span class="hljs-string">'@angular/common'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Hero} from <span class="hljs-string">'../model/hero'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'dashboard-hero'</span>,</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    &lt;button type=<span class="hljs-string">"button"</span> (click)=<span class="hljs-string">"click()"</span> class=<span class="hljs-string">"hero"</span>&gt;</div><div class="hljs-ln-line">      {{ hero.name | uppercase }}</div><div class="hljs-ln-line">    &lt;/button&gt;</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  styleUrls: [<span class="hljs-string">'./dashboard-hero.component.css'</span>],</div><div class="hljs-ln-line">  imports: [UpperCasePipe],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">DashboardHeroComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@Input()</span> hero!: Hero;</div><div class="hljs-ln-line">  <span class="hljs-meta">@Output()</span> selected = new EventEmitter&lt;Hero&gt;();</div><div class="hljs-ln-line">  click() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>.selected.emit(<span class="hljs-keyword">this</span>.hero);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="48sdnxv2wnac7dhhby5w8198h">它出现在父组件的模板中，将某个
<em>英雄</em>绑定到
<code>@Input</code>属性，并监听通过
<em>selected</em>
<code>@Output</code>属性引发的事件。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="2w9vn80kgb6x0hrhk1nnevn6r">你可以测试类代码的工作方式，而无需创建 <code>DashboardHeroComponent</code> 或它的父组件。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/dashboard/dashboard-hero.component.spec.ts" visiblelines="14,15,16,17,18,19,20,21" header="app/dashboard/dashboard-hero.component.spec.ts (class tests)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="5xdixk4959fjrn6r3cek79mx8">app/dashboard/dashboard-hero.component.spec.ts（类测试）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">DebugElement</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">ComponentFixture</span>, <span class="hljs-title class_">TestBed</span>, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">By</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {first} <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {addMatchers, click} <span class="hljs-keyword">from</span> <span class="hljs-string">'../../testing'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {appProviders} <span class="hljs-keyword">from</span> <span class="hljs-string">'../app.config'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Hero</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/hero'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">DashboardHeroComponent</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./dashboard-hero.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">beforeEach</span>(addMatchers);</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'DashboardHeroComponent class only'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'raises the selected event when clicked'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> comp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DashboardHeroComponent</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> <span class="hljs-attr">hero</span>: <span class="hljs-title class_">Hero</span> = {<span class="hljs-attr">id</span>: <span class="hljs-number">42</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Test'</span>};</div><div class="hljs-ln-line">    comp.<span class="hljs-property">hero</span> = hero;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    comp.<span class="hljs-property">selected</span>.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">first</span>()).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">selectedHero: Hero</span>) =&gt;</span> <span class="hljs-title function_">expect</span>(selectedHero).<span class="hljs-title function_">toBe</span>(hero));</div><div class="hljs-ln-line">    comp.<span class="hljs-title function_">click</span>();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'DashboardHeroComponent when tested directly'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">comp</span>: <span class="hljs-title class_">DashboardHeroComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">expectedHero</span>: <span class="hljs-title class_">Hero</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">fixture</span>: <span class="hljs-title class_">ComponentFixture</span>&lt;<span class="hljs-title class_">DashboardHeroComponent</span>&gt;;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">heroDe</span>: <span class="hljs-title class_">DebugElement</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">heroEl</span>: <span class="hljs-title class_">HTMLElement</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-title function_">waitForAsync</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: appProviders,</div><div class="hljs-ln-line">      <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">DashboardHeroComponent</span>],</div><div class="hljs-ln-line">    })</div><div class="hljs-ln-line">      .<span class="hljs-title function_">compileComponents</span>();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    fixture = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">createComponent</span>(<span class="hljs-title class_">DashboardHeroComponent</span>);</div><div class="hljs-ln-line">    comp = fixture.<span class="hljs-property">componentInstance</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">// find the hero's DebugElement and element</span></div><div class="hljs-ln-line">    heroDe = fixture.<span class="hljs-property">debugElement</span>.<span class="hljs-title function_">query</span>(<span class="hljs-title class_">By</span>.<span class="hljs-title function_">css</span>(<span class="hljs-string">'.hero'</span>));</div><div class="hljs-ln-line">    heroEl = heroDe.<span class="hljs-property">nativeElement</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">// mock the hero supplied by the parent component</span></div><div class="hljs-ln-line">    expectedHero = {<span class="hljs-attr">id</span>: <span class="hljs-number">42</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Test Name'</span>};</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">// simulate the parent setting the input property with that hero</span></div><div class="hljs-ln-line">    comp.<span class="hljs-property">hero</span> = expectedHero;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">// trigger initial data binding</span></div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should display hero name in uppercase'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> expectedPipedName = expectedHero.<span class="hljs-property">name</span>.<span class="hljs-title function_">toUpperCase</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(heroEl.<span class="hljs-property">textContent</span>).<span class="hljs-title function_">toContain</span>(expectedPipedName);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should raise selected event when clicked (triggerEventHandler)'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">let</span> <span class="hljs-attr">selectedHero</span>: <span class="hljs-title class_">Hero</span> | <span class="hljs-literal">undefined</span>;</div><div class="hljs-ln-line">    comp.<span class="hljs-property">selected</span>.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">first</span>()).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">hero: Hero</span>) =&gt;</span> (selectedHero = hero));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    heroDe.<span class="hljs-title function_">triggerEventHandler</span>(<span class="hljs-string">'click'</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(selectedHero).<span class="hljs-title function_">toBe</span>(expectedHero);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should raise selected event when clicked (element.click)'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">let</span> <span class="hljs-attr">selectedHero</span>: <span class="hljs-title class_">Hero</span> | <span class="hljs-literal">undefined</span>;</div><div class="hljs-ln-line">    comp.<span class="hljs-property">selected</span>.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">first</span>()).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">hero: Hero</span>) =&gt;</span> (selectedHero = hero));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    heroEl.<span class="hljs-title function_">click</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(selectedHero).<span class="hljs-title function_">toBe</span>(expectedHero);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should raise selected event when clicked (click helper with DebugElement)'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">let</span> <span class="hljs-attr">selectedHero</span>: <span class="hljs-title class_">Hero</span> | <span class="hljs-literal">undefined</span>;</div><div class="hljs-ln-line">    comp.<span class="hljs-property">selected</span>.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">first</span>()).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">hero: Hero</span>) =&gt;</span> (selectedHero = hero));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-title function_">click</span>(heroDe); <span class="hljs-comment">// click helper with DebugElement</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(selectedHero).<span class="hljs-title function_">toBe</span>(expectedHero);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should raise selected event when clicked (click helper with native element)'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">let</span> <span class="hljs-attr">selectedHero</span>: <span class="hljs-title class_">Hero</span> | <span class="hljs-literal">undefined</span>;</div><div class="hljs-ln-line">    comp.<span class="hljs-property">selected</span>.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">first</span>()).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">hero: Hero</span>) =&gt;</span> (selectedHero = hero));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-title function_">click</span>(heroEl); <span class="hljs-comment">// click helper with native element</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(selectedHero).<span class="hljs-title function_">toBe</span>(expectedHero);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">//////////////////</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'DashboardHeroComponent when inside a test host'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">testHost</span>: <span class="hljs-title class_">TestHostComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">fixture</span>: <span class="hljs-title class_">ComponentFixture</span>&lt;<span class="hljs-title class_">TestHostComponent</span>&gt;;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">heroEl</span>: <span class="hljs-title class_">HTMLElement</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-title function_">waitForAsync</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: appProviders,</div><div class="hljs-ln-line">      <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">DashboardHeroComponent</span>, <span class="hljs-title class_">TestHostComponent</span>],</div><div class="hljs-ln-line">    })</div><div class="hljs-ln-line">      .<span class="hljs-title function_">compileComponents</span>();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-comment">// create TestHostComponent instead of DashboardHeroComponent</span></div><div class="hljs-ln-line">    fixture = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">createComponent</span>(<span class="hljs-title class_">TestHostComponent</span>);</div><div class="hljs-ln-line">    testHost = fixture.<span class="hljs-property">componentInstance</span>;</div><div class="hljs-ln-line">    heroEl = fixture.<span class="hljs-property">nativeElement</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.hero'</span>);</div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>(); <span class="hljs-comment">// trigger initial data binding</span></div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should display hero name'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> expectedPipedName = testHost.<span class="hljs-property">hero</span>.<span class="hljs-property">name</span>.<span class="hljs-title function_">toUpperCase</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(heroEl.<span class="hljs-property">textContent</span>).<span class="hljs-title function_">toContain</span>(expectedPipedName);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should raise selected event when clicked'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title function_">click</span>(heroEl);</div><div class="hljs-ln-line">    <span class="hljs-comment">// selected hero should be the same data bound hero</span></div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(testHost.<span class="hljs-property">selectedHero</span>).<span class="hljs-title function_">toBe</span>(testHost.<span class="hljs-property">hero</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">////// Test Host Component //////</span></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Component</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component</span>({</div><div class="hljs-ln-line">  <span class="hljs-attr">standalone</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">DashboardHeroComponent</span>],</div><div class="hljs-ln-line">  <span class="hljs-attr">template</span>: <span class="hljs-string">` &lt;dashboard-hero [hero]="hero" (selected)="onSelected($event)"&gt; &lt;/dashboard-hero&gt;`</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestHostComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-attr">hero</span>: <span class="hljs-title class_">Hero</span> = {<span class="hljs-attr">id</span>: <span class="hljs-number">42</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Test Name'</span>};</div><div class="hljs-ln-line">  <span class="hljs-attr">selectedHero</span>: <span class="hljs-title class_">Hero</span> | <span class="hljs-literal">undefined</span>;</div><div class="hljs-ln-line">  <span class="hljs-title function_">onSelected</span>(<span class="hljs-params">hero: Hero</span>) {</div><div class="hljs-ln-line">    <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedHero</span> = hero;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="961zmv2pji15xvz8ner8oeu5">当某个组件有依赖项时，可能需要使用
<code>TestBed</code>来创建该组件及其依赖项。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1rtb34ecbc7j2f8n4tpfg8w8s">下列的 <code>WelcomeComponent</code> 依赖于 <code>UserService</code> 来了解要问候的用户的名字。</p>

    <div class="docs-alert docs-alert-important">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="570fyuzxp25izohndspbrf549"><strong>重要：</strong> 记得<em>导入</em>或<em>提供</em>你要测试的每个独立组件。</p>

    </div>
    <div class="docs-code" path="adev/src/content/examples/testing/src/app/welcome/welcome.component.ts" visiblelines="8,9,10,11,12,13,14,15,16,17" header="app/welcome/welcome.component.ts">
    <div class="docs-code-header"><h3>app/welcome/welcome.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Component</span>, <span class="hljs-title class_">OnInit</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">UserService</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/user.service'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component</span>({</div><div class="hljs-ln-line">  <span class="hljs-attr">standalone</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-welcome'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">template</span>: <span class="hljs-string">'&lt;h3 class="welcome"&gt;&lt;i&gt;{{welcome}}&lt;/i&gt;&lt;/h3&gt;'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WelcomeComponent</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OnInit</span> {</div><div class="hljs-ln-line">  welcome = <span class="hljs-string">''</span>;</div><div class="hljs-ln-line">  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userService: UserService</span>) {}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">ngOnInit</span>(): <span class="hljs-built_in">void</span> {</div><div class="hljs-ln-line">    <span class="hljs-variable language_">this</span>.<span class="hljs-property">welcome</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userService</span>.<span class="hljs-property">isLoggedIn</span></div><div class="hljs-ln-line">      ? <span class="hljs-string">'Welcome, '</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">userService</span>.<span class="hljs-property">user</span>.<span class="hljs-property">name</span></div><div class="hljs-ln-line">      : <span class="hljs-string">'Please log in.'</span>;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ccfp4r32om1fgidvyc2tou2k">你可以先创建一个能满足本组件最低需求的 <code>UserService</code>。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/welcome/welcome.component.spec.ts" visiblelines="5,6,7,8" header="app/welcome/welcome.component.spec.ts (MockUserService)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="5xycgwhq7uimd6ckp9rc4k0ge">app/welcome/welcome.component.spec.ts（MockUserService）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">ComponentFixture</span>, inject, <span class="hljs-title class_">TestBed</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">UserService</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/user.service'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">WelcomeComponent</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./welcome.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockUserService</span> {</div><div class="hljs-ln-line">  isLoggedIn = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">  user = {<span class="hljs-attr">name</span>: <span class="hljs-string">'Test User'</span>};</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'WelcomeComponent (class only)'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">comp</span>: <span class="hljs-title class_">WelcomeComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userService</span>: <span class="hljs-title class_">UserService</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-comment">// provide the component-under-test and dependent service</span></div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">WelcomeComponent</span>, {<span class="hljs-attr">provide</span>: <span class="hljs-title class_">UserService</span>, <span class="hljs-attr">useClass</span>: <span class="hljs-title class_">MockUserService</span>}],</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line">    <span class="hljs-comment">// inject both the component and the dependent service.</span></div><div class="hljs-ln-line">    comp = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">WelcomeComponent</span>);</div><div class="hljs-ln-line">    userService = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should not have welcome message after construction'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">''</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome logged in user after Angular calls ngOnInit'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    comp.<span class="hljs-title function_">ngOnInit</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toContain</span>(userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should ask user to log in if not logged in after ngOnInit'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">    comp.<span class="hljs-title function_">ngOnInit</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toContain</span>(userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'log in'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'WelcomeComponent'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">comp</span>: <span class="hljs-title class_">WelcomeComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">fixture</span>: <span class="hljs-title class_">ComponentFixture</span>&lt;<span class="hljs-title class_">WelcomeComponent</span>&gt;;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">componentUserService</span>: <span class="hljs-title class_">UserService</span>; <span class="hljs-comment">// the actually injected service</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userService</span>: <span class="hljs-title class_">UserService</span>; <span class="hljs-comment">// the TestBed injected service</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">el</span>: <span class="hljs-title class_">HTMLElement</span>; <span class="hljs-comment">// the DOM element with the welcome message</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userServiceStub</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">UserService</span>&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-comment">// stub UserService for test purposes</span></div><div class="hljs-ln-line">    userServiceStub = {</div><div class="hljs-ln-line">      <span class="hljs-attr">isLoggedIn</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">      <span class="hljs-attr">user</span>: {<span class="hljs-attr">name</span>: <span class="hljs-string">'Test User'</span>},</div><div class="hljs-ln-line">    };</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">WelcomeComponent</span>],</div><div class="hljs-ln-line">      <span class="hljs-comment">// providers: [ UserService ],  // NO! Don't provide the real service!</span></div><div class="hljs-ln-line">      <span class="hljs-comment">// Provide a test-double instead</span></div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: [{<span class="hljs-attr">provide</span>: <span class="hljs-title class_">UserService</span>, <span class="hljs-attr">useValue</span>: userServiceStub}],</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    fixture = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">createComponent</span>(<span class="hljs-title class_">WelcomeComponent</span>);</div><div class="hljs-ln-line">    comp = fixture.<span class="hljs-property">componentInstance</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">// UserService actually injected into the component</span></div><div class="hljs-ln-line">    userService = fixture.<span class="hljs-property">debugElement</span>.<span class="hljs-property">injector</span>.<span class="hljs-title function_">get</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line">    componentUserService = userService;</div><div class="hljs-ln-line">    <span class="hljs-comment">// UserService from the root injector</span></div><div class="hljs-ln-line">    userService = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">//  get the "welcome" element by CSS selector (e.g., by class name)</span></div><div class="hljs-ln-line">    el = fixture.<span class="hljs-property">nativeElement</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.welcome'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome the user'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> content = el.<span class="hljs-property">textContent</span>;</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'"Welcome ..."'</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Welcome'</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'expected name'</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Test User'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome "Bubba"'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bubba'</span>; <span class="hljs-comment">// welcome message hasn't been shown yet</span></div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(el.<span class="hljs-property">textContent</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Bubba'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should request login if not logged in'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// welcome message hasn't been shown yet</span></div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> content = el.<span class="hljs-property">textContent</span>;</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'not welcomed'</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Welcome'</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content)</div><div class="hljs-ln-line">      .<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'"log in"'</span>)</div><div class="hljs-ln-line">      .<span class="hljs-title function_">toMatch</span>(<span class="hljs-regexp">/log in/i</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">"should inject the component's UserService instance"</span>, <span class="hljs-title function_">inject</span>(</div><div class="hljs-ln-line">    [<span class="hljs-title class_">UserService</span>],</div><div class="hljs-ln-line">    <span class="hljs-function">(<span class="hljs-params">service: UserService</span>) =&gt;</span> {</div><div class="hljs-ln-line">      <span class="hljs-title function_">expect</span>(service).<span class="hljs-title function_">toBe</span>(componentUserService);</div><div class="hljs-ln-line">    },</div><div class="hljs-ln-line">  ));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'TestBed and Component UserService should be the same'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(userService).<span class="hljs-title function_">toBe</span>(componentUserService);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="4j2k2ww7g3lxx8uy5zz1y7v5w">然后在 
<code>TestBed</code> 配置中提供并注入 
<strong>组件</strong> 
和<em>服务</em>。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/welcome/welcome.component.spec.ts" visiblelines="14,15,16,17,18,19,20,21,22" header="app/welcome/welcome.component.spec.ts (class-only setup)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="24n7ikwis3hkjunjgpwmjbrcr">app/welcome/welcome.component.spec.ts（仅类设置）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">ComponentFixture</span>, inject, <span class="hljs-title class_">TestBed</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">UserService</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/user.service'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">WelcomeComponent</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./welcome.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockUserService</span> {</div><div class="hljs-ln-line">  isLoggedIn = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">  user = {<span class="hljs-attr">name</span>: <span class="hljs-string">'Test User'</span>};</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'WelcomeComponent (class only)'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">comp</span>: <span class="hljs-title class_">WelcomeComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userService</span>: <span class="hljs-title class_">UserService</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-comment">// provide the component-under-test and dependent service</span></div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">WelcomeComponent</span>, {<span class="hljs-attr">provide</span>: <span class="hljs-title class_">UserService</span>, <span class="hljs-attr">useClass</span>: <span class="hljs-title class_">MockUserService</span>}],</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line">    <span class="hljs-comment">// inject both the component and the dependent service.</span></div><div class="hljs-ln-line">    comp = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">WelcomeComponent</span>);</div><div class="hljs-ln-line">    userService = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should not have welcome message after construction'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">''</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome logged in user after Angular calls ngOnInit'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    comp.<span class="hljs-title function_">ngOnInit</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toContain</span>(userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should ask user to log in if not logged in after ngOnInit'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">    comp.<span class="hljs-title function_">ngOnInit</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toContain</span>(userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'log in'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'WelcomeComponent'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">comp</span>: <span class="hljs-title class_">WelcomeComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">fixture</span>: <span class="hljs-title class_">ComponentFixture</span>&lt;<span class="hljs-title class_">WelcomeComponent</span>&gt;;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">componentUserService</span>: <span class="hljs-title class_">UserService</span>; <span class="hljs-comment">// the actually injected service</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userService</span>: <span class="hljs-title class_">UserService</span>; <span class="hljs-comment">// the TestBed injected service</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">el</span>: <span class="hljs-title class_">HTMLElement</span>; <span class="hljs-comment">// the DOM element with the welcome message</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userServiceStub</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">UserService</span>&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-comment">// stub UserService for test purposes</span></div><div class="hljs-ln-line">    userServiceStub = {</div><div class="hljs-ln-line">      <span class="hljs-attr">isLoggedIn</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">      <span class="hljs-attr">user</span>: {<span class="hljs-attr">name</span>: <span class="hljs-string">'Test User'</span>},</div><div class="hljs-ln-line">    };</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">WelcomeComponent</span>],</div><div class="hljs-ln-line">      <span class="hljs-comment">// providers: [ UserService ],  // NO! Don't provide the real service!</span></div><div class="hljs-ln-line">      <span class="hljs-comment">// Provide a test-double instead</span></div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: [{<span class="hljs-attr">provide</span>: <span class="hljs-title class_">UserService</span>, <span class="hljs-attr">useValue</span>: userServiceStub}],</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    fixture = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">createComponent</span>(<span class="hljs-title class_">WelcomeComponent</span>);</div><div class="hljs-ln-line">    comp = fixture.<span class="hljs-property">componentInstance</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">// UserService actually injected into the component</span></div><div class="hljs-ln-line">    userService = fixture.<span class="hljs-property">debugElement</span>.<span class="hljs-property">injector</span>.<span class="hljs-title function_">get</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line">    componentUserService = userService;</div><div class="hljs-ln-line">    <span class="hljs-comment">// UserService from the root injector</span></div><div class="hljs-ln-line">    userService = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">//  get the "welcome" element by CSS selector (e.g., by class name)</span></div><div class="hljs-ln-line">    el = fixture.<span class="hljs-property">nativeElement</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.welcome'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome the user'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> content = el.<span class="hljs-property">textContent</span>;</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'"Welcome ..."'</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Welcome'</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'expected name'</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Test User'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome "Bubba"'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bubba'</span>; <span class="hljs-comment">// welcome message hasn't been shown yet</span></div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(el.<span class="hljs-property">textContent</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Bubba'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should request login if not logged in'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// welcome message hasn't been shown yet</span></div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> content = el.<span class="hljs-property">textContent</span>;</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'not welcomed'</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Welcome'</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content)</div><div class="hljs-ln-line">      .<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'"log in"'</span>)</div><div class="hljs-ln-line">      .<span class="hljs-title function_">toMatch</span>(<span class="hljs-regexp">/log in/i</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">"should inject the component's UserService instance"</span>, <span class="hljs-title function_">inject</span>(</div><div class="hljs-ln-line">    [<span class="hljs-title class_">UserService</span>],</div><div class="hljs-ln-line">    <span class="hljs-function">(<span class="hljs-params">service: UserService</span>) =&gt;</span> {</div><div class="hljs-ln-line">      <span class="hljs-title function_">expect</span>(service).<span class="hljs-title function_">toBe</span>(componentUserService);</div><div class="hljs-ln-line">    },</div><div class="hljs-ln-line">  ));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'TestBed and Component UserService should be the same'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(userService).<span class="hljs-title function_">toBe</span>(componentUserService);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="bv456rp31th824tgpf5fyl49f">然后练习组件类，记得调用
<a href="guide/components/lifecycle">生命周期钩子方法</a>，就像 Angular 在运行应用时所做的那样。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/welcome/welcome.component.spec.ts" visiblelines="24,25,26,27,28,29,30,31,32,33,34,35,36,37,38" header="app/welcome/welcome.component.spec.ts (class-only tests)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="9vnz0tn0ldfy5rj8b8e3e2fnk">app/welcome/welcome.component.spec.ts（仅类测试）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">ComponentFixture</span>, inject, <span class="hljs-title class_">TestBed</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">UserService</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/user.service'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">WelcomeComponent</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./welcome.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockUserService</span> {</div><div class="hljs-ln-line">  isLoggedIn = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">  user = {<span class="hljs-attr">name</span>: <span class="hljs-string">'Test User'</span>};</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'WelcomeComponent (class only)'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">comp</span>: <span class="hljs-title class_">WelcomeComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userService</span>: <span class="hljs-title class_">UserService</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-comment">// provide the component-under-test and dependent service</span></div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">WelcomeComponent</span>, {<span class="hljs-attr">provide</span>: <span class="hljs-title class_">UserService</span>, <span class="hljs-attr">useClass</span>: <span class="hljs-title class_">MockUserService</span>}],</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line">    <span class="hljs-comment">// inject both the component and the dependent service.</span></div><div class="hljs-ln-line">    comp = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">WelcomeComponent</span>);</div><div class="hljs-ln-line">    userService = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should not have welcome message after construction'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">''</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome logged in user after Angular calls ngOnInit'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    comp.<span class="hljs-title function_">ngOnInit</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toContain</span>(userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should ask user to log in if not logged in after ngOnInit'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">false</span>;</div><div class="hljs-ln-line">    comp.<span class="hljs-title function_">ngOnInit</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toContain</span>(userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(comp.<span class="hljs-property">welcome</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'log in'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'WelcomeComponent'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">comp</span>: <span class="hljs-title class_">WelcomeComponent</span>;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">fixture</span>: <span class="hljs-title class_">ComponentFixture</span>&lt;<span class="hljs-title class_">WelcomeComponent</span>&gt;;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">componentUserService</span>: <span class="hljs-title class_">UserService</span>; <span class="hljs-comment">// the actually injected service</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userService</span>: <span class="hljs-title class_">UserService</span>; <span class="hljs-comment">// the TestBed injected service</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">el</span>: <span class="hljs-title class_">HTMLElement</span>; <span class="hljs-comment">// the DOM element with the welcome message</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> <span class="hljs-attr">userServiceStub</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">UserService</span>&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-comment">// stub UserService for test purposes</span></div><div class="hljs-ln-line">    userServiceStub = {</div><div class="hljs-ln-line">      <span class="hljs-attr">isLoggedIn</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">      <span class="hljs-attr">user</span>: {<span class="hljs-attr">name</span>: <span class="hljs-string">'Test User'</span>},</div><div class="hljs-ln-line">    };</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">configureTestingModule</span>({</div><div class="hljs-ln-line">      <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">WelcomeComponent</span>],</div><div class="hljs-ln-line">      <span class="hljs-comment">// providers: [ UserService ],  // NO! Don't provide the real service!</span></div><div class="hljs-ln-line">      <span class="hljs-comment">// Provide a test-double instead</span></div><div class="hljs-ln-line">      <span class="hljs-attr">providers</span>: [{<span class="hljs-attr">provide</span>: <span class="hljs-title class_">UserService</span>, <span class="hljs-attr">useValue</span>: userServiceStub}],</div><div class="hljs-ln-line">    });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    fixture = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">createComponent</span>(<span class="hljs-title class_">WelcomeComponent</span>);</div><div class="hljs-ln-line">    comp = fixture.<span class="hljs-property">componentInstance</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">// UserService actually injected into the component</span></div><div class="hljs-ln-line">    userService = fixture.<span class="hljs-property">debugElement</span>.<span class="hljs-property">injector</span>.<span class="hljs-title function_">get</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line">    componentUserService = userService;</div><div class="hljs-ln-line">    <span class="hljs-comment">// UserService from the root injector</span></div><div class="hljs-ln-line">    userService = <span class="hljs-title class_">TestBed</span>.<span class="hljs-title function_">inject</span>(<span class="hljs-title class_">UserService</span>);</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment">//  get the "welcome" element by CSS selector (e.g., by class name)</span></div><div class="hljs-ln-line">    el = fixture.<span class="hljs-property">nativeElement</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.welcome'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome the user'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> content = el.<span class="hljs-property">textContent</span>;</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'"Welcome ..."'</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Welcome'</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'expected name'</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Test User'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should welcome "Bubba"'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">user</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bubba'</span>; <span class="hljs-comment">// welcome message hasn't been shown yet</span></div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(el.<span class="hljs-property">textContent</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Bubba'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'should request login if not logged in'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    userService.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// welcome message hasn't been shown yet</span></div><div class="hljs-ln-line">    fixture.<span class="hljs-title function_">detectChanges</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> content = el.<span class="hljs-property">textContent</span>;</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content).<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'not welcomed'</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toContain</span>(<span class="hljs-string">'Welcome'</span>);</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(content)</div><div class="hljs-ln-line">      .<span class="hljs-title function_">withContext</span>(<span class="hljs-string">'"log in"'</span>)</div><div class="hljs-ln-line">      .<span class="hljs-title function_">toMatch</span>(<span class="hljs-regexp">/log in/i</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">"should inject the component's UserService instance"</span>, <span class="hljs-title function_">inject</span>(</div><div class="hljs-ln-line">    [<span class="hljs-title class_">UserService</span>],</div><div class="hljs-ln-line">    <span class="hljs-function">(<span class="hljs-params">service: UserService</span>) =&gt;</span> {</div><div class="hljs-ln-line">      <span class="hljs-title function_">expect</span>(service).<span class="hljs-title function_">toBe</span>(componentUserService);</div><div class="hljs-ln-line">    },</div><div class="hljs-ln-line">  ));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">it</span>(<span class="hljs-string">'TestBed and Component UserService should be the same'</span>, <span class="hljs-function">() =&gt;</span> {</div><div class="hljs-ln-line">    <span class="hljs-title function_">expect</span>(userService).<span class="hljs-title function_">toBe</span>(componentUserService);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h2 id="component-dom-testing">
    <a href="#component-dom-testing" class="docs-anchor" tabindex="-1" aria-label="Link to Component DOM testing" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="70g2i691nvigupf7srh5fhk89">组件 DOM 测试</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="3hpsy3mkd2dmtfj8trv9jw56h">测试组件
<em>类</em>和
<a href="guide/testing/services">测试服务</a>一样简单。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="5qbkmwg82qn2bs7qg90w3we0n">但组件不仅仅是它的类。组件还会与 DOM 以及其他组件进行交互。<em>只对类</em>的测试可以告诉你类的行为。但它们无法告诉你这个组件是否能正确渲染、响应用户输入和手势，或是集成到它的父组件和子组件中。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6fi89fhviuu0pwx4m6wlrfc62">以上所有<em>只对类</em>的测试都不能回答有关组件会如何在屏幕上实际运行方面的关键问题。</p>

  <ul class="docs-list">
    <li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="73w7vxvfnpp6yk1evgc1l3t7f"><code>Lightswitch.clicked()</code> 绑定到了什么？用户可以调用它吗？</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="axl3vwfz8cwkm3kbqyr6yeit7"><code>Lightswitch.message</code> 是否显示过？</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4y8rxjurpc93i1uhdh8xzd36k">用户能否真正选中由 <code>DashboardHeroComponent</code> 显示的英雄？</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="77g0zx725s2lfh2ixnwcawvh0">英雄名字是否按预期显示的（比如大写字母）？</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="cvfaj0g6zqkq76rhdzj3mxzlk"><code>WelcomeComponent</code> 的模板是否显示了欢迎信息？</li>

  </ul>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="cd92u27cblgx5gh3oj76us2j4">对于上面描述的那些简单组件来说，这些问题可能并不麻烦。但是很多组件都与模板中描述的 DOM 元素进行了复杂的交互，导致一些 HTML 会在组件状态发生变化时出现和消失。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="2xp9wkjp8ovksrnepn43991ub">要回答这些问题，你必须创建与组件关联的 DOM 元素，你必须检查 DOM 以确认组件状态是否在适当的时候正确显示了，并且你必须模拟用户与屏幕的交互以确定这些交互是否正确。判断该组件的行为是否符合预期。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="czs84j7rbjc384jmoythvrvna">要编写这类测试，你将使用
<code>TestBed</code>的附加特性以及其他测试辅助函数。</p>

  <h3 id="cli-generated-tests">
    <a href="#cli-generated-tests" class="docs-anchor" tabindex="-1" aria-label="Link to CLI-generated tests" data-ng_translator_product="100" data-ng_translator_ref_id="7ggwzep26szniu0e8orm299yt">CLI 生成的测试</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="cs81hi4353zo6pske1n69b3t8">当你要求 CLI 生成一个新组件时，它会默认为你创建一个初始的测试文件。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="89e94zxyg5oz680f450ycvpi9">比如，下列 CLI 命令会在 <code>app/banner</code> 文件夹中生成带有内联模板和内联样式的 <code>BannerComponent</code>：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">ng generate component banner --inline-template --inline-style --module app</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="xy4shtzzakrlaoe8tjov12jb">它还会生成一个初始测试文件 <code>banner-external.component.spec.ts</code>，如下所示：</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="1,2,7,8,9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28" header="app/banner/banner-external.component.spec.ts (initial)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="d7ocd0hbj1qf1dr5mrer7vj61">app/banner/banner-external.component.spec.ts（初始）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
    <div class="docs-alert docs-alert-helpful">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="4sxjvqy0wxgownk9gmer9f7d6"><strong>提示：</strong>因为
<code>compileComponents</code>是异步的，它使用从
<code>@angular/core/testing</code>导入的
<a href="api/core/testing/waitForAsync"><code>waitForAsync</code></a>实用函数。</p>

    </div>
    <p data-ng_translator_product="100" data-ng_translator_ref_id="4l9100z81lsbjqf77lrlpeabl">请参考
<a href="guide/testing/components-scenarios#waitForAsync">waitForAsync</a>部分以获取更多详情。</p>

  <h3 id="reduce-the-setup">
    <a href="#reduce-the-setup" class="docs-anchor" tabindex="-1" aria-label="Link to Reduce the setup" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bo74wdz8ezfm08tkg4nv6wv4x">减少设置代码</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="35fiq4uq9pjv35xg7rip3qwo4">只有这个文件的最后三行才是真正测试组件的，并且所有这些都断言了 Angular 可以创建该组件。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="cb73anqme9w4qio8k0x1j7ijy">该文件的其它部分是做设置用的样板代码，<em>可以</em>预见，如果组件演变得更具实质性内容，就会需要更高级的测试。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ax3zhdmrntc1txk8t1j23dkpx">下面你将学习这些高级测试特性。现在，你可以从根本上把这个测试文件减少到一个更容易管理的大小：</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="30,31,32,33,34,35,36,37" header="app/banner/banner-initial.component.spec.ts (minimal)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="etym2913aamv5oqqj92vegcz9">app/banner/banner-initial.component.spec.ts（最小化）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="esd9r4lur7i52hmwayhe7vixz">在这个例子中，传给 <code>TestBed.configureTestingModule</code> 的元数据对象只是声明了要测试的组件 <code>BannerComponent</code>。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="32">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
    <div class="docs-alert docs-alert-helpful">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="3raktm7t8xhu58yh0ccle72d7"><strong>提示：</strong>无需声明或导入其他内容。默认测试模块已预配置了类似
<code>@angular/platform-browser</code>中的
<code>BrowserModule</code>。</p>

    </div>
    <p data-ng_translator_product="100" data-ng_translator_ref_id="27hcbnrfs3dd6ka7gp6twa07m">稍后你会调用 
<code>TestBed.configureTestingModule()</code>，包含导入、提供者和更多声明来满足你的测试需求。 可选的 
<code>override</code> 方法可以进一步微调配置的各个方面。</p>

  <h3 id="createcomponent">
    <a href="#createcomponent" class="docs-anchor" tabindex="-1" aria-label="Link to <code>createComponent()</code>"><code>createComponent()</code></a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="ekwctrijhta73qf6jvk42ql2s">配置好 
<code>TestBed</code> 后，你需要调用它的 
<code>createComponent()</code> 方法。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="33">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="e3gsc4pqtvyawrw0o29nlzwxd"><code>TestBed.createComponent()</code> 会创建一个 
<code>BannerComponent</code> 的实例，向测试运行器的 DOM 中添加一个相应的元素，并返回一个 
<a href="#component-fixture"><code>ComponentFixture</code></a>。</p>

    <div class="docs-alert docs-alert-important">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="be1sl4xj63wxykrsqnq8twy0l"><strong>重要提示：</strong> 在调用 
<code>createComponent</code> 之后不要重新配置 
<code>TestBed</code>。</p>

    </div>
    <p data-ng_translator_product="100" data-ng_translator_ref_id="4bx4jgg6w1tizjihasv19akrh">此 
<code>createComponent</code> 方法会冻结当前的 
<code>TestBed</code> 定义，关闭进一步的配置。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="co0m85f52l5uk3sf9xf4fkvum">你不能再调用任何 
<code>TestBed</code> 配置方法，包括 
<code>configureTestingModule()</code>、
<code>get()</code> 或任何 
<code>override...</code> 方法。如果尝试这样做，
<code>TestBed</code> 会抛出一个错误。</p>

  <h3 id="componentfixture">
    <a href="#componentfixture" class="docs-anchor" tabindex="-1" aria-label="Link to <code>ComponentFixture</code>"><code>ComponentFixture</code></a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="dig5ymr73jnuf7e0k1qwzxf1d"><a href="api/core/testing/ComponentFixture">ComponentFixture</a> 是一个测试挽具，用于与所创建的组件及其对应的元素进行交互。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8tfo3tt1yc21309e4zsvzf1t5">可以通过测试夹具（fixture）访问组件实例，并用 Jasmine 的期望断言来确认它是否存在：</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="34,35">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h3 id="beforeeach">
    <a href="#beforeeach" class="docs-anchor" tabindex="-1" aria-label="Link to <code>beforeEach()</code>"><code>beforeEach()</code></a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="a68d1ilknd3a89ggqx0h75jol">你会在组件演变过程中添加更多测试。为了避免为每个测试重复 
<code>TestBed</code> 配置，你会重构代码，将设置部分移到 Jasmine 的 
<code>beforeEach()</code> 中，并使用一些支持变量：</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="39,40,41,42,43,44,45,46,47,48,49,50,51,77">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7143avsqkd05k0bemxhs1utw0">现在添加一个测试程序，它从 <code>fixture.nativeElement</code> 中获取组件的元素，并查找预期的文本。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="53,54,55,56">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h3 id="nativeelement">
    <a href="#nativeelement" class="docs-anchor" tabindex="-1" aria-label="Link to <code>nativeElement</code>"><code>nativeElement</code></a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="djo5u7w9vfmkuuq7zz8srowhq"><code>ComponentFixture.nativeElement</code> 的值类型为 
<code>any</code>。稍后你会遇到 
<code>DebugElement.nativeElement</code>，它的类型也是 
<code>any</code>。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="6g7q7tpdtw8e8zziszas7dmrx">Angular 无法在编译时知道 
<code>nativeElement</code> 是什么类型的 HTML 元素，甚至不确定它是否为 HTML 元素。应用可能运行在某个 
<em>非浏览器平台</em>，如服务器或 
<a href="https://developer.mozilla.org/docs/Web/API/Web_Workers_API" target="_blank">Web Worker</a>，在这些平台上，该元素可能具有简化的 API 或根本不存在。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3wgfnpyhwa1uiejdlf69n0pm">本指南中的测试都是为了在浏览器中运行而设计的，因此 <code>nativeElement</code> 的值始终是 <code>HTMLElement</code> 或其派生类之一。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="92vp6ce333fjvrz61can7amzt">知道了它是某种 <code>HTMLElement</code>，就可以用标准的 HTML <code>querySelector</code> 深入了解元素树。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="687nn2akmvlqrgu5ynqsjkpk2">这是另一个调用 <code>HTMLElement.querySelector</code> 来获取段落元素并查找横幅文本的测试：</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="58,59,60,61,62">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h3 id="debugelement">
    <a href="#debugelement" class="docs-anchor" tabindex="-1" aria-label="Link to <code>DebugElement</code>"><code>DebugElement</code></a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="5efr4jb411njcd7b8q08aocjy">Angular 的<em>测试夹具</em>可以直接通过 <code>fixture.nativeElement</code> 提供组件的元素。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="59">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4fgzr3iaarpttuqgv9kc04k1k">它实际上是一个便利方法，其最终实现为 <code>fixture.debugElement.nativeElement</code>。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="65,66">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8afwu9ff9dw5styosdyhz564b">使用这种迂回的路径访问元素是有充分理由的。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="er7oleoortz5bcve1tv7ha596"><code>nativeElement</code> 的属性依赖于其运行时环境。你可以在<em>非浏览器</em>平台上运行这些测试，那些平台上可能没有 DOM，或者其模拟的 DOM 不支持完整的 <code>HTMLElement</code> API。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="e3tvief12ofnzsnfnsysv40dt">Angular 依赖 
<code>DebugElement</code> 抽象来跨 
<em>所有支持的平台</em> 安全工作。Angular 不创建 HTML 元素树，而是创建一个包裹运行时平台 
<em>本地元素</em> 的 
<code>DebugElement</code> 树。
<code>nativeElement</code> 属性会解包 
<code>DebugElement</code> 并返回平台特定的元素对象。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6r6747eeb8qayewg4433v4bm2">由于本指南的范例测试只能在浏览器中运行，因此 <code>nativeElement</code> 在这些测试中始终是 <code>HTMLElement</code>，你可以在测试中探索熟悉的方法和属性。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="128gs1509mvvu9rxcrpvup39b">下面是把前述测试用 <code>fixture.debugElement.nativeElement</code> 重新实现的版本：</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="64,65,66,67,68,69">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="aszidhd1ufaiiqxg4dxons22w"><code>DebugElement</code> 还有其他在测试中有用的方法和属性，你会在本指南的其他地方看到。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="62xvwwgcjyitjdt53gwmyzrl3">你可以从 Angular 核心库中导入 
<code>DebugElement</code> 符号。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="0">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h3 id="bycss">
    <a href="#bycss" class="docs-anchor" tabindex="-1" aria-label="Link to <code>By.css()</code>"><code>By.css()</code></a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ccgqecipy0wcabvdjom8cw1fa">虽然本指南中的测试都是在浏览器中运行的，但有些应用可能至少要在某些时候运行在不同的平台上。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="d3b5e5ph4bhq5gzmvkt4rrtr9">比如，作为优化策略的一部分，该组件可能会首先在服务端渲染，以便在连接不良的设备上更快地启动本应用。服务端渲染器可能不支持完整的 HTML 元素 API。如果它不支持 <code>querySelector</code>，之前的测试就会失败。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="3aset564qbls0wheks69iejws"><code>DebugElement</code> 提供在所有支持平台上工作的查询方法。这些查询方法接受一个 
<em>谓词</em> 函数，当 
<code>DebugElement</code> 树中的节点匹配选择标准时，该函数返回 
<code>true</code>。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="ayivx2gbe6d00rdiirjjpofnl">你可以借助 
<code>By</code> 类创建一个 
<em>谓词</em>，该类从某个运行时平台的库中导入。以下是浏览器平台的 
<code>By</code> 导入：</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="3">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="cg0bs7qxympn6ezt83afge72t">下面的示例使用 
<code>DebugElement.query()</code> 和浏览器的 
<code>By.css</code> 方法重新实现了前面的测试。</p>
<div class="docs-code" path="adev/src/content/examples/testing/src/app/banner/banner-initial.component.spec.ts" visiblelines="71,72,73,74,75,76">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {DebugElement} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ComponentFixture, TestBed, waitForAsync} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core/testing'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {By} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {BannerComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'./banner-initial.component'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line">import { BannerComponent } from './banner.component';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe('BannerComponent', () =&gt; {</div><div class="hljs-ln-line">*/</div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (initial CLI generated)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(waitForAsync(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]}).compileComponents();</div><div class="hljs-ln-line">  }));</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">    fixture.detectChanges();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (minimal)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> component = fixture.componentInstance;</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">describe(<span class="hljs-string">'BannerComponent (with beforeEach)'</span>, () =&gt; {</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> component: BannerComponent;</div><div class="hljs-ln-line">  <span class="hljs-keyword">let</span> fixture: ComponentFixture&lt;BannerComponent&gt;;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  beforeEach(() =&gt; {</div><div class="hljs-ln-line">    TestBed.configureTestingModule({imports: [BannerComponent]});</div><div class="hljs-ln-line">    fixture = TestBed.createComponent(BannerComponent);</div><div class="hljs-ln-line">    component = fixture.componentInstance;</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should create'</span>, () =&gt; {</div><div class="hljs-ln-line">    expect(component).toBeDefined();</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should contain "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    expect(bannerElement.textContent).toContain(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should have &lt;p&gt; with "banner works!"'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerElement: HTMLElement = fixture.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerElement.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.nativeElement)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerEl: HTMLElement = bannerDe.nativeElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p = bannerEl.querySelector(<span class="hljs-string">'p'</span>)!;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-literal">it</span>(<span class="hljs-string">'should find the &lt;p&gt; with fixture.debugElement.query(By.css)'</span>, () =&gt; {</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> bannerDe: DebugElement = fixture.debugElement;</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> paragraphDe = bannerDe.query(By.css(<span class="hljs-string">'p'</span>));</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> p: HTMLElement = paragraphDe.nativeElement;</div><div class="hljs-ln-line">    expect(p.textContent).toEqual(<span class="hljs-string">'banner works!'</span>);</div><div class="hljs-ln-line">  });</div><div class="hljs-ln-line">});</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="f1nt5wwy7nvckrhsnx387q2o0">一些值得注意的地方：</p>

  <ul class="docs-list">
    <li data-ng_translator_product="100" data-ng_translator_ref_id="2dvzq93agyw7091za6rngud0l"><code>By.css()</code> 静态方法使用 
<a href="https://developer.mozilla.org/docs/Learn/CSS/Building_blocks/Selectors" title="CSS" selectors target="_blank">标准 CSS 选择器</a> 选择 
<code>DebugElement</code> 节点。</li>
<li data-ng_translator_product="100" data-ng_translator_ref_id="93mw4i2gikyf0iu31wvuy2gre">查询返回段落的 
<code>DebugElement</code>。</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="dyollt7kyn2tib0qmq9m44ei4">你必须解包那个结果才能得到 p 元素。</li>

  </ul>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6f5w2x9g6biuokpomso915o1c">当你使用 CSS 选择器进行过滤并且只测试浏览器<em>原生元素</em>的属性时，用 <code>By.css</code> 方法可能会有点过度。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="tpbrnucyggwtrus72wg0qlrw">用 <code>HTMLElement</code> 方法（比如 <code>querySelector()</code> 或 <code>querySelectorAll()</code>）进行过滤通常更简单，更清晰。</p>
