<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bzzyzrlgoh0dsi6ih4hbx3f0o">找出你要测试多少代码</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/testing/code-coverage.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ezsj57y9jluw9zcsy6k2ep0z">CLI 可以运行单元测试并创建代码覆盖率报告。代码覆盖率报告会向你展示代码库中可能无法通过单元测试进行正确测试的任意部位。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6dy7h465zj8rug2v3othq93lu">要生成覆盖率报告，请在项目的根目录下运行以下命令。</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">ng test --no-watch --code-coverage</div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8uo5e9vxp3954ga1pbdxr5a8">测试完成后，该命令会在项目中创建一个 <code>/coverage</code> 目录。打开 <code>index.html</code> 文件，可以查看带有源代码和代码覆盖率值的报表。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="b6jvldm0dy9bky5ag0ew4wlmj">如果要在每次测试时都创建代码覆盖率报告，可以在 CLI 配置文件 <code>angular.json</code> 中设置以下选项：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></div><div class="hljs-ln-line">  <span class="hljs-attr">"options"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></div><div class="hljs-ln-line">    <span class="hljs-attr">"codeCoverage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></div><div class="hljs-ln-line">  <span class="hljs-punctuation">}</span></div><div class="hljs-ln-line"><span class="hljs-punctuation">}</span></div></code>
    </pre>
  </div>
  <h2 id="code-coverage-enforcement">
    <a href="#code-coverage-enforcement" class="docs-anchor" tabindex="-1" aria-label="Link to Code coverage enforcement" data-ng_translator_product="100" data-ng_translator_ref_id="5p4gxh94oylm1v29m7jeawnra">强制要求代码覆盖率</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="e709mnkttbflj5f8ktfmy4t4u">代码覆盖率可以让你估算出你的代码测试了多少。如果你的团队确定要设置单元测试的最小覆盖率，可以使用 Angular CLI 来强制实施这个最低要求。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="690a3df5oz5mtwh8db91nxway">例如，假设你希望代码库的代码覆盖率至少达到 80%。 要实现这一点，请打开 
<a href="https://karma-runner.github.io" target="_blank">Karma</a> 测试平台配置文件 
<code>karma.conf.js</code>，并在 
<code>coverageReporter:</code> 键中添加 
<code>check</code> 属性。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-attr">coverageReporter</span>: {</div><div class="hljs-ln-line">  <span class="hljs-attr">dir</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>).<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">'./coverage/&lt;project-name&gt;'</span>),</div><div class="hljs-ln-line">  <span class="hljs-attr">subdir</span>: <span class="hljs-string">'.'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">reporters</span>: [</div><div class="hljs-ln-line">    { <span class="hljs-attr">type</span>: <span class="hljs-string">'html'</span> },</div><div class="hljs-ln-line">    { <span class="hljs-attr">type</span>: <span class="hljs-string">'text-summary'</span> }</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">  <span class="hljs-attr">check</span>: {</div><div class="hljs-ln-line">    <span class="hljs-attr">global</span>: {</div><div class="hljs-ln-line">      <span class="hljs-attr">statements</span>: <span class="hljs-number">80</span>,</div><div class="hljs-ln-line">      <span class="hljs-attr">branches</span>: <span class="hljs-number">80</span>,</div><div class="hljs-ln-line">      <span class="hljs-attr">functions</span>: <span class="hljs-number">80</span>,</div><div class="hljs-ln-line">      <span class="hljs-attr">lines</span>: <span class="hljs-number">80</span></div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div></code>
    </pre>
  </div>
    <div class="docs-alert docs-alert-helpful">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="eqh1r3i6u7y886lnnx7tc2b21"><strong>提示：</strong> 阅读更多关于创建和微调 Karma 配置的信息，请参见 
<a href="guide/testing#configuration">测试指南</a>。</p>

    </div>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ctm3rt15daxll4pgu7o9zet8y"><code>check</code> 属性会让该工具在项目中运行单元测试时强制要求至少 80％的代码覆盖率。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="x92jzudaqog3mkiuo0dh7mgi">更多关于覆盖率配置选项的信息，请参见 
<a href="https://github.com/karma-runner/karma-coverage/blob/master/docs/configuration.md" target="_blank">karma 覆盖率文档</a>。</p>
