<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8h9nq1h7xgyv428lndzt1rmdo">复杂动画序列</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/animations/complex-sequences.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8vf5no835n2v51cbaeultmhxp">到目前为止，我们已经学过了单个 HTML 元素的简单动画。Angular 还允许你在进入和离开页面时播放 "动画协调序列"，比如当整个网格或元素列表进入或离开页面时，多个条目的动画之间需要彼此协调时间。你可以选择并行执行多个动画，或者按顺序逐个运行离散动画。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7ni8fc03en2kgqcm9bx2iefhh">用来控制复杂动画序列的函数如下：</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="dt2uvbdl3r7k4tmkiulzt8lb8">函数</th>
<th align="left" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3prlgfrx5eo2xqncnnob4crxu">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left"><code>query()</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="714wxnnqgch7206c2p29qxmz6">查找一个或多个内部HTML元素。</td>
</tr>
<tr>
<td align="left"><code>stagger()</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="b77cycb4t1f4z8uvk1qhs9d31">为多个元素应用级联延迟动画。</td>
</tr>
<tr>
<td align="left"><a href="api/animations/group"><code>group()</code></a></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="bamd5dhig4dlncjrahdifra2h">并行运行多个动画步骤。</td>
</tr>
<tr>
<td align="left"><code>sequence()</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="80bu7pu844my73fvn6xu2y5ss">依次运行动画步骤。</td>
</tr>

      </tbody>
    </table>
  </div>
  
  <h2 id="the-query-function">
    <a href="#the-query-function" class="docs-anchor" tabindex="-1" aria-label="Link to The query() function" data-ng_translator_product="100" data-ng_translator_ref_id="bs1ymiunfxx4sbm87j7g6x2h2">query() 函数</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="9boivi8k5x43ww3xmzleqfgfk">大多数复杂动画都依赖于 
<code>query()</code> 函数来查找子元素并对其应用动画，这样的基本示例如下：</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left" data-ng_translator_product="100" data-ng_translator_ref_id="f4iecnoqh39op5dvxqr6b3gip">例子</th>
<th align="left" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3prlgfrx5eo2xqncnnob4crxu">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="bggmmascycjcl599h1u5hziw6"><code>query()</code> 后跟 
<code>animate()</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="rkj186haqcos5dn5e4p2dpub">用于查询简单的HTML元素并直接对其应用动画。</td>
</tr>
<tr>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="cbb5lnd3edm13udgru97t4auj"><code>query()</code> 后跟 
<code>animateChild()</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="a7g5ch0cso6pmnm0ev41dwpi5">用于查询子元素，这些子元素本身具有应用于它们的动画元数据，并触发这种动画（否则当前/父元素的动画将阻止该动画）。</td>
</tr>

      </tbody>
    </table>
  </div>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="eukc8kbg0nzwpewc8wik5dkrt"><code>query()</code> 的第一个参数是一个
<a href="https://developer.mozilla.org/docs/Web/CSS/CSS_Selectors" target="_blank">css 选择器</a> 字符串，其中还可以包含以下 Angular 特定的标记：</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left" data-ng_translator_product="100" data-ng_translator_ref_id="elev8izsbicr4x4j0jytnbbhp">标记</th>
<th align="left" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3prlgfrx5eo2xqncnnob4crxu">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="barnuidmu3zr5n0kgyqroldks"><code>:enter</code> 
<br> 
<code>:leave</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="bcwav0f8iztnp9d54h9a6yqpk">用于进入/离开元素。</td>
</tr>
<tr>
<td align="left"><code>:animating</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="1ncy7hzc7xrcgxn3kgzbmwgpr">用于当前正在进行动画的元素。</td>
</tr>
<tr>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="69fu9m7p5947ghe07ow43t4gl"><code>@*</code> 
<br> 
<code>@triggerName</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="27ox9ixhjfgaqcvg1751hf6fv">用于具有任意（或特定）触发器的元素。</td>
</tr>
<tr>
<td align="left"><code>:self</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="7iamzrgl2lr0o7hn3oukae5zi">动画元素本身。</td>
</tr>

      </tbody>
    </table>
  </div>
  
    <div class="docs-callout docs-callout-helpful">
      <h3 data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ds6gyfeyxlutmtruft5xx1szy">进入和离开元素</h3>
      <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4g2q3g7mz2p71dhlh57xhcrvd">并非所有子元素都会实际上被认为是进入/离开；有时，这可能是违反直觉和令人困惑的。有关更多信息，参阅 <a href="api/animations/query#entering-and-leaving-elements">query api 的文档</a>。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="diae8b0t873kjskqa6ahefhf7">你也可以在动画示例中看到这一点（在动画 
<a href="guide/animations#about-this-guide">介绍部分</a>中），在查询选项卡下。</p>

    </div>
    
  <h2 id="animate-multiple-elements-using-query-and-stagger-functions">
    <a href="#animate-multiple-elements-using-query-and-stagger-functions" class="docs-anchor" tabindex="-1" aria-label="Link to Animate multiple elements using query() and stagger() functions" data-ng_translator_product="100" data-ng_translator_ref_id="1q29g72qdf3wzn0vzx8mb1uwt">使用 query() 和 stagger() 函数动画多个元素</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="c3o77f1teuxgzkbbm060m29as">通过 
<code>query()</code> 查询子元素之后，
<code>stagger()</code> 函数让你可以定义每个查询到的要进行动画的条目之间的时间间隔，从而在这些元素之间添加延迟来进行动画。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="3ccerrnhwvegnmr8lhs7payj6">以下示例演示了如何使用 
<code>query()</code> 和 
<code>stagger()</code> 函数来按顺序动画列表（英雄列表），从顶部到底部逐个添加，带有轻微延迟。</p>

  <ul class="docs-list">
    <li><p data-ng_translator_product="100" data-ng_translator_ref_id="2vpa3jzloi6jwv8iqfio6136m">使用 
<code>query()</code> 查找进入页面且符合特定条件的元素</p>
</li>
<li><p data-ng_translator_product="100" data-ng_translator_ref_id="548wep3htnyvomk2kxrhllp62">对于每个元素，使用 
<code>style()</code> 设置元素相同的初始样式。 使其透明并使用 
<code>transform</code> 将其移出位置，以便它可以滑入到正确位置。</p>
</li>
<li><p data-ng_translator_product="100" data-ng_translator_ref_id="cynpvnk0bmnppe9bdohyvb3ey">使用 
<code>stagger()</code> 每个动画之间延迟 30 毫秒</p>
</li>
<li><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="baw7hvsathps6zgso2t04mfa2">对屏幕上的每个元素，根据一条自定义缓动曲线播放 0.5 秒的动画，同时将其淡入，而且逐步取消以前的位移效果</p>
</li>

  </ul>
  <div class="docs-code" path="adev/src/content/examples/animations/src/app/hero-list-page.component.ts" visiblelines="12,13,14,15,16,17,18,19,20,21,22" header="src/app/hero-list-page.component.ts">
    <div class="docs-code-header"><h3>src/app/hero-list-page.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Component, HostBinding, OnInit} from <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {trigger, transition, animate, style, query, stagger} from <span class="hljs-string">'@angular/animations'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {HEROES} from <span class="hljs-string">'./mock-heroes'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Hero} from <span class="hljs-string">'./hero'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {NgFor} from <span class="hljs-string">'@angular/common'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  imports: [NgFor],</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'app-hero-list-page'</span>,</div><div class="hljs-ln-line">  templateUrl: <span class="hljs-string">'hero-list-page.component.html'</span>,</div><div class="hljs-ln-line">  styleUrls: [<span class="hljs-string">'hero-list-page.component.css'</span>],</div><div class="hljs-ln-line">  animations: [</div><div class="hljs-ln-line">    trigger(<span class="hljs-string">'pageAnimations'</span>, [</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':enter'</span>, [</div><div class="hljs-ln-line">        query(<span class="hljs-string">'.hero'</span>, [</div><div class="hljs-ln-line">          style({opacity: 0, transform: <span class="hljs-string">'translateY(-100px)'</span>}),</div><div class="hljs-ln-line">          stagger(30, [</div><div class="hljs-ln-line">            animate(<span class="hljs-string">'500ms cubic-bezier(0.35, 0, 0.25, 1)'</span>, style({opacity: 1, transform: <span class="hljs-string">'none'</span>})),</div><div class="hljs-ln-line">          ]),</div><div class="hljs-ln-line">        ]),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">    ]),</div><div class="hljs-ln-line">    trigger(<span class="hljs-string">'filterAnimation'</span>, [</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':enter, * =&gt; 0, * =&gt; -1'</span>, []),</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':increment'</span>, [</div><div class="hljs-ln-line">        query(</div><div class="hljs-ln-line">          <span class="hljs-string">':enter'</span>,</div><div class="hljs-ln-line">          [</div><div class="hljs-ln-line">            style({opacity: 0, width: 0}),</div><div class="hljs-ln-line">            stagger(50, [animate(<span class="hljs-string">'300ms ease-out'</span>, style({opacity: 1, width: <span class="hljs-string">'*'</span>}))]),</div><div class="hljs-ln-line">          ],</div><div class="hljs-ln-line">          {optional: true},</div><div class="hljs-ln-line">        ),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':decrement'</span>, [</div><div class="hljs-ln-line">        query(<span class="hljs-string">':leave'</span>, [stagger(50, [animate(<span class="hljs-string">'300ms ease-out'</span>, style({opacity: 0, width: 0}))])]),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">    ]),</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeroListPageComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@HostBinding(<span class="hljs-string">'@pageAnimations'</span>)</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">public</span> animatePage = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  heroesTotal = -<span class="hljs-number">1</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-keyword">get</span> heroes() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._heroes;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">  <span class="hljs-keyword">private</span> _heroes: Hero[] = [];</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnInit() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>._heroes = HEROES;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  updateCriteria(criteria: string) {</div><div class="hljs-ln-line">    criteria = criteria ? criteria.trim() : <span class="hljs-string">''</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>._heroes = HEROES.filter((hero) =&gt;</div><div class="hljs-ln-line">      hero.name.toLowerCase().includes(criteria.toLowerCase()),</div><div class="hljs-ln-line">    );</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> newTotal = <span class="hljs-keyword">this</span>.heroes.length;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.heroesTotal !== newTotal) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">this</span>.heroesTotal = newTotal;</div><div class="hljs-ln-line">    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!criteria) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">this</span>.heroesTotal = -<span class="hljs-number">1</span>;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h2 id="parallel-animation-using-group-function">
    <a href="#parallel-animation-using-group-function" class="docs-anchor" tabindex="-1" aria-label="Link to Parallel animation using group() function" data-ng_translator_product="100" data-ng_translator_ref_id="1lbz19oqu76rh9bd9auwumt6l">使用 group() 函数进行并行动画</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="81njwco46eqin6cjpyrnxkiph">你已经了解了如何在两个连续的动画之间添加延迟。不过你可能还想配置一些并行的动画。比如，你可能希望为同一个元素的两个 CSS 属性设置动画，但要为每个属性使用不同的 <code>easing</code> 函数。这时，你可以使用动画函数 <a href="api/animations/group"><code>group()</code></a>。</p>

    <div class="docs-alert docs-alert-helpful">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="bwklea7tpa9oanw962xnr6blu"><strong>有用：</strong> 
<a href="api/animations/group"><code>group()</code></a> 函数用于对动画 
<em>步骤</em> 进行分组，而不是对动画元素进行分组。</p>

    </div>
    <p data-ng_translator_product="100" data-ng_translator_ref_id="e0s0y04jcerlshrc4e3nxn2wf">以下示例在 
<code>:enter</code> 和 
<code>:leave</code> 上使用了
<a href="api/animations/group"><code>group()</code></a>，针对两种不同的时序配置，因此对同一元素并行应用了两个独立的动画。</p>
<div class="docs-code" path="adev/src/content/examples/animations/src/app/hero-list-groups.component.ts" visiblelines="23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69" header="src/app/hero-list-groups.component.ts (excerpt)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="8e3o4q2ur997hkaa0z48e39js">src/app/hero-list-groups.component.ts（摘录）</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Component, Input, Output, EventEmitter} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {trigger, state, style, animate, transition, group} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/animations'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Hero} <span class="hljs-keyword">from</span> <span class="hljs-string">'./hero'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {NgFor} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/common'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component(<span class="hljs-params">{</span></span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'app-hero-list-groups'</span>,</div><div class="hljs-ln-line">  template: `</div><div class="hljs-ln-line">    &lt;ul <span class="hljs-keyword">class</span>=<span class="hljs-string">"heroes"</span>&gt;</div><div class="hljs-ln-line">      @<span class="hljs-keyword">for</span> (<span class="hljs-params">hero of heroes; track hero</span>) {</div><div class="hljs-ln-line">        &lt;li [@flyInOut]=<span class="hljs-string">"'in'"</span>&gt;</div><div class="hljs-ln-line">          &lt;button <span class="hljs-keyword">class</span>=<span class="hljs-string">"inner"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"button"</span> (<span class="hljs-params">click</span>)=<span class="hljs-string">"removeHero(hero.id)"</span>&gt;</div><div class="hljs-ln-line">            &lt;span <span class="hljs-keyword">class</span>=<span class="hljs-string">"badge"</span>&gt;{{ hero.<span class="hljs-built_in">id</span> }}&lt;/span&gt;</div><div class="hljs-ln-line">            &lt;span <span class="hljs-keyword">class</span>=<span class="hljs-string">"name"</span>&gt;{{ hero.name }}&lt;/span&gt;</div><div class="hljs-ln-line">          &lt;/button&gt;</div><div class="hljs-ln-line">        &lt;/li&gt;</div><div class="hljs-ln-line">      }</div><div class="hljs-ln-line">    &lt;/ul&gt;</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  styleUrls: [<span class="hljs-string">'./hero-list-page.component.css'</span>],</div><div class="hljs-ln-line">  imports: [NgFor],</div><div class="hljs-ln-line">  animations: [</div><div class="hljs-ln-line">    trigger(<span class="hljs-params"><span class="hljs-string">'flyInOut'</span>, [</span></div><div class="hljs-ln-line">      state(<span class="hljs-params"></span></div><div class="hljs-ln-line">        <span class="hljs-string">'in'</span>,</div><div class="hljs-ln-line">        style(<span class="hljs-params">{</span></div><div class="hljs-ln-line">          width: <span class="hljs-string">'*'</span>,</div><div class="hljs-ln-line">          transform: <span class="hljs-string">'translateX(0)'</span>,</div><div class="hljs-ln-line">          opacity: <span class="hljs-number">1</span>,</div><div class="hljs-ln-line">        }),</div><div class="hljs-ln-line">      ),</div><div class="hljs-ln-line">      transition(<span class="hljs-params"><span class="hljs-string">':enter'</span>, [</span></div><div class="hljs-ln-line">        style(<span class="hljs-params">{width: <span class="hljs-number">10</span>, transform: <span class="hljs-string">'translateX(50px)'</span>, opacity: <span class="hljs-number">0</span>}</span>),</div><div class="hljs-ln-line">        group(<span class="hljs-params">[</span></div><div class="hljs-ln-line">          animate(<span class="hljs-params"></span></div><div class="hljs-ln-line">            <span class="hljs-string">'0.3s 0.1s ease'</span>,</div><div class="hljs-ln-line">            style(<span class="hljs-params">{</span></div><div class="hljs-ln-line">              transform: <span class="hljs-string">'translateX(0)'</span>,</div><div class="hljs-ln-line">              width: <span class="hljs-string">'*'</span>,</div><div class="hljs-ln-line">            }),</div><div class="hljs-ln-line">          ),</div><div class="hljs-ln-line">          animate(<span class="hljs-params"></span></div><div class="hljs-ln-line">            <span class="hljs-string">'0.3s ease'</span>,</div><div class="hljs-ln-line">            style(<span class="hljs-params">{</span></div><div class="hljs-ln-line">              opacity: <span class="hljs-number">1</span>,</div><div class="hljs-ln-line">            }),</div><div class="hljs-ln-line">          ),</div><div class="hljs-ln-line">        ]),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">      transition(<span class="hljs-params"><span class="hljs-string">':leave'</span>, [</span></div><div class="hljs-ln-line">        group(<span class="hljs-params">[</span></div><div class="hljs-ln-line">          animate(<span class="hljs-params"></span></div><div class="hljs-ln-line">            <span class="hljs-string">'0.3s ease'</span>,</div><div class="hljs-ln-line">            style(<span class="hljs-params">{</span></div><div class="hljs-ln-line">              transform: <span class="hljs-string">'translateX(50px)'</span>,</div><div class="hljs-ln-line">              width: <span class="hljs-number">10</span>,</div><div class="hljs-ln-line">            }),</div><div class="hljs-ln-line">          ),</div><div class="hljs-ln-line">          animate(<span class="hljs-params"></span></div><div class="hljs-ln-line">            <span class="hljs-string">'0.3s 0.2s ease'</span>,</div><div class="hljs-ln-line">            style(<span class="hljs-params">{</span></div><div class="hljs-ln-line">              opacity: <span class="hljs-number">0</span>,</div><div class="hljs-ln-line">            }),</div><div class="hljs-ln-line">          ),</div><div class="hljs-ln-line">        ]),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">    ]),</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeroListGroupsComponent</span> {</div><div class="hljs-ln-line"><span class="hljs-meta">  @Input() heroes: Hero[] = [];</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">  @Output() remove = new EventEmitter&lt;number&gt;();</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  removeHero(<span class="hljs-built_in">id</span>: number) {</div><div class="hljs-ln-line">    this.remove.emit(<span class="hljs-built_in">id</span>);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h2 id="sequential-vs-parallel-animations">
    <a href="#sequential-vs-parallel-animations" class="docs-anchor" tabindex="-1" aria-label="Link to Sequential vs. parallel animations" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6s7ok4t8js23qmoxuvet73u6t">顺序动画与平行动画</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6bx0rtg3qcr55mz8w7y2tovee">复杂动画中可以同时发生很多事情。但是当你要创建一个需要让几个子动画逐个执行的动画时，该怎么办呢？以前我们使用 <a href="api/animations/group"><code>group()</code></a> 来同时并行运行多个动画。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="742g6cysbn800ivrr713sv2sb">一个名为 
<code>sequence()</code> 的第二个函数让你可以一个接一个地运行相同的动画。 在 
<code>sequence()</code> 内，动画步骤包括 
<code>style()</code> 或 
<code>animate()</code> 函数调用。</p>

  <ul class="docs-list">
    <li data-ng_translator_product="100" data-ng_translator_ref_id="dwm4eslh14dyngmolaqx47kle">使用 
<code>style()</code> 立即应用提供的样式数据。</li>
<li data-ng_translator_product="100" data-ng_translator_ref_id="72u1nc5jsw7rt8a7atvnltdd4">使用 
<code>animate()</code> 在给定的时间间隔内应用样式数据。</li>

  </ul>
  
  <h2 id="filter-animation-example">
    <a href="#filter-animation-example" class="docs-anchor" tabindex="-1" aria-label="Link to Filter animation example" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8z01tbzbykl6h77k28w970yrj">过滤器动画范例</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="azjwptuk4s1plpo8646vt6npz">在示例页面上再看另一个动画。 在过滤/延迟选项卡下，输入一些文本到 
<strong>搜索英雄</strong> 文本框中，比如 
<code>Magnet</code> 或 
<code>tornado</code>。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8ek11inuc2njnrmy7bchvlutm">过滤器会在你输入时实时工作。每当你键入一个新字母时，就会有一些元素离开页面，并且过滤条件也会逐渐变得更加严格。相反，当你删除过滤器中的每个字母时，英雄列表也会逐渐重新进入页面中。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="6fubbdw74frw2s1itkcftb62u">HTML 模板中包含一个名叫 <code>filterAnimation</code> 的触发器。</p>
<div class="docs-code" path="adev/src/content/examples/animations/src/app/hero-list-page.component.html" visiblelines="2,3,4,5,6,7,8,9,10,11,12,13,14,15,16" header="src/app/hero-list-page.component.html">
    <div class="docs-code-header"><h3>src/app/hero-list-page.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Filter/Stagger<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"search"</span>&gt;</span>Search heroes: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"search"</span> #<span class="hljs-attr">criteria</span></span></div><div class="hljs-ln-line">       (<span class="hljs-attr">input</span>)=<span class="hljs-string">"updateCriteria(criteria.value)"</span></div><div class="hljs-ln-line">       <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Search heroes"</span>&gt;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"heroes"</span> [@<span class="hljs-attr">filterAnimation</span>]=<span class="hljs-string">"heroesTotal"</span>&gt;</span></div><div class="hljs-ln-line">  @for (hero of heroes; track hero) {</div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hero"</span>&gt;</span></div><div class="hljs-ln-line">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"inner"</span>&gt;</span></div><div class="hljs-ln-line">        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"badge"</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.id</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span></div><div class="hljs-ln-line">        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"name"</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.name</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span></div><div class="hljs-ln-line">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="enhimftslp9j9f1j1jja3j1ai">该组件装饰器中的 <code>filterAnimation</code> 包含三个过渡。</p>
<div class="docs-code" path="adev/src/content/examples/animations/src/app/hero-list-page.component.ts" visiblelines="6,12,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70" header="src/app/hero-list-page.component.ts">
    <div class="docs-code-header"><h3>src/app/hero-list-page.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Component, HostBinding, OnInit} from <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {trigger, transition, animate, style, query, stagger} from <span class="hljs-string">'@angular/animations'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {HEROES} from <span class="hljs-string">'./mock-heroes'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Hero} from <span class="hljs-string">'./hero'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {NgFor} from <span class="hljs-string">'@angular/common'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component({</span></div><div class="hljs-ln-line">  standalone: true,</div><div class="hljs-ln-line">  imports: [NgFor],</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'app-hero-list-page'</span>,</div><div class="hljs-ln-line">  templateUrl: <span class="hljs-string">'hero-list-page.component.html'</span>,</div><div class="hljs-ln-line">  styleUrls: [<span class="hljs-string">'hero-list-page.component.css'</span>],</div><div class="hljs-ln-line">  animations: [</div><div class="hljs-ln-line">    trigger(<span class="hljs-string">'pageAnimations'</span>, [</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':enter'</span>, [</div><div class="hljs-ln-line">        query(<span class="hljs-string">'.hero'</span>, [</div><div class="hljs-ln-line">          style({opacity: 0, transform: <span class="hljs-string">'translateY(-100px)'</span>}),</div><div class="hljs-ln-line">          stagger(30, [</div><div class="hljs-ln-line">            animate(<span class="hljs-string">'500ms cubic-bezier(0.35, 0, 0.25, 1)'</span>, style({opacity: 1, transform: <span class="hljs-string">'none'</span>})),</div><div class="hljs-ln-line">          ]),</div><div class="hljs-ln-line">        ]),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">    ]),</div><div class="hljs-ln-line">    trigger(<span class="hljs-string">'filterAnimation'</span>, [</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':enter, * =&gt; 0, * =&gt; -1'</span>, []),</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':increment'</span>, [</div><div class="hljs-ln-line">        query(</div><div class="hljs-ln-line">          <span class="hljs-string">':enter'</span>,</div><div class="hljs-ln-line">          [</div><div class="hljs-ln-line">            style({opacity: 0, width: 0}),</div><div class="hljs-ln-line">            stagger(50, [animate(<span class="hljs-string">'300ms ease-out'</span>, style({opacity: 1, width: <span class="hljs-string">'*'</span>}))]),</div><div class="hljs-ln-line">          ],</div><div class="hljs-ln-line">          {optional: true},</div><div class="hljs-ln-line">        ),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">      transition(<span class="hljs-string">':decrement'</span>, [</div><div class="hljs-ln-line">        query(<span class="hljs-string">':leave'</span>, [stagger(50, [animate(<span class="hljs-string">'300ms ease-out'</span>, style({opacity: 0, width: 0}))])]),</div><div class="hljs-ln-line">      ]),</div><div class="hljs-ln-line">    ]),</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line">export <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeroListPageComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span> {</div><div class="hljs-ln-line">  <span class="hljs-meta">@HostBinding(<span class="hljs-string">'@pageAnimations'</span>)</span></div><div class="hljs-ln-line">  <span class="hljs-keyword">public</span> animatePage = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  heroesTotal = -<span class="hljs-number">1</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-keyword">get</span> heroes() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._heroes;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">  <span class="hljs-keyword">private</span> _heroes: Hero[] = [];</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  ngOnInit() {</div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>._heroes = HEROES;</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  updateCriteria(criteria: string) {</div><div class="hljs-ln-line">    criteria = criteria ? criteria.trim() : <span class="hljs-string">''</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-keyword">this</span>._heroes = HEROES.filter((hero) =&gt;</div><div class="hljs-ln-line">      hero.name.toLowerCase().includes(criteria.toLowerCase()),</div><div class="hljs-ln-line">    );</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> newTotal = <span class="hljs-keyword">this</span>.heroes.length;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.heroesTotal !== newTotal) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">this</span>.heroesTotal = newTotal;</div><div class="hljs-ln-line">    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!criteria) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">this</span>.heroesTotal = -<span class="hljs-number">1</span>;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="f4z9wl3e5mzl4552nfdka5ncs">这个例子中的代码包含下列任务：</p>

  <ul class="docs-list">
    <li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3qhbjudyh98kkhdhnu2a20vds">当用户首次打开或导航到此页面时，跳过所有动画（该动画会压扁已经存在的内容，因此它只会作用于那些已经存在于 DOM 中的元素）</li>
<li data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="dv9mpta0xxycog6p6w1epay9o">根据搜索框中的值过滤英雄</li>

  </ul>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="jvdl990wsv45dmx6l8ixdtfn">对于每次匹配：</p>

  <ul class="docs-list">
    <li><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="d5magmvz93vjlgv7erjyxtcg5">通过将元素的不透明度和宽度设置为 0 来隐藏正在离开 DOM 的元素</p>
</li>
<li><p data-ng_translator_product="100" data-ng_translator_ref_id="9eoayn8x9jqcip2vwa108szur">在 300 毫秒内动画进入 DOM 的元素。 在动画过程中，元素会假定其默认宽度和不透明度。</p>
</li>
<li><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="b47n9rormtihkate0cdqi0r3z">如果有多个匹配的元素正在进入或离开 DOM，则从页面顶部的元素开始对每个元素进行交错（stagger），每个元素之间的延迟为 50 毫秒</p>
</li>

  </ul>
  
  <h2 id="animating-the-items-of-a-reordering-list">
    <a href="#animating-the-items-of-a-reordering-list" class="docs-anchor" tabindex="-1" aria-label="Link to Animating the items of a reordering list" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bkf1gkkrok6uqgmvp5a624o0f">在重新排序列表的条目时播放动画</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="7is1d0udqhnykm7b0gufe9u0n">虽然 Angular 可以正确地对 
<code>*ngFor</code> 列表项进行动画处理，但如果它们的顺序发生变化，则无法再进行处理。 这是因为它会丢失哪个元素是哪个的跟踪，导致动画失效。 帮助 Angular 记住这些元素的唯一方法是为 
<code>NgForOf</code> 指令分配一个 
<code>TrackByFunction</code>。 这确保 Angular 总是知道哪个元素是哪个，从而使其始终能够将正确的动画应用于正确的元素。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="4w1nwrpyenpynd076nryb628">重要提示： 如果需要对
<code>*ngFor</code>列表的条目进行动画处理，并且这些条目在运行时可能会改变顺序，务必使用
<code>TrackByFunction</code>。</p>

  <h2 id="animations-and-component-view-encapsulation">
    <a href="#animations-and-component-view-encapsulation" class="docs-anchor" tabindex="-1" aria-label="Link to Animations and Component View Encapsulation" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bnolavb2l7xhdsq4yzrd1iub5">动画和组件视图封装</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="ab9fgalndncst4qwrn48r4jr7">Angular 动画基于组件的 DOM 结构，并不直接考虑
<a href="guide/components/styling#style-scoping">视图封装</a>，这意味着使用
<code>ViewEncapsulation.Emulated</code>的组件行为就像使用
<code>ViewEncapsulation.None</code>一样（
<code>ViewEncapsulation.ShadowDom</code>行为会有所不同，稍后我们将讨论）。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="rhp5mdodwfonrre8prwh3you">例如，如果
<code>query()</code>函数（在动画指南的其余部分中会更多地看到）应用于使用模拟视图封装的组件树的顶部，那么该查询将能够识别（因此动画化）树的任何深度上的 DOM 元素。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="5ai3i3vvl1ljtyru2vf8hwzdg">另一方面，
<code>ViewEncapsulation.ShadowDom</code> 通过将 DOM 元素「隐藏」在 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot" target="_blank"><code>ShadowRoot</code></a> 元素中来改变组件的 DOM 结构。由于这种 DOM 操作依赖于简单的 DOM 结构，并且不考虑 
<code>ShadowRoot</code> 元素，因此会阻止某些动画实现正常工作。因此，建议避免将动画应用于包含使用 ShadowDom 视图封装的组件的视图。</p>

  <h2 id="animation-sequence-summary">
    <a href="#animation-sequence-summary" class="docs-anchor" tabindex="-1" aria-label="Link to Animation sequence summary" data-ng_translator_product="100" data-ng_translator_ref_id="bny745whiscktuf4eqjir2zm9">动画序列摘要</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="9gz7zeyhgdi17rirui4a16zcz">Angular 用于对多个元素进行动画处理的函数以
<code>query()</code>开头，用于查找内部元素；例如，在
<code>&lt;div&gt;</code>中收集所有图像。其余的函数，
<code>stagger()</code>，
<a href="api/animations/group"><code>group()</code></a>和
<code>sequence()</code>，应用级联或让你控制如何应用多个动画步骤。</p>

  <h2 id="more-on-angular-animations">
    <a href="#more-on-angular-animations" class="docs-anchor" tabindex="-1" aria-label="Link to More on Angular animations" data-ng_translator_product="100" data-ng_translator_ref_id="a26kagk7mrtsdtdkoro0iswgp">关于 Angular 动画的更多知识</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1oolgylns9kaynftarwog49tq">你可能还对下列内容感兴趣：</p>

    <nav class="docs-pill-row">
      
    <a class="docs-pill" href="guide/animations" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8efkbqfn0ftsqxrt3qijmnwej">Angular 动画简介</a>
    
    <a class="docs-pill" href="guide/animations/transition-and-triggers" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3rydsupe7krnv6vnfnf00p2ir">过渡与触发器</a>
    
    <a class="docs-pill" href="guide/animations/reusable-animations" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="2voxtsmz3cy504712cdddfint">可复用动画</a>
    
    <a class="docs-pill" href="guide/animations/route-animations" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3wpy14odnjxcm6qf09abby2sa">路由过渡动画</a>
    

    </nav>
    