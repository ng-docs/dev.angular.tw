<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4f52ejc3rinwvytrc1s74trwz">部署多个语言环境</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/i18n/deploy.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ez1mv34tnjwkwv7jxk36idw7m">如果 <code>myapp</code> 是包含项目可分发文件的目录，你通常会在语言环境目录中为不同的语言环境提供不同的版本，比如法语版的 <code>myapp/fr</code> 和西班牙语版的 <code>myapp/es</code>。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="djqhiy7ykdm9cug4xqjcyb8lb">HTML 中带有 
<code>href</code> 属性的 
<code>base</code> 标签指定了相对链接的基本 URI 或 URL。 如果你在 
<a href="reference/configs/workspace-config" title="Angular" workspace configuration | angular><code>angular.json</code></a> 工作区构建配置文件中将 
<code>"localize"</code> 选项设置为 
<code>true</code> 或语言环境 ID 数组，CLI 将调整每个版本应用的基本 
<code>href</code>。 要调整每个版本应用的基本 
<code>href</code>，CLI 会将语言环境添加到配置的 
<code>"baseHref"</code> 中。 在 
<a href="reference/configs/workspace-config" title="Angular" workspace configuration | angular><code>angular.json</code></a> 工作区构建配置文件中为每个语言环境指定 
<code>"baseHref"</code>。 以下示例显示了 
<code>"baseHref"</code> 设置为空字符串。</p>
<div class="docs-code" path="adev/src/content/examples/i18n/angular.json" visiblelines="4,5,10,11,12,13,14,15,16,17,18,19,108,109,110,111" header="angular.json">
    <div class="docs-code-header"><h3>angular.json</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line">{</div><div class="hljs-ln-line">  <span class="hljs-string">"$schema"</span>: <span class="hljs-string">"./node_modules/@angular/cli/lib/config/schema.json"</span>,</div><div class="hljs-ln-line">  <span class="hljs-string">"version"</span>: <span class="hljs-number">1</span>,</div><div class="hljs-ln-line">  <span class="hljs-string">"newProjectRoot"</span>: <span class="hljs-string">"projects"</span>,</div><div class="hljs-ln-line">  <span class="hljs-string">"projects"</span>: {</div><div class="hljs-ln-line">    <span class="hljs-string">"angular.io-example"</span>: {</div><div class="hljs-ln-line">      <span class="hljs-string">"projectType"</span>: <span class="hljs-string">"application"</span>,</div><div class="hljs-ln-line">      <span class="hljs-string">"root"</span>: <span class="hljs-string">""</span>,</div><div class="hljs-ln-line">      <span class="hljs-string">"sourceRoot"</span>: <span class="hljs-string">"src"</span>,</div><div class="hljs-ln-line">      <span class="hljs-string">"prefix"</span>: <span class="hljs-string">"app"</span>,</div><div class="hljs-ln-line">      <span class="hljs-string">"i18n"</span>: {</div><div class="hljs-ln-line">        <span class="hljs-string">"sourceLocale"</span>: <span class="hljs-string">"en-US"</span>,</div><div class="hljs-ln-line">        <span class="hljs-string">"locales"</span>: {</div><div class="hljs-ln-line">          <span class="hljs-string">"fr"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"translation"</span>: <span class="hljs-string">"src/locale/messages.fr.xlf"</span>,</div><div class="hljs-ln-line">            <span class="hljs-string">"baseHref"</span>: <span class="hljs-string">""</span></div><div class="hljs-ln-line">          }</div><div class="hljs-ln-line">        }</div><div class="hljs-ln-line">      },</div><div class="hljs-ln-line">      <span class="hljs-string">"architect"</span>: {</div><div class="hljs-ln-line">        <span class="hljs-string">"build"</span>: {</div><div class="hljs-ln-line">          <span class="hljs-string">"builder"</span>: <span class="hljs-string">"@angular-devkit/build-angular:browser"</span>,</div><div class="hljs-ln-line">          <span class="hljs-string">"options"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"localize"</span>: true,</div><div class="hljs-ln-line">            <span class="hljs-string">"outputPath"</span>: <span class="hljs-string">"dist"</span>,</div><div class="hljs-ln-line">            <span class="hljs-string">"index"</span>: <span class="hljs-string">"src/index.html"</span>,</div><div class="hljs-ln-line">            <span class="hljs-string">"main"</span>: <span class="hljs-string">"src/main.ts"</span>,</div><div class="hljs-ln-line">            <span class="hljs-string">"polyfills"</span>: [<span class="hljs-string">"zone.js"</span>],</div><div class="hljs-ln-line">            <span class="hljs-string">"tsConfig"</span>: <span class="hljs-string">"tsconfig.app.json"</span>,</div><div class="hljs-ln-line">            <span class="hljs-string">"assets"</span>: [<span class="hljs-string">"src/favicon.ico"</span>, <span class="hljs-string">"src/assets"</span>],</div><div class="hljs-ln-line">            <span class="hljs-string">"styles"</span>: [<span class="hljs-string">"src/styles.css"</span>],</div><div class="hljs-ln-line">            <span class="hljs-string">"scripts"</span>: [],</div><div class="hljs-ln-line">            <span class="hljs-string">"i18nMissingTranslation"</span>: <span class="hljs-string">"error"</span></div><div class="hljs-ln-line">          },</div><div class="hljs-ln-line">          <span class="hljs-string">"configurations"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"production"</span>: {</div><div class="hljs-ln-line">              <span class="hljs-string">"budgets"</span>: [</div><div class="hljs-ln-line">                {</div><div class="hljs-ln-line">                  <span class="hljs-string">"type"</span>: <span class="hljs-string">"initial"</span>,</div><div class="hljs-ln-line">                  <span class="hljs-string">"maximumWarning"</span>: <span class="hljs-string">"500kb"</span>,</div><div class="hljs-ln-line">                  <span class="hljs-string">"maximumError"</span>: <span class="hljs-string">"1mb"</span></div><div class="hljs-ln-line">                },</div><div class="hljs-ln-line">                {</div><div class="hljs-ln-line">                  <span class="hljs-string">"type"</span>: <span class="hljs-string">"anyComponentStyle"</span>,</div><div class="hljs-ln-line">                  <span class="hljs-string">"maximumWarning"</span>: <span class="hljs-string">"2kb"</span>,</div><div class="hljs-ln-line">                  <span class="hljs-string">"maximumError"</span>: <span class="hljs-string">"4kb"</span></div><div class="hljs-ln-line">                }</div><div class="hljs-ln-line">              ],</div><div class="hljs-ln-line">              <span class="hljs-string">"outputHashing"</span>: <span class="hljs-string">"all"</span></div><div class="hljs-ln-line">            },</div><div class="hljs-ln-line">            <span class="hljs-string">"development"</span>: {</div><div class="hljs-ln-line">              <span class="hljs-string">"localize"</span>: false,</div><div class="hljs-ln-line">              <span class="hljs-string">"buildOptimizer"</span>: false,</div><div class="hljs-ln-line">              <span class="hljs-string">"optimization"</span>: false,</div><div class="hljs-ln-line">              <span class="hljs-string">"vendorChunk"</span>: true,</div><div class="hljs-ln-line">              <span class="hljs-string">"extractLicenses"</span>: false,</div><div class="hljs-ln-line">              <span class="hljs-string">"sourceMap"</span>: true,</div><div class="hljs-ln-line">              <span class="hljs-string">"namedChunks"</span>: true</div><div class="hljs-ln-line">            },</div><div class="hljs-ln-line">            <span class="hljs-string">"fr"</span>: {</div><div class="hljs-ln-line">              <span class="hljs-string">"localize"</span>: [<span class="hljs-string">"fr"</span>]</div><div class="hljs-ln-line">            }</div><div class="hljs-ln-line">          },</div><div class="hljs-ln-line">          <span class="hljs-string">"defaultConfiguration"</span>: <span class="hljs-string">"production"</span></div><div class="hljs-ln-line">        },</div><div class="hljs-ln-line">        <span class="hljs-string">"serve"</span>: {</div><div class="hljs-ln-line">          <span class="hljs-string">"builder"</span>: <span class="hljs-string">"@angular-devkit/build-angular:dev-server"</span>,</div><div class="hljs-ln-line">          <span class="hljs-string">"configurations"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"production"</span>: {</div><div class="hljs-ln-line">              <span class="hljs-string">"buildTarget"</span>: <span class="hljs-string">"angular.io-example:build:production"</span></div><div class="hljs-ln-line">            },</div><div class="hljs-ln-line">            <span class="hljs-string">"development"</span>: {</div><div class="hljs-ln-line">              <span class="hljs-string">"buildTarget"</span>: <span class="hljs-string">"angular.io-example:build:development"</span></div><div class="hljs-ln-line">            },</div><div class="hljs-ln-line">            <span class="hljs-string">"fr"</span>: {</div><div class="hljs-ln-line">              <span class="hljs-string">"buildTarget"</span>: <span class="hljs-string">"angular.io-example:build:development,fr"</span></div><div class="hljs-ln-line">            }</div><div class="hljs-ln-line">          },</div><div class="hljs-ln-line">          <span class="hljs-string">"defaultConfiguration"</span>: <span class="hljs-string">"development"</span></div><div class="hljs-ln-line">        },</div><div class="hljs-ln-line">        <span class="hljs-string">"extract-i18n"</span>: {</div><div class="hljs-ln-line">          <span class="hljs-string">"builder"</span>: <span class="hljs-string">"@angular-devkit/build-angular:extract-i18n"</span>,</div><div class="hljs-ln-line">          <span class="hljs-string">"options"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"buildTarget"</span>: <span class="hljs-string">"angular.io-example:build"</span></div><div class="hljs-ln-line">          }</div><div class="hljs-ln-line">        },</div><div class="hljs-ln-line">        <span class="hljs-string">"test"</span>: {</div><div class="hljs-ln-line">          <span class="hljs-string">"builder"</span>: <span class="hljs-string">"@angular-devkit/build-angular:karma"</span>,</div><div class="hljs-ln-line">          <span class="hljs-string">"options"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"polyfills"</span>: [<span class="hljs-string">"zone.js"</span>, <span class="hljs-string">"zone.js/testing"</span>],</div><div class="hljs-ln-line">            <span class="hljs-string">"tsConfig"</span>: <span class="hljs-string">"tsconfig.spec.json"</span>,</div><div class="hljs-ln-line">            <span class="hljs-string">"assets"</span>: [<span class="hljs-string">"src/favicon.ico"</span>, <span class="hljs-string">"src/assets"</span>],</div><div class="hljs-ln-line">            <span class="hljs-string">"styles"</span>: [<span class="hljs-string">"src/styles.css"</span>],</div><div class="hljs-ln-line">            <span class="hljs-string">"scripts"</span>: []</div><div class="hljs-ln-line">          }</div><div class="hljs-ln-line">        },</div><div class="hljs-ln-line">        <span class="hljs-string">"e2e"</span>: {</div><div class="hljs-ln-line">          <span class="hljs-string">"builder"</span>: <span class="hljs-string">"@angular-devkit/build-angular:protractor"</span>,</div><div class="hljs-ln-line">          <span class="hljs-string">"options"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"protractorConfig"</span>: <span class="hljs-string">"e2e/protractor.conf.js"</span>,</div><div class="hljs-ln-line">            <span class="hljs-string">"devServerTarget"</span>: <span class="hljs-string">"angular.io-example:serve:fr"</span></div><div class="hljs-ln-line">          },</div><div class="hljs-ln-line">          <span class="hljs-string">"configurations"</span>: {</div><div class="hljs-ln-line">            <span class="hljs-string">"production"</span>: {</div><div class="hljs-ln-line">              <span class="hljs-string">"devServerTarget"</span>: <span class="hljs-string">"angular.io-example:serve:production"</span></div><div class="hljs-ln-line">            }</div><div class="hljs-ln-line">          }</div><div class="hljs-ln-line">        }</div><div class="hljs-ln-line">      }</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="cqhh0shp4r8u2r5fcpm0uyo5f">此外，要在编译时声明基本 
<code>href</code>，请使用 CLI 的 
<code>--baseHref</code> 选项与 
<a href="cli/build" title="ng" build | cli angular><code>ng build</code></a> 一起使用。</p>

  <h2 id="configure-a-server">
    <a href="#configure-a-server" class="docs-anchor" tabindex="-1" aria-label="Link to Configure a server" data-ng_translator_product="100" data-ng_translator_ref_id="82s4atn4w14dlfrv8nqng6qsl">配置服务器</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ae1xgllvgd78u42ya1ljky643">多语言的典型部署方式是为来自不同子目录的每种语言提供服务。使用 <code>Accept-Language</code> HTTP 标头将用户重定向到浏览器中定义的首选语言。如果用户未定义首选语言，或者首选语言不可用，则服务器将回退到默认语言。要更改语言，就转到另一个子目录。
子目录的更改通常使用应用程序中实现的菜单进行。</p>

    <div class="docs-alert docs-alert-helpful">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="dxzixgo8zxet181g0jq0co75y"><strong>有帮助的:</strong> 有关如何将应用部署到远程服务器的更多信息，请参阅 
<a href="tools/cli/deployment" title="Deployment" | angular>部署</a>。</p>

    </div>
    
  <h3 id="nginx-example">
    <a href="#nginx-example" class="docs-anchor" tabindex="-1" aria-label="Link to Nginx example" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="938p8l1dpasfpk0irdr2v3uz1">Nginx 范例</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7n05mzp688aehj6j6x2rd7h8">以下示例展示了 Nginx 配置。</p>
<div class="docs-code" path="adev/src/content/examples/i18n/doc-files/nginx.conf">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-section">http</span> {</div><div class="hljs-ln-line">    <span class="hljs-comment"># Browser preferred language detection (does NOT require</span></div><div class="hljs-ln-line">    <span class="hljs-comment"># AcceptLanguageModule)</span></div><div class="hljs-ln-line">    <span class="hljs-attribute">map</span> <span class="hljs-variable">$http_accept_language</span> <span class="hljs-variable">$accept_language</span> {</div><div class="hljs-ln-line">        ~*^<span class="hljs-attribute">de</span> de;</div><div class="hljs-ln-line">        ~*^<span class="hljs-attribute">fr</span> fr;</div><div class="hljs-ln-line">        ~*^<span class="hljs-attribute">en</span> en;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    <span class="hljs-comment"># ...</span></div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-section">server</span> {</div><div class="hljs-ln-line">    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;</div><div class="hljs-ln-line">    <span class="hljs-attribute">server_name</span> localhost;</div><div class="hljs-ln-line">    <span class="hljs-attribute">root</span> /www/data;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment"># Fallback to default language if no preference defined by browser</span></div><div class="hljs-ln-line">    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$accept_language</span> <span class="hljs-regexp">~ "^$")</span> {</div><div class="hljs-ln-line">        <span class="hljs-attribute">set</span> <span class="hljs-variable">$accept_language</span> <span class="hljs-string">"fr"</span>;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment"># Redirect "/" to Angular application in the preferred language of the browser</span></div><div class="hljs-ln-line">    <span class="hljs-attribute">rewrite</span><span class="hljs-regexp"> ^/$</span> /<span class="hljs-variable">$accept_language</span> <span class="hljs-literal">permanent</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">    <span class="hljs-comment"># Everything under the Angular application is always redirected to Angular in the</span></div><div class="hljs-ln-line">    <span class="hljs-comment"># correct language</span></div><div class="hljs-ln-line">    <span class="hljs-section">location</span> <span class="hljs-regexp">~ ^/(fr|de|en)</span> {</div><div class="hljs-ln-line">        <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> /<span class="hljs-variable">$1</span>/index.html?<span class="hljs-variable">$args</span>;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    <span class="hljs-comment"># ...</span></div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
  <h3 id="apache-example">
    <a href="#apache-example" class="docs-anchor" tabindex="-1" aria-label="Link to Apache example" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="2yf63hmoz35531bmp25rg7i1l">Apache 范例</a>
  </h3>
  <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="a0kxe5d8b9oewutz9ypaqp7rf">以下示例展示了 Apache 配置。</p>
<div class="docs-code" path="adev/src/content/examples/i18n/doc-files/apache2.conf">
    
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-section">&lt;VirtualHost *<span class="hljs-number">:80</span>&gt;</span></div><div class="hljs-ln-line">    <span class="hljs-attribute">ServerName</span> localhost</div><div class="hljs-ln-line">    <span class="hljs-attribute">DocumentRoot</span> /www/data</div><div class="hljs-ln-line">    <span class="hljs-section">&lt;Directory <span class="hljs-string">"/www/data"</span>&gt;</span></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteEngine</span> <span class="hljs-literal">on</span></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteBase</span> /</div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteRule</span> ^../index\.html$ -<span class="hljs-meta"> [L]</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%{REQUEST_FILENAME}</span> !-f</div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%{REQUEST_FILENAME}</span> !-d</div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteRule</span> (..) $<span class="hljs-number">1</span>/index.html<span class="hljs-meta"> [L]</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%{HTTP:Accept-Language}</span> ^de<span class="hljs-meta"> [NC]</span></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteRule</span> ^$ /de/<span class="hljs-meta"> [R]</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%{HTTP:Accept-Language}</span> ^en<span class="hljs-meta"> [NC]</span></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteRule</span> ^$ /en/<span class="hljs-meta"> [R]</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%{HTTP:Accept-Language}</span> !^en<span class="hljs-meta"> [NC]</span></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteCond</span> <span class="hljs-variable">%{HTTP:Accept-Language}</span> !^de<span class="hljs-meta"> [NC]</span></div><div class="hljs-ln-line">        <span class="hljs-attribute">RewriteRule</span> ^$ /fr/<span class="hljs-meta"> [R]</span></div><div class="hljs-ln-line">    <span class="hljs-section">&lt;/Directory&gt;</span></div><div class="hljs-ln-line"><span class="hljs-section">&lt;/VirtualHost&gt;</span></div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>