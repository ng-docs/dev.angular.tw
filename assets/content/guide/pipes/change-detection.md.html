<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="4pxrl56gk118fi6bfkg0onlw">使用管道进行变更检测</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/pipes/change-detection.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p data-ng_translator_product="100" data-ng_translator_ref_id="dr5qrkukeim7tpo4a1xewvsgn">管道通常与数据绑定值一起使用，这些值可能会根据用户操作而改变。如果数据是一个原语输入值（如 
<code>String</code> 或 
<code>Number</code>）或作为输入的对象引用（如 
<code>Date</code> 或 
<code>Array</code>），Angular 就会在检测到该值变化时执行管道。</p>
<div class="docs-code-multifile" path="adev/src/content/examples/pipes/src/app/power-booster.component.ts">
    <div class="docs-code" path="adev/src/content/examples/pipes/src/app/exponential-strength.pipe.ts" visiblelines="10,11,12,13,14,15,16,17,18" header="src/app/exponential-strength.pipe.ts">
    <div class="docs-code-header"><h3>src/app/exponential-strength.pipe.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Pipe</span>, <span class="hljs-title class_">PipeTransform</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-comment">/*</span></div><div class="hljs-ln-line"> * Raise the value exponentially</div><div class="hljs-ln-line"> * Takes an exponent argument that defaults to 1.</div><div class="hljs-ln-line"> * Usage:</div><div class="hljs-ln-line"> *   value | exponentialStrength:exponent</div><div class="hljs-ln-line"> * Example:</div><div class="hljs-ln-line"> *   {{ 2 | exponentialStrength:10 }}</div><div class="hljs-ln-line"> *   formats to: 1024</div><div class="hljs-ln-line"> */</div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  <span class="hljs-attr">standalone</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">name</span>: <span class="hljs-string">'exponentialStrength'</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExponentialStrengthPipe</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PipeTransform</span> {</div><div class="hljs-ln-line highlighted">  <span class="hljs-title function_">transform</span>(<span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span>, exponent = <span class="hljs-number">1</span>): <span class="hljs-built_in">number</span> {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(value, exponent);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><div class="docs-code" path="adev/src/content/examples/pipes/src/app/power-booster.component.ts" header="src/app/power-booster.component.ts">
    <div class="docs-code-header"><h3>src/app/power-booster.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {ExponentialStrengthPipe} <span class="hljs-keyword">from</span> <span class="hljs-string">'./exponential-strength.pipe'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">@Component({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  selector: <span class="hljs-string">'app-power-booster'</span>,</div><div class="hljs-ln-line">  template: `<span class="language-javascript"></span></div><div class="hljs-ln-line">    &lt;h2&gt;<span class="hljs-title class_">Power</span> <span class="hljs-title class_">Booster</span>&lt;/h2&gt;</div><div class="hljs-ln-line">    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Super power boost: {{2 | exponentialStrength: 10}}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span></div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  imports: [ExponentialStrengthPipe],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PowerBoosterComponent</span> {}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
    </div><p data-ng_translator_product="100" data-ng_translator_ref_id="3582tfubltp7lv410w74ap3f8"><code>exponentialStrength</code> 管道在用户更改值或指数时每次都会执行。请参见上面突出显示的行。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3tjfetf3opzedk9414uqap4se">Angular 会检测每次变更，并立即运行该管道。对于原始输入值，这很好。但是，如果要在复合对象中更改某些<em>内部值</em>（比如日期中的月份、数组中的元素或对象中的属性），就需要了解变更检测的工作原理，以及如何使用 <code>impure</code>（非纯）管道。</p>

  <h2 id="how-change-detection-works">
    <a href="#how-change-detection-works" class="docs-anchor" tabindex="-1" aria-label="Link to How change detection works" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bbzojdcj45x3zth0q6q7xlk56">变更检测的工作原理</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="c9st6a2n7zl2mnfx3cojm9c7y">Angular 在每次 DOM 事件后（每次按键、鼠标移动、计时器滴答和服务器响应）会在变更检测过程中寻找数据绑定值的变化。以下示例不使用管道，展示了 Angular 如何使用其默认的变更检测策略来监控并更新 
<code>heroes</code> 数组中每个英雄的显示。示例标签显示如下：</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left" data-ng_translator_product="100" data-ng_translator_ref_id="8n2c7wfntpyw9gnmnqx5bqxht">文件</th>
<th align="left" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3prlgfrx5eo2xqncnnob4crxu">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left"><code>flying-heroes.component.html (v1)</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="f0zzpk6wvu3z8z6f1ioumzjyc"><code>*ngFor</code> 重复器显示英雄的名字。</td>
</tr>
<tr>
<td align="left"><code>flying-heroes.component.ts (v1)</code></td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="1ewqiqo0qxa8oibjoi9adgvd9">提供英雄，将英雄添加到数组中，并重置数组。</td>
</tr>

      </tbody>
    </table>
  </div>
  <div class="docs-code-multifile">
    <div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.component.html" visiblelines="2,3,11,23,24,25" header="src/app/flying-heroes.component.html (v1)">
    <div class="docs-code-header"><h3>src/app/flying-heroes.component.html (v1)</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span></span><span class="hljs-template-variable">{{ <span class="hljs-name">title</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Create a new hero and press enter to add it to the list. <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"hero-name"</span>&gt;</span>New hero name: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> #<span class="hljs-attr">box</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hero-name"</span> (<span class="hljs-attr">keyup.enter</span>)=<span class="hljs-string">"addHero(box.value); box.value=''"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"hero name"</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"can-fly"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> [(<span class="hljs-attr">ngModel</span>)]=<span class="hljs-string">"canFly"</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"can-fly"</span>&gt;</span>Hero can fly<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"mutate"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> [(<span class="hljs-attr">ngModel</span>)]=<span class="hljs-string">"mutate"</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"mutate"</span>&gt;</span>Mutate array<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"reset()"</span>&gt;</span>Reset list of heroes<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Heroes who fly (piped)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"flyers"</span>&gt;</span></div><div class="hljs-ln-line">  @for (hero of (heroes | flyingHeroes); track hero) {</div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.name</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>All Heroes (no pipe)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"all"</span>&gt;</span></div><div class="hljs-ln-line">  @for (hero of heroes; track hero) {</div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.name</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.component.ts" visiblelines="20,21,22,26,27,28,29,30,31,32,33,34,35,39,44,45,46,47,48,49" header="src/app/flying-heroes.component.ts (v1)">
    <div class="docs-code-header"><h3>src/app/flying-heroes.component.ts (v1)</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Component</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">CommonModule</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/common'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">FormsModule</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/forms'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">FlyingHeroesPipe</span>, <span class="hljs-title class_">FlyingHeroesImpurePipe</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./flying-heroes.pipe'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-variable constant_">HEROES</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./heroes'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component</span>({</div><div class="hljs-ln-line">  <span class="hljs-attr">standalone</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-flying-heroes'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">'./flying-heroes.component.html'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">CommonModule</span>, <span class="hljs-title class_">FormsModule</span>, <span class="hljs-title class_">FlyingHeroesPipe</span>],</div><div class="hljs-ln-line">  <span class="hljs-attr">styles</span>: [</div><div class="hljs-ln-line">    <span class="hljs-string">`</span></div><div class="hljs-ln-line">    #flyers, #all {font-style: italic}</div><div class="hljs-ln-line">    button {display: block}</div><div class="hljs-ln-line">    input {margin: .25rem .25rem .5rem 0;}</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlyingHeroesComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-attr">heroes</span>: <span class="hljs-built_in">any</span>[] = [];</div><div class="hljs-ln-line">  canFly = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">  mutate = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">  title = <span class="hljs-string">'Flying Heroes (pure pipe)'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</div><div class="hljs-ln-line">    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reset</span>();</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">addHero</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</div><div class="hljs-ln-line">    name = name.<span class="hljs-title function_">trim</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (!name) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">return</span>;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> hero = {name, <span class="hljs-attr">canFly</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">canFly</span>};</div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutate</span>) {</div><div class="hljs-ln-line">      <span class="hljs-comment">// Pure pipe won't update display because heroes array reference is unchanged</span></div><div class="hljs-ln-line">      <span class="hljs-comment">// Impure pipe will display</span></div><div class="hljs-ln-line">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span>.<span class="hljs-title function_">push</span>(hero);</div><div class="hljs-ln-line">    } <span class="hljs-keyword">else</span> {</div><div class="hljs-ln-line">      <span class="hljs-comment">// Pipe updates display because heroes array is a new object</span></div><div class="hljs-ln-line">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span>.<span class="hljs-title function_">concat</span>(hero);</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">reset</span>(<span class="hljs-params"></span>) {</div><div class="hljs-ln-line">    <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span> = <span class="hljs-variable constant_">HEROES</span>.<span class="hljs-title function_">slice</span>();</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">////// Identical except for impure pipe //////</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Component</span>({</div><div class="hljs-ln-line">  <span class="hljs-attr">standalone</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-flying-heroes-impure'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">'./flying-heroes-impure.component.html'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">CommonModule</span>, <span class="hljs-title class_">FormsModule</span>, <span class="hljs-title class_">FlyingHeroesImpurePipe</span>],</div><div class="hljs-ln-line">  <span class="hljs-attr">styles</span>: [</div><div class="hljs-ln-line">    <span class="hljs-string">'#flyers, #all {font-style: italic}'</span>,</div><div class="hljs-ln-line">    <span class="hljs-string">'button {display: block}'</span>,</div><div class="hljs-ln-line">    <span class="hljs-string">'input {margin: .25rem .25rem .5rem 0;}'</span>,</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlyingHeroesImpureComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">FlyingHeroesComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">override</span> title = <span class="hljs-string">'Flying Heroes (impure pipe)'</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
    </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="9s86ytsok49oqu6xu5qqsvlu3">每次用户添加一个英雄时，Angular 都会更新显示内容。如果用户点击了 <strong>Reset</strong> 按钮，Angular 就会用原来这些英雄组成的新数组来替换 <code>heroes</code>，并更新显示。如果你添加删除或更改了某个英雄的能力，Angular 也会检测这些变化并更新显示。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ajyrsh4yx75249elt1dr1yjfe">然而，如果对于每次更改都执行一个管道来更新显示，就会降低你应用的性能。因此，Angular 会使用更快的变更检测算法来执行管道，如下一节所述。</p>

  <h2 id="detecting-pure-changes-to-primitives-and-object-references">
    <a href="#detecting-pure-changes-to-primitives-and-object-references" class="docs-anchor" tabindex="-1" aria-label="Link to Detecting pure changes to primitives and object references" data-ng_translator_product="100" data-ng_translator_ref_id="22of8qm26xosc9yxgzxgywv1u">检测原始类型和对象引用的纯变更</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="1gx03obvcw9vgqct0nic08bt3">默认情况下，管道被定义为
<em>纯</em>的，这样 Angular 只有在检测到输入值或参数的
<em>纯变化</em>时才会执行管道。纯变化要么是对原语输入值（如 
<code>String</code>、
<code>Number</code>、
<code>Boolean</code> 或 
<code>Symbol</code>）的变化，要么是对象引用（如 
<code>Date</code>、
<code>Array</code>、
<code>Function</code> 或 
<code>Object</code>）的变化。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="2f5x4nes859ke5pzcx5buybjm">纯管道必须使用纯函数，它能处理输入并返回没有副作用的值。换句话说，给定相同的输入，纯函数应该总是返回相同的输出。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="d6zg96hpnkk6bqosd41e9q12n">对于纯管道，Angular 会忽略对象和数组内部的变化，因为检查原语值或对象引用比对对象内部的差异进行深度检查要快得多。Angular 可以快速确定是否可以跳过执行管道和更新视图。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="acv61xfg0y6cke9psah3uu88s">然而，输入为数组的纯管道可能不会按预期工作。为了说明这个问题，请将之前的示例更改为过滤出仅能飞行的英雄。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="afqbr3odahazkiykqrbwqx7t0">为此，请考虑我们在 
<code>*ngFor</code> 重复器中使用 
<code>FlyingHeroesPipe</code>，如以下代码所示。示例标签显示如下：</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left" data-ng_translator_product="100" data-ng_translator_ref_id="8n2c7wfntpyw9gnmnqx5bqxht">文件</th>
<th align="left" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3prlgfrx5eo2xqncnnob4crxu">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left">flying-heroes.component.html</td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="d8qa5aea48h54s8sut33l5s3j">使用新管道的模板。</td>
</tr>
<tr>
<td align="left">flying-heroes.pipe.ts</td>
<td align="left" data-ng_translator_product="100" data-ng_translator_ref_id="2zwozm19kw8e9rwcuvwxroia">包含过滤飞行英雄的自定义管道的文件。</td>
</tr>

      </tbody>
    </table>
  </div>
  <div class="docs-code-multifile">
    <div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.component.html" visiblelines="16,17,18" header="src/app/flying-heroes.component.html">
    <div class="docs-code-header"><h3>src/app/flying-heroes.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span></span><span class="hljs-template-variable">{{ <span class="hljs-name">title</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Create a new hero and press enter to add it to the list. <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"hero-name"</span>&gt;</span>New hero name: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> #<span class="hljs-attr">box</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hero-name"</span> (<span class="hljs-attr">keyup.enter</span>)=<span class="hljs-string">"addHero(box.value); box.value=''"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"hero name"</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"can-fly"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> [(<span class="hljs-attr">ngModel</span>)]=<span class="hljs-string">"canFly"</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"can-fly"</span>&gt;</span>Hero can fly<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"mutate"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> [(<span class="hljs-attr">ngModel</span>)]=<span class="hljs-string">"mutate"</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"mutate"</span>&gt;</span>Mutate array<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"reset()"</span>&gt;</span>Reset list of heroes<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Heroes who fly (piped)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"flyers"</span>&gt;</span></div><div class="hljs-ln-line">  @for (hero of (heroes | flyingHeroes); track hero) {</div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.name</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>All Heroes (no pipe)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"all"</span>&gt;</span></div><div class="hljs-ln-line">  @for (hero of heroes; track hero) {</div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.name</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.pipe.ts" visiblelines="0,1,2,3,4,5,6,7,8,9,10,11,12" header="src/app/flying-heroes.pipe.ts">
    <div class="docs-code-header"><h3>src/app/flying-heroes.pipe.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Pipe</span>, <span class="hljs-type">PipeTransform</span>} from '<span class="hljs-meta">@angular</span>/core';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Hero</span>} from './heroes';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroes',</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesPipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> </span>{</div><div class="hljs-ln-line">  transform(allHeroes: <span class="hljs-type">Hero</span>[]) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> allHeroes.filter((hero) =&gt; hero.canFly);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/////// Identical except for the pure flag</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroesImpure',</div><div class="hljs-ln-line">  pure: <span class="hljs-literal">false</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesImpurePipe</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FlyingHeroesPipe</span> </span>{}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
    </div><p data-ng_translator_product="100" data-ng_translator_ref_id="1i2odorpt39ulmdngms7cjrql">现在应用表现出意外行为：当用户添加飞行英雄时，没有一个出现在「能飞的英雄」下。这是因为添加英雄的代码是通过将其推入作为 
<code>flyingHeroes</code> 管道输入的 
<code>heroes</code> 数组中。</p>
<div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.component.ts" visiblelines="39" header="src/app/flying-heroes.component.ts">
    <div class="docs-code-header"><h3>src/app/flying-heroes.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Component</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">CommonModule</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/common'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">FormsModule</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/forms'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">FlyingHeroesPipe</span>, <span class="hljs-title class_">FlyingHeroesImpurePipe</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./flying-heroes.pipe'</span>;</div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-variable constant_">HEROES</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./heroes'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Component</span>({</div><div class="hljs-ln-line">  <span class="hljs-attr">standalone</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-flying-heroes'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">'./flying-heroes.component.html'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">CommonModule</span>, <span class="hljs-title class_">FormsModule</span>, <span class="hljs-title class_">FlyingHeroesPipe</span>],</div><div class="hljs-ln-line">  <span class="hljs-attr">styles</span>: [</div><div class="hljs-ln-line">    <span class="hljs-string">`</span></div><div class="hljs-ln-line">    #flyers, #all {font-style: italic}</div><div class="hljs-ln-line">    button {display: block}</div><div class="hljs-ln-line">    input {margin: .25rem .25rem .5rem 0;}</div><div class="hljs-ln-line">  `,</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlyingHeroesComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-attr">heroes</span>: <span class="hljs-built_in">any</span>[] = [];</div><div class="hljs-ln-line">  canFly = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">  mutate = <span class="hljs-literal">true</span>;</div><div class="hljs-ln-line">  title = <span class="hljs-string">'Flying Heroes (pure pipe)'</span>;</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</div><div class="hljs-ln-line">    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reset</span>();</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">addHero</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</div><div class="hljs-ln-line">    name = name.<span class="hljs-title function_">trim</span>();</div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (!name) {</div><div class="hljs-ln-line">      <span class="hljs-keyword">return</span>;</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">    <span class="hljs-keyword">const</span> hero = {name, <span class="hljs-attr">canFly</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">canFly</span>};</div><div class="hljs-ln-line">    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutate</span>) {</div><div class="hljs-ln-line">      <span class="hljs-comment">// Pure pipe won't update display because heroes array reference is unchanged</span></div><div class="hljs-ln-line">      <span class="hljs-comment">// Impure pipe will display</span></div><div class="hljs-ln-line">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span>.<span class="hljs-title function_">push</span>(hero);</div><div class="hljs-ln-line">    } <span class="hljs-keyword">else</span> {</div><div class="hljs-ln-line">      <span class="hljs-comment">// Pipe updates display because heroes array is a new object</span></div><div class="hljs-ln-line">      <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span>.<span class="hljs-title function_">concat</span>(hero);</div><div class="hljs-ln-line">    }</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"></div><div class="hljs-ln-line">  <span class="hljs-title function_">reset</span>(<span class="hljs-params"></span>) {</div><div class="hljs-ln-line">    <span class="hljs-variable language_">this</span>.<span class="hljs-property">heroes</span> = <span class="hljs-variable constant_">HEROES</span>.<span class="hljs-title function_">slice</span>();</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">////// Identical except for impure pipe //////</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Component</span>({</div><div class="hljs-ln-line">  <span class="hljs-attr">standalone</span>: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">selector</span>: <span class="hljs-string">'app-flying-heroes-impure'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">'./flying-heroes-impure.component.html'</span>,</div><div class="hljs-ln-line">  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">CommonModule</span>, <span class="hljs-title class_">FormsModule</span>, <span class="hljs-title class_">FlyingHeroesImpurePipe</span>],</div><div class="hljs-ln-line">  <span class="hljs-attr">styles</span>: [</div><div class="hljs-ln-line">    <span class="hljs-string">'#flyers, #all {font-style: italic}'</span>,</div><div class="hljs-ln-line">    <span class="hljs-string">'button {display: block}'</span>,</div><div class="hljs-ln-line">    <span class="hljs-string">'input {margin: .25rem .25rem .5rem 0;}'</span>,</div><div class="hljs-ln-line">  ],</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlyingHeroesImpureComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">FlyingHeroesComponent</span> {</div><div class="hljs-ln-line">  <span class="hljs-keyword">override</span> title = <span class="hljs-string">'Flying Heroes (impure pipe)'</span>;</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_ref_id="7knrnx8ghiqgvshak4hkkh7gz">变更检测器忽略了数组元素内部的变化，因此管道不会运行。Angular 忽略数组元素变化的原因是数组的
<em>引用</em>没有改变。因为数组是相同的，Angular 不会更新显示。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="eetxjsoonwn60su3awpewj79j">获得所需行为的方法之一是更改对象引用本身。可以用一个包含新更改过的元素的新数组替换该数组，然后把这个新数组作为输入传给管道。在上面的例子中，你可以创建一个附加了新英雄的数组，并把它赋值给 <code>heroes</code>。Angular 检测到了这个数组引用的变化，并执行了该管道。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="cab5n6u7lxpojp8qmxz2zmllo">总结一下，如果你变更输入数组，纯管道不会执行。如果你
<em>替换</em>输入数组，管道会执行并更新显示。作为替代方案，可以使用
<em>非纯</em>管道来检测复合对象（如数组）内部的变化，具体请参见下一节。</p>

  <h2 id="detecting-impure-changes-within-composite-objects">
    <a href="#detecting-impure-changes-within-composite-objects" class="docs-anchor" tabindex="-1" aria-label="Link to Detecting impure changes within composite objects" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="80ydb5lyb6qfa13b6810naahj">检测复合对象中的非纯变更</a>
  </h2>
  <p data-ng_translator_product="100" data-ng_translator_ref_id="147tz57km9jwdpe3y93thvhqt">要在复合对象<em>内部</em>（例如数组的一个元素）发生变化后执行自定义管道，你需要将管道定义为
<code>impure</code>以检测非纯变化。Angular 每次检测到变化时（例如每次按键或鼠标事件）都会执行非纯管道。</p>

    <div class="docs-alert docs-alert-important">
    <p data-ng_translator_product="100" data-ng_translator_ref_id="9ql96bkfcunq5nlb1d7do193e"><strong>重要：</strong>虽然非纯管道可能很有用，但要小心使用。 一个长时间运行的非纯管道可能会显著拖慢你的应用。</p>

    </div>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7yo5vbppn0adok3sfup5b6l6m">通过把 <code>pure</code> 标志设置为 <code>false</code> 来把管道设置成非纯的：</p>
<div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.pipe.ts" visiblelines="15,16,17,18,19" header="src/app/flying-heroes.pipe.ts">
    <div class="docs-code-header"><h3>src/app/flying-heroes.pipe.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Pipe</span>, <span class="hljs-type">PipeTransform</span>} from '<span class="hljs-meta">@angular</span>/core';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Hero</span>} from './heroes';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroes',</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesPipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> </span>{</div><div class="hljs-ln-line">  transform(allHeroes: <span class="hljs-type">Hero</span>[]) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> allHeroes.filter((hero) =&gt; hero.canFly);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/////// Identical except for the pure flag</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroesImpure',</div><div class="hljs-ln-line highlighted">  pure: <span class="hljs-literal">false</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesImpurePipe</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FlyingHeroesPipe</span> </span>{}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="1gkbs92jx50ph1oq2mmy0q4g6">下面的代码显示了 <code>FlyingHeroesImpurePipe</code> 的完整实现，它扩展了 <code>FlyingHeroesPipe</code> 以继承其特性。这个例子表明你不需要修改其他任何东西 - 唯一的区别就是在管道元数据中把 <code>pure</code> 标志设置为 <code>false</code>。</p>
<div class="docs-code-multifile">
    <div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.pipe.ts" visiblelines="15,16,17,18,19,20" header="src/app/flying-heroes.pipe.ts (FlyingHeroesImpurePipe)">
    <div class="docs-code-header"><h3>src/app/flying-heroes.pipe.ts (FlyingHeroesImpurePipe)</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Pipe</span>, <span class="hljs-type">PipeTransform</span>} from '<span class="hljs-meta">@angular</span>/core';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Hero</span>} from './heroes';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroes',</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesPipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> </span>{</div><div class="hljs-ln-line">  transform(allHeroes: <span class="hljs-type">Hero</span>[]) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> allHeroes.filter((hero) =&gt; hero.canFly);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/////// Identical except for the pure flag</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroesImpure',</div><div class="hljs-ln-line">  pure: <span class="hljs-literal">false</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesImpurePipe</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FlyingHeroesPipe</span> </span>{}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.pipe.ts" visiblelines="0,1,2,3,4,5,6,7,8,9,10,11,12" header="src/app/flying-heroes.pipe.ts (FlyingHeroesPipe)">
    <div class="docs-code-header"><h3>src/app/flying-heroes.pipe.ts (FlyingHeroesPipe)</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Pipe</span>, <span class="hljs-type">PipeTransform</span>} from '<span class="hljs-meta">@angular</span>/core';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Hero</span>} from './heroes';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroes',</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesPipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> </span>{</div><div class="hljs-ln-line">  transform(allHeroes: <span class="hljs-type">Hero</span>[]) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> allHeroes.filter((hero) =&gt; hero.canFly);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/////// Identical except for the pure flag</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroesImpure',</div><div class="hljs-ln-line">  pure: <span class="hljs-literal">false</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesImpurePipe</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FlyingHeroesPipe</span> </span>{}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>
    </div><p data-ng_translator_product="100" data-ng_translator_ref_id="5dvpopo78k4i79jluc575rwb9"><code>FlyingHeroesImpurePipe</code>是一个合理的非纯管道候选者，因为
<code>transform</code>函数是简单且快速的：</p>
<div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes.pipe.ts" visiblelines="10" header="src/app/flying-heroes.pipe.ts (filter)">
    <div class="docs-code-header"><h3>src/app/flying-heroes.pipe.ts (filter)</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Pipe</span>, <span class="hljs-type">PipeTransform</span>} from '<span class="hljs-meta">@angular</span>/core';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-keyword">import</span> {<span class="hljs-type">Hero</span>} from './heroes';</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroes',</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesPipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> </span>{</div><div class="hljs-ln-line">  transform(allHeroes: <span class="hljs-type">Hero</span>[]) {</div><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> allHeroes.filter((hero) =&gt; hero.canFly);</div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line">}</div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-comment">/////// Identical except for the pure flag</span></div><div class="hljs-ln-line"><span class="hljs-meta">@Pipe</span>({</div><div class="hljs-ln-line">  standalone: <span class="hljs-literal">true</span>,</div><div class="hljs-ln-line">  name: 'flyingHeroesImpure',</div><div class="hljs-ln-line">  pure: <span class="hljs-literal">false</span>,</div><div class="hljs-ln-line">})</div><div class="hljs-ln-line"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyingHeroesImpurePipe</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">FlyingHeroesPipe</span> </span>{}</div><div class="hljs-ln-line"></div></code>
    </pre>
  </div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="8wras6tu5oymhfblfmykvisxf">你可以从 <code>FlyingHeroesComponent</code> 派生一个 <code>FlyingHeroesImpureComponent</code>。如下面的代码所示，只有模板中的管道发生了变化。</p>
<div class="docs-code" path="adev/src/content/examples/pipes/src/app/flying-heroes-impure.component.html" visiblelines="16,17,18" header="src/app/flying-heroes-impure.component.html (excerpt)">
    <div class="docs-code-header"><h3 data-ng_translator_product="100" data-ng_translator_ref_id="4bmutjbgfj6wr9d5drcew3l0r">src/app/flying-heroes-impure.component.html (片段)</h3></div>
    <pre class="docs-mini-scroll-track">      <code><div class="hljs-ln-line"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span></span><span class="hljs-template-variable">{{ <span class="hljs-name">title</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"hero-name"</span>&gt;</span>New hero: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hero-name"</span> #<span class="hljs-attr">box</span> (<span class="hljs-attr">keyup.enter</span>)=<span class="hljs-string">"addHero(box.value); box.value=''"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"hero name"</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"can-fly"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> [(<span class="hljs-attr">ngModel</span>)]=<span class="hljs-string">"canFly"</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"can-fly"</span>&gt;</span>can fly<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"mutate"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> [(<span class="hljs-attr">ngModel</span>)]=<span class="hljs-string">"mutate"</span>&gt;</span>Mutate array</div><div class="hljs-ln-line">  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"reset()"</span>&gt;</span>Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Heroes who fly (piped)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"flyers"</span>&gt;</span></div><div class="hljs-ln-line">  @for (hero of (heroes | flyingHeroesImpure); track hero) {</div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.name</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>All Heroes (no pipe)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></div><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"all"</span>&gt;</span></div><div class="hljs-ln-line">  @for (hero of heroes; track hero) {</div><div class="hljs-ln-line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-template-variable">{{ <span class="hljs-name">hero.name</span> }}</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></div><div class="hljs-ln-line">  }</div><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div><div class="hljs-ln-line"></div></code>
    </pre>
  </div>