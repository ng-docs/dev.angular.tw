<div class="api"><header class="docs-reference-header"><span class="docs-reference-category">@angular/service-worker</span><div class="docs-reference-title"><div><h1>SwPush</h1><div class="docs-api-item-label" data-mode="full" data-type="undecorated_class">Class</div></div><a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/blob/main/packages/service-worker/src/push.ts#L94-L221" title="View source" aria-label="View source"><i role="presentation" aria-hidden="true" class="material-symbols-outlined">code</i></a></div><p class="docs-reference-description"></p><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="5cjwcsq0eij9022kxqpdsusv6">通过 Angular Service Worker 订阅和侦听<a href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API/Best_Practices">Web
推送通知</a>。</p><p></p><nav class="docs-pill-row"><a class="docs-pill" href="https://developers.google.com/web/fundamentals/codelabs/push-notifications/" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="2x5t7eerj80u73y0a9zciewb5">推送通知</a><a class="docs-pill" href="https://blog.angular-university.io/angular-push-notifications/" data-ng_translator_product="100" data-ng_translator_ref_id="8pjqithcvq5djltnahtlh760d">Angular 推送通知</a><a class="docs-pill" href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="92650x9z90r9ommv43y0shztx">MDN：推送 API</a><a class="docs-pill" href="https://developer.mozilla.org/en-US/docs/Web/API/Notifications_API" data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3u6mzq5zpprwlngx4u9rrdx7y">MDN：通知 API</a><a class="docs-pill" href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API/Best_Practices" data-ng_translator_product="100" data-ng_translator_ref_id="80zvdwx8nic3y43mp8zykm0b8">MDN: Web 推送 API 通知最佳实践</a></nav></header><div data-tab="API" data-tab-url="api"><div class="docs-reference-api-tab"><div class="docs-code"><pre class="docs-mini-scroll-track"><code><div class="hljs-ln-line "><span class="hljs-keyword">class</span> <span class="hljs-title class_">SwPush</span> {</div><button aria-describedby="jump-msg" type="button" class="hljs-ln-line " member-id="messages">  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Observable</span>&lt;<span class="hljs-built_in">object</span>&gt;;</button><button aria-describedby="jump-msg" type="button" class="hljs-ln-line " member-id="notificationClicks">  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">notificationClicks</span>: <span class="hljs-title class_">Observable</span>&lt;{ <span class="hljs-attr">action</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">notification</span>: <span class="hljs-title class_">NotificationOptions</span> &amp; { <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>; }; }&gt;;</button><button aria-describedby="jump-msg" type="button" class="hljs-ln-line " member-id="subscription">  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">subscription</span>: <span class="hljs-title class_">Observable</span>&lt;<span class="hljs-title class_">PushSubscription</span>&gt;;</button><button aria-describedby="jump-msg" type="button" class="hljs-ln-line " member-id="isEnabled">  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">isEnabled</span>: <span class="hljs-built_in">boolean</span>;</button><button aria-describedby="jump-msg" type="button" class="hljs-ln-line " member-id="requestSubscription">  <span class="hljs-title function_">requestSubscription</span>(<span class="hljs-attr">options</span>: { <span class="hljs-attr">serverPublicKey</span>: <span class="hljs-built_in">string</span>; }): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">PushSubscription</span>&gt;;</button><button aria-describedby="jump-msg" type="button" class="hljs-ln-line " member-id="unsubscribe">  <span class="hljs-title function_">unsubscribe</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;;</button><div class="hljs-ln-line ">}</div></code></pre></div></div></div><div data-tab="用法说明" data-tab-url="usage-notes"><div><p data-ng_translator_product="100" data-ng_translator_ref_id="5hnc8vmzjjb53ijdfztok24fo">你可以将 
<code>SwPush</code> 实例注入任何组件或服务作为依赖。</p>
<p><code-example path="service-worker/push/module.ts" region="inject-sw-push" header="app.component.ts"></code-example></p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="5if2gfriqen99nlyoajg4kq79">要订阅，请调用 
<code>SwPush.requestSubscription()</code>，它会请求用户许可。该调用返回一个带有新 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/PushSubscription"><code>PushSubscription</code></a> 实例的 
<code>Promise</code>。</p>
<p><code-example path="service-worker/push/module.ts" region="subscribe-to-push" header="app.component.ts"></code-example></p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="34c5a7lg8wnw2dwslp5i2hn8p">如果用户拒绝权限，或者浏览器阻止或不支持 Push API 或 ServiceWorker，请求将被拒绝。检查 
<code>SwPush.isEnabled</code> 以确认状态。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ctxlty9u96fidk9ctjt2on5ng">通过推送具有以下有效负载的消息来调用 Push Notifications。</p>

      <div class="docs-code" role="group">
        <pre class="docs-mini-scroll-track">
          <code>
            <span class="hljs-ln-line">{</span><span class="hljs-ln-line">  <span class="hljs-string">"notification"</span>: {</span><span class="hljs-ln-line">    <span class="hljs-string">"actions"</span>: <span class="hljs-title class_">NotificationAction</span>[],</span><span class="hljs-ln-line">    <span class="hljs-string">"badge"</span>: <span class="hljs-title class_">USVString</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"body"</span>: <span class="hljs-title class_">DOMString</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"data"</span>: <span class="hljs-built_in">any</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"dir"</span>: <span class="hljs-string">"auto"</span>|<span class="hljs-string">"ltr"</span>|<span class="hljs-string">"rtl"</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"icon"</span>: <span class="hljs-title class_">USVString</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"image"</span>: <span class="hljs-title class_">USVString</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"lang"</span>: <span class="hljs-title class_">DOMString</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"renotify"</span>: <span class="hljs-built_in">boolean</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"requireInteraction"</span>: <span class="hljs-built_in">boolean</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"silent"</span>: <span class="hljs-built_in">boolean</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"tag"</span>: <span class="hljs-title class_">DOMString</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"timestamp"</span>: <span class="hljs-title class_">DOMTimeStamp</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"title"</span>: <span class="hljs-title class_">DOMString</span>,</span><span class="hljs-ln-line">    <span class="hljs-string">"vibrate"</span>: <span class="hljs-built_in">number</span>[]</span><span class="hljs-ln-line">  }</span><span class="hljs-ln-line">}</span>
          </code>
        </pre>
      </div>
    <p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="tmlw40z1z9g7m28zob564vya">只需要 <code>title</code>。请参阅
<code>Notification</code><a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification#Instance_properties">实例属性</a>。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7sv2dxfr1hqjrxarctpu96s8i">在订阅处于活动状态时，Service Worker
会侦听<a href="https://developer.mozilla.org/en-US/docs/Web/API/PushEvent">PushEvent</a>的发生并创建<a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification">Notification</a>实例作为响应。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="66xu608ub1g4enabyu4xwa7tk">使用 
<code>SwPush.unsubscribe()</code> 取消订阅。</p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="4ygn4elcwv9q612apknsh6hom">应用可以订阅 
<code>SwPush.notificationClicks</code> 可观察者，以在用户点击通知时收到通知。例如：</p>
<p><code-example path="service-worker/push/module.ts" region="subscribe-to-notification-clicks" header="app.component.ts"></code-example></p>
<p data-ng_translator_product="100" data-ng_translator_ref_id="82dkjoe1ln5uv97rxv6pfbtiw">你可以在 
<a href="ecosystem/service-workers/push-notifications">Service worker 通知指南</a> 中阅读更多关于处理通知点击的内容。</p>
</div></div><div class="docs-reference-members-container"><div class="docs-reference-members"><div id="messages" class="docs-reference-member-card" tabindex="-1"><header><div class="docs-reference-header"><h3>messages</h3><div><code>Observable&lt;object&gt;</code></div></div></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="996ni84fn478n1c70c2eqssa5">发出已接收到的推送通知消息的有效负载。</p></div></div></div></div><div id="notificationClicks" class="docs-reference-member-card" tabindex="-1"><header><div class="docs-reference-header"><h3>notificationClicks</h3><div><code>Observable&lt;{ action: string; notification: NotificationOptions &amp; { title: string; }; }&gt;</code></div></div></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="ausdm5c2obfrljg4iy5gsvt0o">发出已接收到的推送通知消息的有效负载以及用户交互的操作。如果未使用任何操作，则 <code>action</code>
属性包含空字符串 <code>''</code>。</p>
<p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="7j1f3caw2vx5yd1szicavp9y0">请注意，<code>notification</code> 属性<strong>不</strong>包含<a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification">Notification</a>对象，而是包含一个<a href="https://notifications.spec.whatwg.org/#dictdef-notificationoptions">NotificationOptions</a>对象，该对象还包含<a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification">Notification</a>对象的 <code>title</code>。</p></div></div></div></div><div id="subscription" class="docs-reference-member-card" tabindex="-1"><header><div class="docs-reference-header"><h3>subscription</h3><div><code>Observable&lt;PushSubscription&gt;</code></div></div></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="45q27wjg757w7nh9zlg1rxp8q">发出与 Service Worker
注册关联的当前活动的<a href="https://developer.mozilla.org/en-US/docs/Web/API/PushSubscription">PushSubscription</a>
，如果没有订阅，则发出 <code>null</code>。</p></div></div></div></div><div id="isEnabled" class="docs-reference-member-card" tabindex="-1"><header><div class="docs-reference-header"><h3>isEnabled</h3><div><code>boolean</code></div></div></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p data-ng_translator_product="100" data-ng_translator_ref_id="190g8rxmdii80rfqdlat2nos8">如果 Service Worker 已启用（由浏览器支持并通过 
<code>ServiceWorkerModule</code> 启用），则为 True。</p></div></div></div></div><div id="requestSubscription" class="docs-reference-member-card" tabindex="-1"><header><div class="docs-reference-header"><h3>requestSubscription</h3><div><code>Promise&lt;PushSubscription&gt;</code></div></div></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="bwiczftl3v47u2hcgopjo7gbf">在请求并接收到用户权限后订阅 Web 推送通知。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">options</span><code>{ serverPublicKey: string; }</code><div class="docs-parameter-description"><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="3bqyzqc59gggfmgvfx3wey623">包含 <code>serverPublicKey</code> 字符串的对象。</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;PushSubscription&gt;</code></div></div></div></div><div id="unsubscribe" class="docs-reference-member-card" tabindex="-1"><header><div class="docs-reference-header"><h3>unsubscribe</h3><div><code>Promise&lt;void&gt;</code></div></div></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p data-ng_translator_product="100" data-ng_translator_confirmed data-ng_translator_ref_id="esxe10hhf3jz6uxdgnuq894px">取消订阅 Service Worker 推送通知。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;void&gt;</code></div></div></div></div></div></div></div>