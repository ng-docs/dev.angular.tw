<div class="docs-api"><header class="docs-reference-header"><span class="docs-reference-category">@angular/service-worker</span><div class="docs-reference-title"><div><h1>SwPush</h1><div class="docs-api-item-label type-undecorated_class full">類</div></div><a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/blob/main/packages/service-worker/src/push.ts#L94-L234" title="View source" aria-label="View source"><i role="presentation" aria-hidden="true" class="material-symbols-outlined">程式碼</i></a></div><section class="docs-reference-description"><p>透過 Angular Service Worker 訂閱並監聽<a href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API/Best_Practices">Web Push Notifications</a>。</p></section><nav class="docs-pill-row"><a class="docs-pill" href="https://developers.google.com/web/fundamentals/codelabs/push-notifications/">Push Notifications</a><a class="docs-pill" href="https://blog.angular-university.io/angular-push-notifications/">Angular Push Notifications</a><a class="docs-pill" href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API">MDN：Push API</a><a class="docs-pill" href="https://developer.mozilla.org/en-US/docs/Web/API/Notifications_API">MDN：Notifications API</a><a class="docs-pill" href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API/Best_Practices">MDN：Web Push API Notifications 最佳實踐</a></nav></header><div class="docs-reference-section docs-reference-api-section"><h2 id="api" class="docs-reference-section-heading"><a href="#api" aria-label="Link to API section" tabindex="-1">API</a></h2><div class="docs-code"><pre class="docs-mini-scroll-track"><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0">  <code>
    <span class="line "><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/service-worker/SwPush">SwPush</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><button aria-describedby="jump-msg" type="button" class="line " member-id="constructor"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">sw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> NgswCommChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> <a href="/api/service-worker/SwPush">SwPush</a></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="messages"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> messages</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Observable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="notificationClicks"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> notificationClicks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Observable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;{ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">notification</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> NotificationOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">title</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; }; }&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="subscription"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> subscription</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Observable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PushSubscription</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="isEnabled"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  readonly</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> isEnabled</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="requestSubscription"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  requestSubscription</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">serverPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">; })</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">PushSubscription</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><button aria-describedby="jump-msg" type="button" class="line " member-id="unsubscribe"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  unsubscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></button><span class="line "><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span>
  </code>
  </pre></pre></div></div><div class="docs-reference-members"><div class="docs-reference-members"><div id="constructor" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>constructor</h3><code><a href="/api/service-worker/SwPush">SwPush</a></code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">sw</span><code>NgswCommChannel</code><div class="docs-parameter-description"></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code><a href="/api/service-worker/SwPush">SwPush</a></code></div></div></div></div><div id="messages" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>messages</h3><code>Observable&lt;object&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>發出收到的推送通知訊息的有效負載。</p></div></div></div></div><div id="notificationClicks" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>notificationClicks</h3><code>Observable&lt;{ action: string; notification: NotificationOptions &amp; { title: string; }; }&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>發出收到的推送通知訊息的有效負載，以及使用者與之互動的操作。如果未使用任何操作，則 <code>action</code> 屬性包含一個空字串 <code>''</code>。</p>
<p>請注意，<code>notification</code> 屬性<strong>不</strong>包含 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification">Notification</a> 物件，而是包含 <a href="https://notifications.spec.whatwg.org/#dictdef-notificationoptions">NotificationOptions</a> 物件，該物件還包括 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification">Notification</a> 物件的 <code>title</code>。</p></div></div></div></div><div id="subscription" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>subscription</h3><code>Observable&lt;PushSubscription | null&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>發出與 Service Worker 註冊關聯的當前活動的 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PushSubscription">PushSubscription</a>，如果沒有訂閱，則發出 <code>null</code>。</p></div></div></div></div><div id="isEnabled" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>isEnabled</h3><code>boolean</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item"><div><p>如果 Service Worker 已啟用（受瀏覽器支援並透過 <code><a href="/api/service-worker/ServiceWorkerModule">ServiceWorkerModule</a></code> 啟用），則為 True。</p></div></div></div></div><div id="requestSubscription" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>requestSubscription</h3><code>Promise&lt;PushSubscription&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>在請求並獲得使用者許可後，訂閱 Web Push Notifications。</p></div><div class="docs-param-group"><span class="docs-param-keyword">@param</span><span class="docs-param-name">options</span><code>{ serverPublicKey: string; }</code><div class="docs-parameter-description"><p>包含 <code>serverPublicKey</code> 字串的物件。</p></div></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;PushSubscription&gt;</code></div></div></div></div><div id="unsubscribe" class="docs-reference-member-card"><header class="docs-reference-card-header"><h3>unsubscribe</h3><code>Promise&lt;void&gt;</code></header><div class="docs-reference-card-body"><div class="docs-reference-card-item "><div class="docs-function-definition"><p>取消訂閱 Service Worker 推送通知。</p></div><div class="docs-return-type"><span class="docs-param-keyword">@returns</span><code>Promise&lt;void&gt;</code></div></div></div></div></div></div><div class="docs-reference-section"><h2 id="usage-notes" class="docs-reference-section-heading"><a href="#usage-notes" aria-label="Link to Usage Notes section" tabindex="-1">用法說明</a></h2><div><p>你可以將 <code><a href="/api/service-worker/SwPush">SwPush</a></code> 實例作為依賴項注入到任何元件或服務中。</p>
<p><code-example path="service-worker/push/module.ts" region="inject-sw-push" header="app.component.ts"></code-example></p>
<p>要訂閱，請調用 <code><a href="/api/service-worker/SwPush#requestSubscription()">SwPush.requestSubscription()</a></code>，這將請求使用者授予許可權。
該呼叫會回傳一個 <code>Promise</code>，其中包含一個新的 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PushSubscription"><code>PushSubscription</code></a> 實例。</p>
<p><code-example path="service-worker/push/module.ts" region="subscribe-to-push" header="app.component.ts"></code-example></p>
<p>如果使用者拒絕授權，或者如果瀏覽器阻止或不支援 Push API 或 ServiceWorkers，則請求將被拒絕。
檢查 <code><a href="/api/service-worker/SwPush#isEnabled">SwPush.isEnabled</a></code> 以確認狀態。</p>
<p>透過推送具有以下有效負載的訊息來呼叫 Push Notifications。</p>

      <div class="docs-code" role="group">
        <pre class="docs-mini-scroll-track">          <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">{</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">  "notification"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: {</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "actions"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: NotificationAction[],</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "badge"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: USVString,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "body"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: DOMString,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "data"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: any,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "dir"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"auto"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"ltr"</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">|</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"rtl"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "icon"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: USVString,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "image"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: USVString,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "lang"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: DOMString,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "renotify"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: boolean,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "requireInteraction"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: boolean,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "silent"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: boolean,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "tag"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: DOMString,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "timestamp"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: DOMTimeStamp,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "title"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: DOMString,</span></span><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    "vibrate"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: number[]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
        </pre>
      </div>
    <p>僅 <code>title</code> 是必要的。請參閱 <code>Notification</code> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification#Instance_properties">實例屬性</a>。</p>
<p>當訂閱處於活動狀態時，Service Worker 會監聽 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PushEvent">PushEvent</a> 事件的發生，並建立 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Notification">Notification</a> 實例作為回應。</p>
<p>使用 <code><a href="/api/service-worker/SwPush#unsubscribe()">SwPush.unsubscribe()</a></code> 取消訂閱。</p>
<p>應用可以訂閱 <code><a href="/api/service-worker/SwPush#notificationClicks">SwPush.notificationClicks</a></code> 可觀察者，以便在使用者單擊通知時收到通知。例如：</p>
<p><code-example path="service-worker/push/module.ts" region="subscribe-to-notification-clicks" header="app.component.ts"></code-example></p>
<p>你可以在<a href="ecosystem/service-workers/push-notifications">Service Worker 通知指南</a>中閱讀更多關於處理通知點選事件的內容。</p>
</div></div></div>