"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([["src_app_custom-elements_api_api-list_module_ts"],{8512:(P,u,c)=>{c.r(u),c.d(u,{ApiListModule:()=>N});var p=c(5056),h=c(1332),C=c(9280),d=c(3680),_=c(5876),m=c(604),t=c(4896),O=c(1616),f=c(8600),y=c(4364),S=c(7808),w=c(864);let g=(()=>{class s{get sections(){return this.firstTime&&(this.firstTime=!1,this.fetchSections(),this._sections.subscribe(e=>this.logger.log(`ApiService got API ${e.length} section(s)`))),this._sections.pipe((0,f.y)(e=>{e.forEach(n=>{n.deprecated=!!n.items&&n.items.every(i=>"deprecated"===i.stability)})}))}constructor(e,n){this.http=e,this.logger=n,this.apiBase=S.mm+"api/",this.apiListJsonDefault="api-list.json",this.firstTime=!0,this.onDestroy=new O.E,this.sectionsSubject=new d.o(1),this._sections=this.sectionsSubject.pipe((0,y.a)(this.onDestroy))}ngOnDestroy(){this.onDestroy.next()}fetchSections(e){const n=this.apiBase+(e||this.apiListJsonDefault);this.http.get(n).pipe((0,y.a)(this.onDestroy),(0,f.y)(()=>this.logger.log(`Got API sections from ${n}`))).subscribe({next:i=>this.sectionsSubject.next(i),error:i=>{throw this.logger.error(i),i}})}static#t=this.ɵfac=function(n){return new(n||s)(t.CoB(h.KK),t.CoB(w.Y))};static#e=this.ɵprov=t.wxM({token:s,factory:s.ɵfac})}return s})();var b=c(5460);const I=["listBox"];function T(s,a){1&s&&t.C_f(0)}function G(s,a){1&s&&t.C_f(0)}const E=(s,a)=>({showLabel:!1,value:s,title:a});function x(s,a){if(1&s){const e=t.KQA();t.I0R(0,"li",9),t.qCj("click",function(){const o=t.usT(e).index,l=t.GaO(2);return t.CGJ(l.select(o))}),t.yuY(1,G,1,0,"ng-container",3),t.C$Y()}if(2&s){const e=a.$implicit,n=a.index,i=t.GaO(2),o=t.Gew(6);t.eAK("selected",e===i.selected)("current",i.currentOptionIdx===n),t.E7m("id",i.listBoxId+"-option-"+n),t.e48("aria-selected",e===i.selected),t.yG2(),t.E7m("ngTemplateOutlet",o)("ngTemplateOutletContext",t.IBC(8,E,e.value,e.title))}}function k(s,a){if(1&s&&(t.I0R(0,"ul",6,7),t.yuY(2,x,2,11,"li",8),t.C$Y()),2&s){const e=t.GaO();t.E7m("id",e.listBoxId),t.yG2(2),t.E7m("ngForOf",e.options)}}function A(s,a){if(1&s&&(t.I0R(0,"span")(1,"strong"),t.OEk(2),t.C$Y()()),2&s){const e=t.GaO(2);t.yG2(2),t.cNF(e.label)}}function Y(s,a){if(1&s&&t.wR5(0,"span"),2&s){const e=t.GaO().value;t.uQ9("symbol ",e,"")}}function $(s,a){if(1&s&&(t.yuY(0,A,3,1,"span",10)(1,Y,1,3,"span",11),t.I0R(2,"span"),t.OEk(3),t.C$Y()),2&s){const e=a.showLabel,n=a.title,i=t.GaO();t.E7m("ngIf",e),t.yG2(),t.E7m("ngIf",i.showSymbol),t.yG2(2),t.cNF(n)}}const L=(s,a)=>({showLabel:!0,value:s,title:a});let B=(()=>{class s{static#t=this.instancesCounter=0;get showOptions(){return this._showOptions}set showOptions(e){this.disabled||(this.showOptions!==e&&this.optionsToggled.emit(e),this._showOptions=e)}constructor(e){this.hostElement=e,this.change=new t._w7,this.optionsToggled=new t._w7,this.showSymbol=!1,this.label="",this._showOptions=!1,this.listBoxId="aio-select-list-box-"+s.instancesCounter++,this.currentOptionIdx=0}ngOnInit(){this.label=this.label||""}toggleOptions(){this.showOptions=!this.showOptions}hideOptions(){this.showOptions=!1}select(e){const n=this.options[e];this.selected=n,this.change.emit({option:n,index:e}),this.hideOptions()}onClick(e){this.hostElement.nativeElement.contains(e)||this.hideOptions()}handleKeydown(e){const n=i=>{if(this.showOptions)i();else{this.showOptions=!0;const o=this.options&&this.selected?this.options.indexOf(this.selected):-1;this.currentOptionIdx=o>0?o:0}};switch(e.key){case"ArrowDown":n(()=>this.currentOptionIdx=Math.min(this.currentOptionIdx+1,(this.options?.length??0)-1));break;case"ArrowUp":n(()=>this.currentOptionIdx=Math.max(this.currentOptionIdx-1,0));break;case"Escape":this.hideOptions();break;case"Tab":this.showOptions&&this.select(this.currentOptionIdx);break;case"Enter":case"Space":case" ":n(()=>this.select(this.currentOptionIdx))}"Tab"!==e.key&&e.preventDefault()}static#e=this.ɵfac=function(n){return new(n||s)(t.GI1(t.GMv))};static#i=this.ɵcmp=t.In1({type:s,selectors:[["aio-select"]],viewQuery:function(n,i){if(1&n&&t.CC$(I,5,t.GMv),2&n){let o;t.wto(o=t.Gqi())&&(i.listBox=o.first)}},hostBindings:function(n,i){1&n&&t.qCj("click",function(l){return i.onClick(l.target)},!1,t.wLc)},inputs:{selected:"selected",options:"options",showSymbol:"showSymbol",label:"label",disabled:"disabled"},outputs:{change:"change",optionsToggled:"optionsToggled"},decls:7,vars:12,consts:[[1,"form-select-menu"],["role","combobox","aria-haspopup","listbox","tabindex","0",1,"form-select-button",3,"click","keydown"],["aria-hidden","true"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","form-select-dropdown","role","listbox","tabIndex","-1",3,"id",4,"ngIf"],["optionTemplate",""],["role","listbox","tabIndex","-1",1,"form-select-dropdown",3,"id"],["listBox",""],["role","option",3,"selected","current","id","click",4,"ngFor","ngForOf"],["role","option",3,"id","click"],[4,"ngIf"],[3,"class",4,"ngIf"]],template:function(n,i){if(1&n&&(t.I0R(0,"div",0)(1,"div",1),t.qCj("click",function(){return i.toggleOptions()})("keydown",function(l){return i.handleKeydown(l)}),t.I0R(2,"div",2),t.yuY(3,T,1,0,"ng-container",3),t.C$Y()(),t.yuY(4,k,3,2,"ul",4),t.C$Y(),t.yuY(5,$,4,3,"ng-template",null,5,t.gJz)),2&n){const o=t.Gew(6);let l;t.yG2(),t.eAK("disabled",i.disabled),t.e48("aria-controls",i.listBoxId)("aria-expanded",i.showOptions)("aria-activedescendant",i.currentOptionIdx>-1&&i.showOptions?i.listBoxId+"-option-"+i.currentOptionIdx:null)("aria-label",i.label+(null!==(l=null==i.selected?null:i.selected.title)&&void 0!==l?l:"")),t.yG2(2),t.E7m("ngTemplateOutlet",o)("ngTemplateOutletContext",t.IBC(9,L,null==i.selected?null:i.selected.value,null==i.selected?null:i.selected.title)),t.yG2(),t.E7m("ngIf",i.showOptions)}},dependencies:[p.ay,p.u_,p.XV],encapsulation:2})}return s})();const F=["filter"];function M(s,a){if(1&s&&(t.I0R(0,"h2")(1,"a",11),t.OEk(2),t.C$Y()()),2&s){const e=t.GaO().$implicit;t.yG2(),t.eAK("deprecated-api-item",e.deprecated),t.E7m("href",e.path,t.K6U),t.yG2(),t.cNF(e.title)}}function R(s,a){if(1&s&&(t.SAx(0),t.I0R(1,"li",13)(2,"a",11),t.wR5(3,"span"),t.OEk(4),t.C$Y()(),t.k70()),2&s){const e=a.$implicit;t.yG2(2),t.eAK("deprecated-api-item","deprecated"===e.stability),t.E7m("href",e.path,t.K6U),t.yG2(),t.uQ9("symbol ",e.docType,""),t.yG2(),t.oRS(" ",e.title," ")}}function j(s,a){if(1&s&&(t.I0R(0,"ul",12),t.yuY(1,R,5,7,"ng-container",8),t.C$Y()),2&s){const e=t.GaO().$implicit;t.yG2(),t.E7m("ngForOf",e.items)}}function D(s,a){if(1&s&&(t.I0R(0,"div"),t.yuY(1,M,3,4,"h2",9)(2,j,2,1,"ul",10),t.C$Y()),2&s){const e=a.$implicit;t.yG2(),t.E7m("ngIf",e.items),t.yG2(),t.E7m("ngIf",e.items&&e.items.length)}}class K{constructor(){this.query="",this.status="all",this.type="all"}}let Q=(()=>{class s{constructor(e,n){this.apiService=e,this.locationService=n,this.showStatusMenu=!1,this.showTypeMenu=!1,this.criteriaSubject=new d.o(1),this.searchCriteria=new K,this.types=[{value:"all",title:"全部"},{value:"class",title:"類"},{value:"const",title:"常數"},{value:"decorator",title:"裝飾器"},{value:"directive",title:"指令"},{value:"element",title:"元素"},{value:"block",title:"區塊"},{value:"enum",title:"列舉"},{value:"function",title:"函式"},{value:"interface",title:"介面"},{value:"package",title:"套件"},{value:"pipe",title:"通道"},{value:"ngmodule",title:"NgModule"},{value:"type-alias",title:"型別別名"}],this.statuses=[{value:"all",title:"全部"},{value:"stable",title:"穩定"},{value:"developer-preview",title:"開發者預覽"},{value:"deprecated",title:"棄用"},{value:"security-risk",title:"安全風險"}]}ngOnInit(){this.filteredSections=(0,_.E)([this.apiService.sections,this.criteriaSubject]).pipe((0,m.k)(e=>({sections:e[0],criteria:e[1]})),(0,m.k)(e=>e.sections.map(n=>({...n,items:this.filterSection(n,e.criteria)})))),this.initializeSearchCriteria()}setQuery(e){this.setSearchCriteria({query:(e||"").toLowerCase().trim()})}setStatus(e){this.toggleStatusMenu(),this.status=e,this.setSearchCriteria({status:e.value})}setType(e){this.toggleTypeMenu(),this.type=e,this.setSearchCriteria({type:e.value})}toggleStatusMenu(){this.showStatusMenu=!this.showStatusMenu}toggleTypeMenu(){this.showTypeMenu=!this.showTypeMenu}filterSection(e,{query:n,status:i,type:o}){const l=!n||-1!==e.name.indexOf(n),v=(e.items||[]).filter(r=>(r=>"all"===o||o===r.docType)(r)&&(r=>"all"===i||i===r.stability||"security-risk"===i&&r.securityRisk||"developer-preview"===i&&r.developerPreview)(r)&&(r=>l||-1!==r.name.indexOf(n))(r));return v.length?v:l&&"package"===o?[]:null}initializeSearchCriteria(){const{query:e,status:n,type:i}=this.locationService.search(),o=(e||"").toLowerCase();this.queryEl.nativeElement.value=o,this.status=this.statuses.find(l=>l.value===n)||this.statuses[0],this.type=this.types.find(l=>l.value===i)||this.types[0],this.searchCriteria={query:o,status:this.status.value,type:this.type.value},this.criteriaSubject.next(this.searchCriteria)}setLocationSearch(){const{query:e,status:n,type:i}=this.searchCriteria;this.locationService.setSearch("API 搜尋",{query:e||void 0,status:"all"!==n?n:void 0,type:"all"!==i?i:void 0})}setSearchCriteria(e){this.criteriaSubject.next(Object.assign(this.searchCriteria,e)),this.setLocationSearch()}static#t=this.ɵfac=function(n){return new(n||s)(t.GI1(g),t.GI1(b.z))};static#e=this.ɵcmp=t.In1({type:s,selectors:[["aio-api-list"]],viewQuery:function(n,i){if(1&n&&t.CC$(F,7),2&n){let o;t.wto(o=t.Gqi())&&(i.queryEl=o.first)}},decls:11,vars:9,consts:[[1,"l-flex-wrap","api-filter"],["label","型別：",3,"options","selected","showSymbol","change"],["label","狀態：",3,"options","selected","disabled","change"],[1,"form-search"],["placeholder","過濾","aria-label","Filter Search",3,"input"],["filter",""],[1,"material-icons"],[1,"api-list-container"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","api-list",4,"ngIf"],[3,"href"],[1,"api-list"],[1,"api-item"]],template:function(n,i){1&n&&(t.I0R(0,"div",0)(1,"aio-select",1),t.qCj("change",function(l){return i.setType(l.option)}),t.C$Y(),t.I0R(2,"aio-select",2),t.qCj("change",function(l){return i.setStatus(l.option)}),t.C$Y(),t.I0R(3,"div",3)(4,"input",4,5),t.qCj("input",function(l){return i.setQuery(l.target.value)}),t.C$Y(),t.I0R(6,"em",6),t.OEk(7,"search"),t.C$Y()()(),t.I0R(8,"article",7),t.yuY(9,D,3,2,"div",8),t.wVc(10,"async"),t.C$Y()),2&n&&(t.yG2(),t.E7m("options",i.types)("selected",i.type)("showSymbol",!0),t.yG2(),t.E7m("options",i.statuses)("selected",i.status)("disabled","package"===i.type.value),t.yG2(7),t.E7m("ngForOf",t.kDX(10,7,i.filteredSections)))},dependencies:[p.ay,p.u_,B,p.a],encapsulation:2})}return s})(),N=(()=>{class s{constructor(){this.customElementComponent=Q}static#t=this.ɵfac=function(n){return new(n||s)};static#e=this.ɵmod=t.a4G({type:s});static#i=this.ɵinj=t.s3X({providers:[g],imports:[p.MD,C.k,h.SU]})}return s})()}}]);
//# sourceMappingURL=src_app_custom-elements_api_api-list_module_ts.d609be5e4bf3721a.js.map
